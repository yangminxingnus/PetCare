function isUnsupportedBrowser(){return"Internet Explorer"===bowser.name&&bowser.version<=10||("Safari"===bowser.name&&bowser.version<=9||!!(window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("Opera Mini")>0))}var __extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)},Common;!function(Common){var Globals;!function(Globals){Globals.DOMAIN_MACHINE_PATH="simplesite.com",Globals.DOMAIN_PATH=""+Common.Globals.DOMAIN_MACHINE_PATH,Globals.API_PATH="https://api."+Common.Globals.DOMAIN_MACHINE_PATH,Globals.CLIENT_ID="publicsite",Globals.CLIENT_SECRET="pbStT0eojtQ8XBu2t62NgmB2lwmzCZQGIO8OGoHffCc7Fyc80rPk23OMSmYRkAzE",Globals.SEND_ERRORS_TO_API=!1,Globals.ABSOLUTE_DOMAIN_URL="https://www."+Globals.DOMAIN_PATH,Globals.USE_V3_LOGIN=!0,Globals.FACEBOOK_APP_ID="1880640628839943",Globals.LOGOUT_PARTIAL_LINK="/#/logout",Globals.LOGIN_PARTIAL_LINK="/#/login",Globals.DEFAULT_COOKIE_SETTINGS={expires:new Date(2038,1,1)},Globals.USER_EVENT_CONTENT_TIMEOUT=12e5}(Globals=Common.Globals||(Common.Globals={}))}(Common||(Common={})),isUnsupportedBrowser()?(window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),window.location.href=window.location.origin+"/nosupport-browsers.html"):angular.element(document).ready(function(){angular.bootstrap(document,["app"])});var app;!function(app){"use strict";function Config($locationProvider,$stateProvider,$urlRouterProvider,$httpProvider,$compileProvider,$translateProvider,$translatePartialLoaderProvider,$sceDelegateProvider,lodash){$httpProvider.interceptors.push("AuthInterceptor"),$httpProvider.interceptors.push("ErrorInterceptor"),$httpProvider.defaults.headers.get||($httpProvider.defaults.headers.get={}),$httpProvider.defaults.headers.get["If-Modified-Since"]="Mon, 26 Jul 1997 05:00:00 GMT",$compileProvider.debugInfoEnabled(!1),$stateProvider.state("welcome-mobile",{url:"/welcome-mobile",templateUrl:"partials/welcome-mobile/welcome-mobile.html",controller:"WelcomeMobileController",controllerAs:"vm",resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])}}).state("home",{url:"/pages/{pageId}?editmode?categoryId?imageid",params:{pageId:{value:null,squash:!0}},reloadOnSearch:!1,resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])},views:{"preview@home":{templateUrl:"partials/home.preview/home.preview.html",controller:"HomePreviewController",controllerAs:"vm",resolve:{previewResolve:Resolve.previewResolve(),previewTranslateResolve:Resolve.translatePartial(["home","subscription"])}},"@":{templateUrl:"partials/home/home.html",controller:"HomeController",controllerAs:"vm"},"pagesoverview@home":{templateUrl:"partials/home.pagesoverview/home.pagesoverview.html",controller:"HomePagesoverviewController",controllerAs:"vm"},"designeditor@home":{templateUrl:"partials/home.designeditor/home.designeditor.html",controller:"HomeDesigneditorController",controllerAs:"vm"},"mainmenu@home":{templateUrl:"partials/home.mainmenu/home.mainmenu.html",controller:"HomeMainmenuController",controllerAs:"vm"},"account@home":{templateUrl:"partials/home.account/home.account.html",controller:"HomeAccountController",controllerAs:"vm"},"videobackground@home":{templateUrl:"partials/home.videobackground/home.videobackground.html",controller:"HomeVideoBackgroundController",controllerAs:"vm"},"topbar@home":{templateUrl:"partials/home.topbar/home.topbar.html",controller:"TopbarController",controllerAs:"vm"},"sidebar@home":{templateUrl:"partials/home.sidebar/home.sidebar.html",controller:"SidebarController",controllerAs:"vm"},"bottombar@home":{templateUrl:"partials/home.bottombar/home.bottombar.html",controller:"BottombarController",controllerAs:"vm",resolve:{previewResolve:Resolve.previewResolve(),previewTranslateResolve:Resolve.translatePartial(["home","subscription"])}}}}).state("login",{url:"/login",templateUrl:"partials/login/login.html",controller:"LoginController",controllerAs:"vm",resolve:{loginTranslateResolve:Resolve.translatePartial(["base","login","subscription"])}}).state("logout",{url:"/logout",controller:"LogoutController",controllerAs:"vm",resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])}}).state("signup",{url:"/signup",templateUrl:"partials/signup/signup.html",controller:"SignupController",controllerAs:"vm",resolve:{signupTranslateResolve:Resolve.translatePartial(["base","signup","subscription"])}}).state("notfound",{url:"/notfound",templateUrl:"partials/notfound/notfound.html",controller:"NotFoundController",controllerAs:"vm",resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])}}).state("commentSettings",{url:"/comment-settings",resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])},views:{"@":{templateUrl:"partials/home.settings/home.settings.html",controller:"HomeSettingsController",controllerAs:"vm",resolve:{settingsResolve:Resolve.commentSettingsResolve(),settingsTranslateResolve:Resolve.translatePartial(["home","subscription"])}},"sidebar@commentSettings":{templateUrl:"partials/home.sidebar/home.sidebar.html",controller:"SidebarController",controllerAs:"vm"},"mainmenu@commentSettings":{templateUrl:"partials/home.mainmenu/home.mainmenu.html",controller:"HomeMainmenuController",controllerAs:"vm"},"account@commentSettings":{templateUrl:"partials/home.account/home.account.html",controller:"HomeAccountController",controllerAs:"vm"},"commentSettings@commentSettings":{templateUrl:"partials/home.comment.settings/home.comment.settings.html",controller:"HomeCommentSettingsController",controllerAs:"vm"}}}).state("siteStats",{url:"/site-statistics",resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])},views:{"@":{templateUrl:"partials/home.settings/home.settings.html",controller:"HomeSettingsController",controllerAs:"vm",resolve:{settingsResolve:Resolve.commentSettingsResolve(),settingsTranslateResolve:Resolve.translatePartial(["home","subscription"])}},"sidebar@siteStats":{templateUrl:"partials/home.sidebar/home.sidebar.html",controller:"SidebarController",controllerAs:"vm"},"mainmenu@siteStats":{templateUrl:"partials/home.mainmenu/home.mainmenu.html",controller:"HomeMainmenuController",controllerAs:"vm"},"account@siteStats":{templateUrl:"partials/home.account/home.account.html",controller:"HomeAccountController",controllerAs:"vm"},"siteStats@siteStats":{templateUrl:"partials/home.sitestats/home.sitestats.html",controller:"HomeSiteStatsController",controllerAs:"vm"}}}).state("siteCmsPage",{url:"/site-help/{cmsKey}?ascroll",resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])},params:{cmsKey:{value:null,squash:!0}},views:{"@":{templateUrl:"partials/home.settings/home.settings.html",controller:"HomeSettingsController",controllerAs:"vm",resolve:{settingsResolve:Resolve.cmsPageResolve(),settingsTranslateResolve:Resolve.translatePartial(["home","subscription"])}},"sidebar@siteCmsPage":{templateUrl:"partials/home.sidebar/home.sidebar.html",controller:"SidebarController",controllerAs:"vm"},"mainmenu@siteCmsPage":{templateUrl:"partials/home.mainmenu/home.mainmenu.html",controller:"HomeMainmenuController",controllerAs:"vm"},"account@siteCmsPage":{templateUrl:"partials/home.account/home.account.html",controller:"HomeAccountController",controllerAs:"vm"},"cmsPage@siteCmsPage":{templateUrl:"partials/home.cmspage/home.cmspage.html",controller:"HomeCmsPageController",controllerAs:"vm"}}}).state("manageComments",{url:"/manage-comments",resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])},views:{"@":{templateUrl:"partials/home.settings/home.settings.html",controller:"HomeSettingsController",controllerAs:"vm",resolve:{settingsResolve:Resolve.commentSettingsResolve(),settingsTranslateResolve:Resolve.translatePartial(["home","subscription"])}},"sidebar@manageComments":{templateUrl:"partials/home.sidebar/home.sidebar.html",controller:"SidebarController",controllerAs:"vm"},"mainmenu@manageComments":{templateUrl:"partials/home.mainmenu/home.mainmenu.html",controller:"HomeMainmenuController",controllerAs:"vm"},"account@manageComments":{templateUrl:"partials/home.account/home.account.html",controller:"HomeAccountController",controllerAs:"vm"},"manageComments@manageComments":{templateUrl:"partials/home.managecomments/home.managecomments.html",controller:"HomeManageCommentsController",controllerAs:"vm"}}}).state("blockedComments",{url:"/blocked-users",resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])},views:{"@":{templateUrl:"partials/home.settings/home.settings.html",controller:"HomeSettingsController",controllerAs:"vm",resolve:{settingsResolve:Resolve.commentSettingsResolve(),settingsTranslateResolve:Resolve.translatePartial(["home","subscription"])}},"sidebar@blockedComments":{templateUrl:"partials/home.sidebar/home.sidebar.html",controller:"SidebarController",controllerAs:"vm"},"mainmenu@blockedComments":{templateUrl:"partials/home.mainmenu/home.mainmenu.html",controller:"HomeMainmenuController",controllerAs:"vm"},"account@blockedComments":{templateUrl:"partials/home.account/home.account.html",controller:"HomeAccountController",controllerAs:"vm"},"blockedComments@blockedComments":{templateUrl:"partials/home.blockedcomments/home.blockedcomments.html",controller:"HomeManageBlockedCommentsController",controllerAs:"vm"}}}).state("yourSubscription",{url:"/subscription",resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])},views:{"@":{templateUrl:"partials/home.settings/home.settings.html",controller:"HomeSettingsController",controllerAs:"vm",resolve:{settingsResolve:Resolve.commentSettingsResolve(),settingsTranslateResolve:Resolve.translatePartial(["home","subscription"])}},"sidebar@yourSubscription":{templateUrl:"partials/home.sidebar/home.sidebar.html",controller:"SidebarController",controllerAs:"vm"},"mainmenu@yourSubscription":{templateUrl:"partials/home.mainmenu/home.mainmenu.html",controller:"HomeMainmenuController",controllerAs:"vm"},"account@yourSubscription":{templateUrl:"partials/home.account/home.account.html",controller:"HomeAccountController",controllerAs:"vm"},"yourSubscription@yourSubscription":{templateUrl:"partials/home.subscription/home.subscription.html",controller:"HomeSubscriptionController",controllerAs:"vm"}}}).state("subscriptionDashboard",{url:"/subscription-dashboard",resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])},views:{"@":{templateUrl:"partials/home.settings/home.settings.html",controller:"HomeSettingsController",controllerAs:"vm",resolve:{settingsResolve:Resolve.commentSettingsResolve(),settingsTranslateResolve:Resolve.translatePartial(["home","subscription"])}},"sidebar@subscriptionDashboard":{templateUrl:"partials/home.sidebar/home.sidebar.html",controller:"SidebarController",controllerAs:"vm"},"mainmenu@subscriptionDashboard":{templateUrl:"partials/home.mainmenu/home.mainmenu.html",controller:"HomeMainmenuController",controllerAs:"vm"},"account@subscriptionDashboard":{templateUrl:"partials/home.account/home.account.html",controller:"HomeAccountController",controllerAs:"vm"},"subscriptionDashboard@subscriptionDashboard":{templateUrl:"partials/home.subs.dashboard/home.subs.dashboard.html",controller:"HomeSubscriptionDashboardController",controllerAs:"vm"}}}).state("paymentsDashboard",{url:"/payments",resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])},views:{"@":{templateUrl:"partials/home.settings/home.settings.html",controller:"HomeSettingsController",controllerAs:"vm",resolve:{settingsResolve:Resolve.commentSettingsResolve(),settingsTranslateResolve:Resolve.translatePartial(["home","subscription"])}},"sidebar@paymentsDashboard":{templateUrl:"partials/home.sidebar/home.sidebar.html",controller:"SidebarController",controllerAs:"vm"},"mainmenu@paymentsDashboard":{templateUrl:"partials/home.mainmenu/home.mainmenu.html",controller:"HomeMainmenuController",controllerAs:"vm"},"account@paymentsDashboard":{templateUrl:"partials/home.account/home.account.html",controller:"HomeAccountController",controllerAs:"vm"},"paymentsDashboard@paymentsDashboard":{templateUrl:"partials/home.payments/home.payments.html",controller:"HomePaymentsController",controllerAs:"vm"}}}).state("paymentsList",{url:"/your-payments",resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])},views:{"@":{templateUrl:"partials/home.settings/home.settings.html",controller:"HomeSettingsController",controllerAs:"vm",resolve:{settingsResolve:Resolve.commentSettingsResolve(),settingsTranslateResolve:Resolve.translatePartial(["home","subscription"])}},"sidebar@paymentsList":{templateUrl:"partials/home.sidebar/home.sidebar.html",controller:"SidebarController",controllerAs:"vm"},"mainmenu@paymentsList":{templateUrl:"partials/home.mainmenu/home.mainmenu.html",controller:"HomeMainmenuController",controllerAs:"vm"},"account@paymentsList":{templateUrl:"partials/home.account/home.account.html",controller:"HomeAccountController",controllerAs:"vm"},"paymentsList@paymentsList":{templateUrl:"partials/home.payments.list/home.payments.list.html",controller:"HomePaymentsListController",controllerAs:"vm"}}}).state("websiteName",{url:"/website-name",resolve:{baseResolve:Resolve.translatePartial(["base","subscription"])},views:{"@":{templateUrl:"partials/home.settings/home.settings.html",controller:"HomeSettingsController",controllerAs:"vm",resolve:{settingsResolve:Resolve.commentSettingsResolve(),settingsTranslateResolve:Resolve.translatePartial(["home","subscription"])}},"sidebar@websiteName":{templateUrl:"partials/home.sidebar/home.sidebar.html",controller:"SidebarController",controllerAs:"vm"},"mainmenu@websiteName":{templateUrl:"partials/home.mainmenu/home.mainmenu.html",controller:"HomeMainmenuController",controllerAs:"vm"},"account@websiteName":{templateUrl:"partials/home.account/home.account.html",controller:"HomeAccountController",controllerAs:"vm"},"websiteName@websiteName":{templateUrl:"partials/home.subs.sitename/home.subs.sitename.html",controller:"HomeSiteNameController",controllerAs:"vm"}}}).state("domain",{url:"/domain",templateUrl:"partials/domain/domain.html",controller:"DomainVerificationController",controllerAs:"vm",resolve:{loginTranslateResolve:Resolve.translatePartial(["base","domain"])}}),$urlRouterProvider.when("/?{editmode}",function($match,$stateParams,$injector){var $state=$injector.get("$state");$state.go("home",{editmode:$match.editmode})}).otherwise(function($injector,$location){var $state=$injector.get("$state"),isLoggedIn=Cookies.get(Common.Services.CookieNames.WEBAPI_TOKEN),isNewCustomer=!Cookies.get(Common.Services.CookieNames.NEW_CUSTOMER);if(isLoggedIn)$state.go("home");else if(isNewCustomer){var Auth=$injector.get("Auth");Auth.goToSignup()}else{var Auth=$injector.get("Auth");Auth.goToLogin()}}),$translateProvider.useLoader("$translatePartialLoader",{urlTemplate:function(part,lang){var bust=lodash.find(Common.Globals.translationBusts,function(value,key){return key==="/"+part+"/"+lang+".json"});return"/i18n/"+part+"/"+lang+".json?v="+bust}}).registerAvailableLanguageKeys(["da","de","en","es","fi","fr","id","it","nb","nl","pt","ru","sv","tr"],{"tr-*":"tr","sv-*":"sv","ru-*":"ru","pt-*":"pt","nl-*":"nl","nb-*":"nb","it-*":"it","id-*":"id","fr-*":"fr","fi-*":"fi","es-*":"es","de-*":"de","da-*":"da","*":"en"}).preferredLanguage("en").useSanitizeValueStrategy("escape").useMissingTranslationHandler("translationErrorHandler").fallbackLanguage("en")}function Run(UserEvents,$rootScope,$window){UserEvents.enable=!0}angular.module("app",["angularModalService","ui.tree","as.sortable","contenteditable","duScroll","matchMedia","ngAnimate","tmh.dynamicLocale","ngFileUpload","ngMap","ngRoute","ui.router","pascalprecht.translate","angularCSS","toggle-switch","ngMaterial","Common.Directives","Common.Factories","Common.Filters","Common.Services","Common.Tinymce","Components","Partials","ui.tinymce"]).config(function(tmhDynamicLocaleProvider){tmhDynamicLocaleProvider.localeLocationPattern("i18n/locale/angular-locale_{{locale}}.js")}).constant("lodash",window.lodash).config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider","$compileProvider","$translateProvider","$translatePartialLoaderProvider","$sceDelegateProvider","lodash",Config]).run(["UserEvents","$rootScope","$window",Run])}(app||(app={})),angular.module("Common.Services",[]);var Components;!function(Components){var IndexController=function(){function IndexController(EnvironmentService,ActiveSection,HomeComponentService){this.EnvironmentService=EnvironmentService,this.ActiveSection=ActiveSection,this.HomeComponentService=HomeComponentService,this.EnvironmentService.directionality=!1;var dir=this.EnvironmentService.directionality?"rtl":"ltr";window.document.dir=dir}return IndexController.$inject=["EnvironmentService","ActiveSection","HomeComponentService"],IndexController}();Components.IndexController=IndexController}(Components||(Components={})),angular.module("app").controller("IndexController",Components.IndexController),angular.module("Common.Directives",[]);var Common;!function(Common){var Directives;!function(Directives){function addSectionsControls($compile){return{scope:{showControls:"=",sectionIndex:"="},controller:Common.Directives.AddSectionsControlsController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/addSectionsControls/addSectionsControls.html",restrict:"E",transclude:!0}}Directives.addSectionsControls=addSectionsControls;var AddSectionsControlsController=function(){function AddSectionsControlsController(Sections,HomePreviewComponentService,HomeComponentService,Pages,ModalService,UserEvents,HelpboxService,$location,$anchorScroll,$window,EnvironmentService,HintService){this.Sections=Sections,this.HomePreviewComponentService=HomePreviewComponentService,this.HomeComponentService=HomeComponentService,this.Pages=Pages,this.ModalService=ModalService,this.UserEvents=UserEvents,this.HelpboxService=HelpboxService,this.$location=$location,this.$anchorScroll=$anchorScroll,this.$window=$window,this.EnvironmentService=EnvironmentService,this.HintService=HintService,this.sectionTypes=this.Sections.getAddableSectionTypes()}return AddSectionsControlsController.prototype.isBeaconActive=function(tour,hintId){return this.hintId=hintId,!(!this.HintService.isTourActive(tour)||null!=this.HomeComponentService.activeSection)},AddSectionsControlsController.prototype.handleAddClicked=function(){if(null==this.HomeComponentService.activeSection)this.UserEvents.send("V4AddPageContent"),this.HelpboxService.triggerTipsConditionChange("addedContent"),this.HomePreviewComponentService.sectionIndex=this.sectionIndex,this.ModalService.showModal({templateUrl:"partials/home.addsectionmodal/addsectionmodal.html",controller:"AddSectionModalController",controllerAs:"vm",inputs:{sectionIndex:this.sectionIndex}});else{var prefix=this.HomeComponentService.scrolltotop?"section_":"savecancel_";"title"==this.HomeComponentService.activeSection?this.$location.hash("site-preview"):this.$location.hash(prefix+this.HomeComponentService.activeSection.sectionId),this.$anchorScroll()}},AddSectionsControlsController.$inject=["Sections","HomePreviewComponentService","HomeComponentService","Pages","ModalService","UserEvents","HelpboxService","$location","$anchorScroll","$window","EnvironmentService","HintService"],AddSectionsControlsController}();Directives.AddSectionsControlsController=AddSectionsControlsController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("addSectionsControls",Common.Directives.addSectionsControls);var Common;!function(Common){var Directives;!function(Directives){function autoExpand($timeout){return{restrict:"A",link:function(scope,element,attrs){function autoExpand(){element[0].scrollHeight>=scrollLimit?(element[0].style.height=scrollLimit+"px",element[0].style.overflow="auto"):(element[0].style.overflow="hidden",element[0].style.height=0,element[0].style.height=element[0].scrollHeight+"px")}var scrollLimit=parseInt(attrs.autoExpand,10);$timeout(autoExpand),element.bind("keyup",autoExpand)}}}Directives.autoExpand=autoExpand}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("autoExpand",Common.Directives.autoExpand);var Common;!function(Common){var Directives;!function(Directives){function userEvent(UserEvents){return{restrict:"A",priority:-1,link:function(scope,element,attrs){element.click(function(e){UserEvents.send(attrs.userEvent)})}}}Directives.userEvent=userEvent}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("userEvent",Common.Directives.userEvent);var Common;!function(Common){var Directives;!function(Directives){var ColumnsSectionLinkModalController=function(){function ColumnsSectionLinkModalController(close,Pages,PagesMapper,$q,section){this.close=close,this.Pages=Pages,this.PagesMapper=PagesMapper,this.$q=$q,this.section=section,this.pages=Pages.flatList,this.headline=this.section.headline,this.link=this.section.link,this.link||(this.link={pageId:0,pageItemId:0}),this.shown=!0}return ColumnsSectionLinkModalController.prototype.selectedPageId=function(value){if(!arguments.length){var id="";return this.link&&this.link.pageId>0&&(id=this.link.pageId.toString(),this.link.pageItemId&&this.link.pageItemId>0&&(id+="_"+this.link.pageItemId.toString())),id}if(value){var v=parseInt(this.PagesMapper.convertPageIdToApi(value));v>0&&(this.link.pageId=v);var v1=parseInt(this.PagesMapper.getWebshopCategoryFromPageId(value));v1>0?this.link.pageItemId=v1:this.link.pageItemId=0}else this.link={pageId:0,pageItemId:0}},ColumnsSectionLinkModalController.prototype.done=function(){var deferred=this.$q.defer();return this.section.link=this.link,this.section.headline=this.headline,deferred.resolve(!0),deferred.promise},ColumnsSectionLinkModalController.$inject=["close","Pages","PagesMapper","$q","section"],ColumnsSectionLinkModalController}();Directives.ColumnsSectionLinkModalController=ColumnsSectionLinkModalController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("ColumnsSectionLinkModalController",Common.Directives.ColumnsSectionLinkModalController);var Common;!function(Common){var Directives;!function(Directives){var SectionController=function(){function SectionController($scope,Pages,ActiveSection,Sections,HomeComponentService,$injector){var _this=this;this.$scope=$scope,this.Pages=Pages,this.ActiveSection=ActiveSection,this.Sections=Sections,this.HomeComponentService=HomeComponentService,this.$injector=$injector,this.updateOriginalSection=function(){var areEquals=angular.equals(_this.section,_this.originalSection);areEquals||angular.copy(_this.section,_this.originalSection)},this.activate=function(){if(_this.HomeComponentService.editmode||_this.HomeComponentService.activeSection)if(_this.HomeComponentService.editmode=!1,_this.HomeComponentService.sidebar="none",null==_this.HomeComponentService.activeSection){var isActiveSectionNew=_this.HomeComponentService.activeSection&&_this.HomeComponentService.activeSection.sectionId!==_this.section.sectionId;(isActiveSectionNew||null==_this.HomeComponentService.activeSection)&&_this.scrollToSection(_this.section.sectionId),(isActiveSectionNew||null==_this.HomeComponentService.activeSection&&_this.section!==_this.originalSection)&&angular.copy(_this.section,_this.originalSection),_this.HomeComponentService.activeSection=_this.section,_this.ActiveSection.activeSectionId=_this.section.sectionId}else if(_this.ActiveSection.activeSectionId!==_this.section.sectionId){var prefix=_this.HomeComponentService.scrolltotop?"section_":"savecancel_";"title"==_this.HomeComponentService.activeSection?_this.$location.hash("site-preview"):_this.$location.hash(prefix+_this.HomeComponentService.activeSection.sectionId),_this.$anchorScroll()}},this.deactivate=function(mSection){var areEquals=angular.equals(mSection,_this.section);areEquals||angular.copy(mSection,_this.section),_this.updateOriginalSection(),_this.ActiveSection.activeSectionId=null,_this.HomeComponentService.activeSection=null,_this.HomeComponentService.editmode=!0},this.saveAndDeactivate=function($event){$event.stopPropagation();var isCurrentSectionEmpty=_this.isSectionEmpty(_this.section);isCurrentSectionEmpty?_this.HomePreviewComponentService.openDeleteModal(_this.section,!0):_this.addOrUpdateSection(!0).then(function(response){var section=response.data;_this.deactivate(section)})},this.cancel=function($event){$event.stopPropagation();var isOriginalEmpty=_this.isSectionEmpty(_this.originalSection);isOriginalEmpty?_this.HomePreviewComponentService.openDeleteModal(_this.section,!0):(_this.section=angular.copy(_this.originalSection),_this.deactivate(_this.section))},this.addOrUpdateSection=function(withUserEvents,showNotification){void 0===withUserEvents&&(withUserEvents=!0),void 0===showNotification&&(showNotification=!0);var def=_this.$q.defer();return _this.section?(_this.section.sectionId?_this.Sections.edit(_this.Pages.currentPage.pageType,_this.Pages.currentPage.pageId,_this.section).then(function(s){def.resolve(s),showNotification&&(_this.$translate("HOME.NOTIFICATIONS.SUCCESS_MESSAGE.SECTION_SAVED").then(function(text){_this.MdNotificationService.showSimpleToast(text)}),_this.HintService.isTourActive("AddContentTour")&&_this.HintService.endTour("PreviewTour"))}):_this.Sections.add(_this.Pages.currentPage.pageType,_this.Pages.currentPage.pageId,_this.section).then(function(s){def.resolve(s)}),withUserEvents&&_this.sendEvent()):def.reject(),def.promise},this.isTextBlank=function(text){var plaintext="none";return text&&(plaintext=text.toString().replace(/<(?:.|\n)*?>/gm,""),plaintext=plaintext.trim()),""===text||""===plaintext||void 0===text||null===text},this.preventEnter=function(event){13===event.keyCode&&event.preventDefault()},this.UserEvents=this.$injector.get("UserEvents"),this.lodash=this.$injector.get("lodash"),this.Experiments=this.$injector.get("Experiments"),this.$rootScope=this.$injector.get("$rootScope"),this.$location=this.$injector.get("$location"),this.$anchorScroll=this.$injector.get("$anchorScroll"),this.$q=this.$injector.get("$q"),this.SectionImagesApi=this.$injector.get("SectionImagesApi"),this.$window=this.$injector.get("$window"),this.EnvironmentService=this.$injector.get("EnvironmentService"),this.MdNotificationService=this.$injector.get("MdNotificationService"),this.$translate=this.$injector.get("$translate"),this.HintService=this.$injector.get("HintService"),this.originalSection={},this.updateOriginalSection()}return SectionController.prototype.isActive=function(){return this.ActiveSection.isActive(this.section.sectionId)},SectionController.prototype.sendEvent=function(){this.UserEvents.send("EngEditContentV4")},SectionController.prototype.scrollToSection=function(sectionId){this.EnvironmentService.isMobile?this.$window.location.href="#section_"+sectionId:this.$location.hash("section_"+sectionId),this.$anchorScroll()},SectionController}();Directives.SectionController=SectionController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={}));var Common;!function(Common){var Directives;!function(Directives){function columnssection(){return{scope:{section:"=",editmode:"="},controller:Common.Directives.ColumnssectionController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/columnssection/columnssection.html",restrict:"E",transclude:!0}}Directives.columnssection=columnssection;var ColumnssectionController=function(_super){function ColumnssectionController($scope,$stateParams,Sections,Pages,ActiveSection,HomeComponentService,SectionImagesApi,HomePreviewComponentService,EnvironmentService,ModalService,$injector,$q){var _this=this;_super.call(this,$scope,Pages,ActiveSection,Sections,HomeComponentService,$injector),this.$scope=$scope,this.$stateParams=$stateParams,this.Sections=Sections,this.Pages=Pages,this.ActiveSection=ActiveSection,this.HomeComponentService=HomeComponentService,this.SectionImagesApi=SectionImagesApi,this.HomePreviewComponentService=HomePreviewComponentService,this.EnvironmentService=EnvironmentService,this.ModalService=ModalService,this.$injector=$injector,this.$q=$q,this.saveAndDeactivate=function($event){$event.stopPropagation(),_this.isSectionEmpty(_this.section)?_this.HomePreviewComponentService.openDeleteModal(_this.section,!0):_this.uploadBlobsFirst().then(function(){_this.addOrUpdateSection(!0).then(function(response){var section=response.data;_this.deactivate(section)})})},this.uploadBlobsFirst=function(){var deferred=_this.$q.defer(),columnsWithUploadedImage=_this.lodash.filter(_this.section.columns,function(item){return item.image.blob}),blobsToUpload=_this.lodash.map(columnsWithUploadedImage,function(item){return item.image.blob});return blobsToUpload.length>0?_this.SectionImagesApi.uploadBlobs("standard",_this.$stateParams.pageId,"columns",_this.section.sectionId,blobsToUpload).then(function(data){columnsWithUploadedImage.forEach(function(column){column.image.id!=data[0]&&(column.image.id=data[0],data.splice(0,1),column.blob=null)}),deferred.resolve()},function(err){deferred.reject()}):deferred.resolve(),deferred.promise}}return __extends(ColumnssectionController,_super),ColumnssectionController.prototype.handleColumnsTypeChanged=function(value){this.section.layout=value;var thirdColumn={index:2,type:"",description:"",headline:"",link:null,imageedit:!1};"TwoColumn"==this.section.layout&&this.section.columns.length>2?(this.cachedColumn=this.section.columns[this.section.columns.length-1],this.section.columns.splice(2,1)):2===this.section.columns.length&&this.section.columns.push(this.cachedColumn?this.cachedColumn:thirdColumn)},ColumnssectionController.prototype.handleLinkClick=function($event){this.HomeComponentService.editmode&&$event.preventDefault()},ColumnssectionController.prototype.setActiveIndex=function(idx){this.HomeComponentService.activeSection&&(this.HomeComponentService.activeSection.activeColumnIndex=idx),this.section.activeColumnIndex=idx},ColumnssectionController.prototype.isImageEditMode=function(){var editedColumn=this.lodash.filter(this.section.columns,function(item){return item.imageedit});return editedColumn&&editedColumn.length>0},ColumnssectionController.prototype.openEditTitleModal=function(column){this.ModalService.showModal({templateUrl:"partials/columnssection/columns-linkmodal.html",controller:"ColumnsSectionLinkModalController",controllerAs:"vm",inputs:{section:column}})},ColumnssectionController.prototype.uploadImage=function(blob){var deferred=this.$q.defer(),idx=this.section.activeColumnIndex,urlCreator=window.URL||window.webkitURL;return this.section.columns[idx].image.url&&urlCreator.revokeObjectURL(this.section.columns[idx].image.url),this.section.columns[idx].image.url=urlCreator.createObjectURL(blob),this.section.columns[idx].image.blob=blob,deferred.resolve(this.section.columns[idx].image),deferred.promise},ColumnssectionController.prototype.deleteImage=function(image){var col=this.lodash.filter(this.section.columns,function(item){return item.image.url==image.url})[0];col.blob=null},ColumnssectionController.prototype.isSectionEmpty=function(mSection){var _this=this,isSectionEmpty=!0;return mSection.columns.forEach(function(column){isSectionEmpty=!(!_this.isTextBlank(column.headline)||!_this.isTextBlank(column.description)||!(column.image&&column.image.id<=0)&&column.image||column.link&&!(column.link&&column.link.pageId<=0)||column.image.blob)&&(isSectionEmpty&&!0)}),isSectionEmpty},ColumnssectionController.$inject=["$scope","$stateParams","Sections","Pages","ActiveSection","HomeComponentService","SectionImagesApi","HomePreviewComponentService","EnvironmentService","ModalService","$injector","$q"],
ColumnssectionController}(Directives.SectionController);Directives.ColumnssectionController=ColumnssectionController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("columnssection",Common.Directives.columnssection);var Common;!function(Common){var Directives;!function(Directives){function comments(){return{scope:{fullwidth:"&"},controller:Common.Directives.CommentsController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/comments/comments.html",restrict:"E",transclude:!0}}Directives.comments=comments;var CommentsController=function(){function CommentsController($scope,HomeComponentService,User,Pages,Site){this.$scope=$scope,this.HomeComponentService=HomeComponentService,this.User=User,this.Pages=Pages,this.Site=Site,this.isCommentsInfoBoxCollapsed=!0,this.isCommentsInfoBoxCollapsed=!0}return CommentsController.prototype.collapseCommentsInfoBox=function(){Cookies.set(Common.Services.CookieNames.COMMENTS_INFOBOX,!1,Common.Globals.DEFAULT_COOKIE_SETTINGS)},CommentsController.prototype.fullwidth=function(){if(this.User.user)return this.User.user.isPremiumCustomer&&!this.User.user.isFaceBookShareEnabled},CommentsController.$inject=["$scope","HomeComponentService","User","Pages","Site"],CommentsController}();Directives.CommentsController=CommentsController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("comments",Common.Directives.comments);var Common;!function(Common){var Directives;!function(Directives){function compileHtml($compile){return{restrict:"EA",scope:{message:"="},replace:!0,link:function(scope,element,attrs){element.html(scope.message),$compile(element.contents())(scope),scope.$watch("message",function(message){element.html(message),$compile(element.contents())(scope)})}}}Directives.compileHtml=compileHtml}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("compileHtml",Common.Directives.compileHtml);var Common;!function(Common){var Directives;!function(Directives){function contenteditable($compile,$document){return{restrict:"A",require:"?ngModel",compile:function(tElement,tAttrs){var tpl=tElement.contents();return function(scope,element,attrs,ngModel){function read(){var html=element.html();attrs.stripBr&&"<br>"===html&&(html=""),ngModel.$setViewValue(html)}ngModel&&($compile(tpl)(scope),ngModel.$render=function(){element.text(ngModel.$viewValue||"")},element.bind("keydown",function(event){13===event.keyCode&&event.preventDefault()}),element.bind("paste",function(event){event.clipboardData||(event=event.originalEvent),event.preventDefault();var text="",IE=!$document[0].queryCommandSupported("insertText");text=IE?window.clipboardData.getData("Text"):event.clipboardData.getData("text/plain"),text=text.replace(/<[^>]*>/g,"").replace(/\r?\n|\r/,""),IE?$document[0].execCommand("paste",!1,text.trim()):$document[0].execCommand("insertText",!1,text.trim())}),ngModel.$parsers.push(function(){return element.text().trim()}),element.on("blur keyup change",function(){scope.$evalAsync(read)}))}}}}Directives.contenteditable=contenteditable}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("contenteditable",Common.Directives.contenteditable);var Common;!function(Common){var Directives;!function(Directives){function convertToNumber(){return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ngModel){ngModel.$parsers.push(function(val){return parseInt(val,10)}),ngModel.$formatters.push(function(val){return""+(void 0!==val?val:"")})}}}Directives.convertToNumber=convertToNumber}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("convertToNumber",Common.Directives.convertToNumber);var Common;!function(Common){var Directives;!function(Directives){function enableJssor(){return{restrict:"A",scope:{jssorOptions:"=",jssorOnChanged:"&",jssorObject:"=",jssorTrigger:"="},controller:Common.Directives.JssorController,controllerAs:"vm",bindToController:!0}}Directives.enableJssor=enableJssor;var JssorController=function(){function JssorController($scope,$element,$window,$timeout){var _this=this;this.$scope=$scope,this.$element=$element,this.$window=$window,this.$timeout=$timeout,this.$scope.$watch("vm.jssorTrigger",function(){return _this.handleReady()}),angular.element(this.$window).bind("orientationchange",function(){_this.jssorObject&&_this.jssorObject.updateSliderWidth()}),angular.element(this.$window).bind("resize",function(){_this.jssorObject&&_this.jssorObject.updateSliderWidth()})}return JssorController.prototype.handleReady=function(){var _this=this;this.jssorTrigger&&this.$timeout(function(){return _this.init()})},JssorController.prototype.init=function(){var _this=this,container=this.$element.closest(".slides-container");container.attr("id")||(this.id=(new Date).getTime().toString(),container.attr("id",this.id));var slider=new $JssorSlider$(this.id,this.jssorOptions),handle={slidesCount:slider.$SlidesCount(),slider:slider,playTo:function(index){slider.$PlayTo(index)},goTo:function(index){slider.$GoTo(index)},pause:function(){slider.$Pause()},play:function(){slider.$Play()},previous:function(){slider.$Prev()},next:function(){slider.$Next()},setTransition:function(transition){slider.$SetSlideshowTransitions([transition])},updateSliderWidth:function(){var parent=angular.element(slider.$Elmt).parent();parent&&parent.width()>0?slider.$ScaleWidth(parent.width()):_this.$timeout(function(){return _this.jssorObject.updateSliderWidth()},50)}};this.jssorObject=handle,slider.$On($JssorSlider$.$EVT_PARK,function(slideIndex,fromIndex){var status={id:_this.id,slideIndex:slideIndex,fromIndex:fromIndex};_this.jssorOnChanged&&_this.jssorOnChanged({jssorData:status})}),handle.playTo(this.jssorOptions.$StartIndex),this.jssorOptions.onReady&&this.jssorOptions.onReady()},JssorController.$inject=["$scope","$element","$window","$timeout"],JssorController}();Directives.JssorController=JssorController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("enableJssor",Common.Directives.enableJssor);var Common;!function(Common){var Directives;!function(Directives){function dividersection(){return{scope:{section:"="},controller:Common.Directives.DividerSectionController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/dividersection/dividersection.html",restrict:"E",replace:!0,transclude:!0}}Directives.dividersection=dividersection;var DividerSectionController=function(_super){function DividerSectionController($scope,Sections,Pages,ActiveSection,HomeComponentService,$injector,$translate){var _this=this;_super.call(this,$scope,Pages,ActiveSection,Sections,HomeComponentService,$injector),this.$scope=$scope,this.Sections=Sections,this.Pages=Pages,this.ActiveSection=ActiveSection,this.HomeComponentService=HomeComponentService,this.$injector=$injector,this.$translate=$translate,this.saveAndDeactivate=function($event){$event.stopPropagation(),_this.addOrUpdateSection(!0).then(function(response){var section=response.data;_this.deactivate(section)})},this.handleSelectedDividerChanged=function(){_this.selectDivider(_this.divider)},this.selectDivider=function(dv){_this.divider=dv,_this.section.dividerType=dv.id},this.buildDividersList=function(){_this.dividerTypes=[{id:"solid",display:"Solid"},{id:"dashed",display:"Dashed"},{id:"dotted",display:"Dotted"}],_this.dividerTypes.forEach(function(dt){_this.$translate("HOME.PREVIEW.DIVIDER_SECTION.STYLES."+dt.id.toUpperCase()).then(function(text){dt.display=text})})},this.buildDividersList(),this.divider=this.lodash.find(this.dividerTypes,function(f){return f.id==_this.section.dividerType})}return __extends(DividerSectionController,_super),DividerSectionController.prototype.isSectionEmpty=function(mSection){return null==mSection},DividerSectionController.$inject=["$scope","Sections","Pages","ActiveSection","HomeComponentService","$injector","$translate"],DividerSectionController}(Directives.SectionController);Directives.DividerSectionController=DividerSectionController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("dividersection",Common.Directives.dividersection);var Common;!function(Common){var Directives;!function(Directives){function helpboxButton($compile){return{scope:{},controller:Common.Directives.HelpboxController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/helpboxButton/helpboxButton.html",restrict:"E",transclude:!0}}Directives.helpboxButton=helpboxButton;var HelpboxController=function(){function HelpboxController($scope,$document,$element,$translate,ModalService,HelpboxService,HomeComponentService,EnvironmentService,lodash,UserEvents){var _this=this;this.$scope=$scope,this.$document=$document,this.$element=$element,this.$translate=$translate,this.ModalService=ModalService,this.HelpboxService=HelpboxService,this.HomeComponentService=HomeComponentService,this.EnvironmentService=EnvironmentService,this.lodash=lodash,this.UserEvents=UserEvents,this.closing=!1,this.isOpen=!1,this.initTips(),this.HelpboxService.isTriggersEnabled&&(this.HelpboxService.addTipsChangedListener(this.tipsChanged,this),this.$scope.$on("$destroy",function(){_this.HelpboxService.removeTipsChangedListener(_this)})),this.$element.on("click",function(e){return!1}),this.$document.on("click",function(){_this.cancel()}),this.currentTip=this.tips[0],this.showBackButton=!1}return HelpboxController.prototype.openPopup=function(){this.isOpen=!0,this.pulse=!1,this.UserEvents.send("V4HelpClicked")},HelpboxController.prototype.initTips=function(){var tips=this.HelpboxService.getTips();if(this.HelpboxService.isTriggersEnabled){var tipsDifference=this.lodash.difference(tips,this.tips),tipAdded=tipsDifference.length>0;tipAdded&&(this.pulse=!0)}this.tips=tips,this.updateVisibility()},HelpboxController.prototype.updateVisibility=function(){var _this=this;return 0===this.HelpboxService.getTips().length?void(this.visible=!1):this.EnvironmentService.isMobile?void(this.visible=!1):void this.HelpboxService.isExperimentEnabled().then(function(isExperimentEnabled){return isExperimentEnabled?void(_this.visible=!0):void(_this.visible=!1)})},HelpboxController.prototype.tipsChanged=function(){this.initTips()},HelpboxController.prototype.changeTip=function(index){this.currentTip=this.tips[index],this.showBackButton=index>0},HelpboxController.prototype.cancel=function(){this.isOpen=!1,this.pulse=!1,this.currentTip=this.tips[0],this.showBackButton=!1},HelpboxController.prototype.goBack=function(){this.currentTip=this.tips[0],this.showBackButton=!1},HelpboxController.$inject=["$scope","$document","$element","$translate","ModalService","HelpboxService","HomeComponentService","EnvironmentService","lodash","UserEvents"],HelpboxController}();Directives.HelpboxController=HelpboxController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("helpboxButton",Common.Directives.helpboxButton);var Common;!function(Common){var Directives;!function(Directives){function herosectionControls($compile){return{scope:{alignment:"<",includeCta:"<",onAlign:"&",section:"="},controller:Common.Directives.HerosectionControlsController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/herosection/herosection-controls.html",restrict:"E",transclude:!0}}Directives.herosectionControls=herosectionControls;var HerosectionControlsController=function(){function HerosectionControlsController($scope,HomeComponentService,EnvironmentService){this.$scope=$scope,this.HomeComponentService=HomeComponentService,this.EnvironmentService=EnvironmentService}return HerosectionControlsController.prototype.setAlignment=function(alignment){this.alignment=alignment,this.onAlign({alignment:alignment})},HerosectionControlsController.$inject=["$scope","HomeComponentService","EnvironmentService"],HerosectionControlsController}();Directives.HerosectionControlsController=HerosectionControlsController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("herosectionControls",Common.Directives.herosectionControls);var Common;!function(Common){var Directives;!function(Directives){var HerosectionCtaOptionsController=function(){function HerosectionCtaOptionsController(close,Pages,PagesMapper,sectionCta){this.close=close,this.Pages=Pages,this.PagesMapper=PagesMapper,this.sectionCta=sectionCta,this.errors={},this.pages=Pages.flatList,this.cta={},angular.extend(this.cta,this.sectionCta),this.cta.link=this.cta.link||{},this.cta.link.pageId&&(this.selectedPageId=this.cta.link.pageId.toString(),this.cta.link.categoryId&&this.cta.link.categoryId>0&&(this.selectedPageId+="_"+this.cta.link.categoryId.toString())),this.shown=!0}return HerosectionCtaOptionsController.prototype.done=function(event){event.preventDefault(),this.selectedPageId&&this.selectedPageId.length>0?(this.cta.link.pageId=parseInt(this.PagesMapper.convertPageIdToApi(this.selectedPageId)),this.cta.link.categoryId=parseInt(this.PagesMapper.getWebshopCategoryFromPageId(this.selectedPageId))):(this.cta.link.pageId=null,this.cta.link.categoryId=null),this.cancel()},HerosectionCtaOptionsController.prototype.cancel=function(){this.shown=!1,this.close({cta:this.cta})},HerosectionCtaOptionsController.$inject=["close","Pages","PagesMapper","sectionCta"],HerosectionCtaOptionsController}();Directives.HerosectionCtaOptionsController=HerosectionCtaOptionsController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("HerosectionCtaOptionsController",Common.Directives.HerosectionCtaOptionsController);var Common;!function(Common){var Directives;!function(Directives){function herosection($compile){return{scope:{section:"="},controller:Common.Directives.HerosectionController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/herosection/herosection.html",restrict:"E",transclude:!0}}Directives.herosection=herosection;var HerosectionController=function(_super){function HerosectionController($scope,$injector,$q,$state,$translate,$window,Pages,Sections,ActiveSection,$element,HomeComponentService,HomePreviewComponentService,SectionImagesApi,ModalService,EnvironmentService,$stateParams){var _this=this;_super.call(this,$scope,Pages,ActiveSection,Sections,HomeComponentService,$injector),this.$scope=$scope,this.$injector=$injector,this.$q=$q,this.$state=$state,this.$translate=$translate,this.$window=$window,this.Pages=Pages,this.Sections=Sections,this.ActiveSection=ActiveSection,this.$element=$element,this.HomeComponentService=HomeComponentService,this.HomePreviewComponentService=HomePreviewComponentService,this.SectionImagesApi=SectionImagesApi,this.ModalService=ModalService,this.EnvironmentService=EnvironmentService,this.$stateParams=$stateParams,this.defaultAlignment="center",this.saveAndDeactivate=function($event){$event.stopPropagation(),_this.saveSection().then(function(section){_this.deactivate(section)})},this.ensureDefaults(),this.contentStyle={"text-align":this.defaultAlignment},$scope.$watch("vm.section.alignment",function(newValue,oldvalue){newValue?_this.contentStyle["text-align"]=newValue:_this.contentStyle["text-align"]=_this.defaultAlignment})}return __extends(HerosectionController,_super),HerosectionController.prototype.ensureDefaults=function(){null!==this.section.headline&&void 0!==this.section.headline||(this.section.headline=this.$translate.instant("HOME.PREVIEW.HERO_SECTION.HEADLINE_PLACEHOLDER")),null!==this.section.text&&void 0!==this.section.text||(this.section.text=this.$translate.instant("HOME.PREVIEW.HERO_SECTION.TEXT_PLACEHOLDER")),null!==this.section.cta&&void 0!==this.section.cta||(this.section.cta={},null!==this.section.cta.text&&void 0!==this.section.cta.text||(this.section.cta.text=this.$translate.instant("HOME.PREVIEW.HERO_SECTION.CTA_PLACEHOLDER"))),this.updateOriginalSection(),this.saveSection(!1)},HerosectionController.prototype.isSectionEmpty=function(mSection){var isSectionEmpty=!1;return 0!=mSection.cta.show||!this.isTextBlank(mSection.text)||null!=mSection.headline&&""!=mSection.headline||null!=mSection.image.url&&""!=mSection.image.url||(isSectionEmpty=!0),isSectionEmpty},HerosectionController.prototype.align=function(alignment){this.section.alignment=alignment},HerosectionController.prototype.toggleIncludeCta=function(include){this.section.cta.show=include},HerosectionController.prototype.handleCtaButtonClicked=function(){var isSectionActivated=this.isActive(),isPreviewMode=!this.HomeComponentService.editmode;isSectionActivated?this.openCTAOptions():isPreviewMode&&this.goToCtaPage()},HerosectionController.prototype.saveSection=function(showNotification){var _this=this;void 0===showNotification&&(showNotification=!0);var deferred=this.$q.defer();return this.preSaveSectionImage().then(function(){_this.addOrUpdateSection(!0,showNotification).then(function(response){var section=response.data;deferred.resolve(section)})}),deferred.promise},HerosectionController.prototype.preSaveSectionImage=function(){var def=this.$q.defer(),sec=this.section;if(sec&&sec.image&&sec.image.blob){var uploadPromise=this.SectionImagesApi.upload(this.Pages.currentPage.pageType,this.Pages.currentPage.pageId,this.section.type,this.section.sectionId,sec.image,sec.image.blob);uploadPromise.then(function(data){sec.image.url=data.url,sec.image.id=data.id,def.resolve()})}else def.resolve();return def.promise},HerosectionController.prototype.goToCtaPage=function(){var pageId=this.section.cta.link.pageId,categoryId=this.section.cta.link.categoryId;categoryId&&categoryId>0?this.$state.go("home",{pageId:pageId+"_"+categoryId,categoryId:categoryId}):this.$state.go("home",{pageId:pageId})},HerosectionController.prototype.openCTAOptions=function(){var _this=this;this.ModalService.showModal({templateUrl:"partials/herosection/herosection-cta-options.html",controller:"HerosectionCtaOptionsController",controllerAs:"vm",inputs:{sectionCta:this.section.cta}}).then(function(modal){modal.close.then(function(modalData){if(modalData){var cta=modalData.cta;cta&&(_this.section.cta=cta)}})})},HerosectionController.$inject=["$scope","$injector","$q","$state","$translate","$window","Pages","Sections","ActiveSection","$element","HomeComponentService","HomePreviewComponentService","SectionImagesApi","ModalService","EnvironmentService","$stateParams"],HerosectionController}(Directives.SectionController);Directives.HerosectionController=HerosectionController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("herosection",Common.Directives.herosection);var Common;!function(Common){var Directives;!function(Directives){function iconButton(){return{restrict:"E",replace:!1,scope:{icon:"@",iconType:"@"},templateUrl:"partials/iconbutton/iconbutton.html",link:function(scope,element,attrs){void 0===scope.iconType&&(scope.iconType="circle")}}}Directives.iconButton=iconButton}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("iconButton",Common.Directives.iconButton);var Common;!function(Common){var Directives;!function(Directives){function imageonload(){return{restrict:"A",link:function(scope,element,attrs){element.bind("load",function(){scope.$apply(attrs.imageonload)})}}}Directives.imageonload=imageonload}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("imageonload",Common.Directives.imageonload);var Common;!function(Common){var Directives;!function(Directives){function imagesection(){return{scope:{section:"="},controller:Common.Directives.ImagesectionController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/imagesection/imagesection.html",restrict:"E",replace:!0,transclude:!0}}Directives.imagesection=imagesection;var ImagesectionController=function(_super){function ImagesectionController($scope,Sections,Pages,ActiveSection,HomeComponentService,HomePreviewComponentService,$injector,$q){var _this=this;_super.call(this,$scope,Pages,ActiveSection,Sections,HomeComponentService,$injector),this.$scope=$scope,this.Sections=Sections,this.Pages=Pages,this.ActiveSection=ActiveSection,this.HomeComponentService=HomeComponentService,this.HomePreviewComponentService=HomePreviewComponentService,this.$injector=$injector,this.$q=$q,this.saveAndDeactivate=function($event){$event.stopPropagation();var isCurrentSectionEmpty=_this.isSectionEmpty(_this.section);isCurrentSectionEmpty?_this.HomePreviewComponentService.openDeleteModal(_this.section,!0):_this.section.image.blob?_this.SectionImagesApi.upload(_this.Pages.currentPage.pageType,_this.Pages.currentPage.pageId,_this.section.type,_this.section.sectionId,_this.section.image,_this.section.image.blob).then(function(response){_this.section.image.url=response.url,_this.section.image.id=response.id,_this.updateSection()}):_this.updateSection()},this.updateSection=function(){_this.addOrUpdateSection(!0).then(function(response){var section=response.data;_this.deactivate(section)})}}return __extends(ImagesectionController,_super),ImagesectionController.prototype.isSectionEmpty=function(mSection){var isSectionEmpty=!1;return null!=mSection.image.url&&""!=mSection.image.url||(isSectionEmpty=!0),isSectionEmpty},ImagesectionController.$inject=["$scope","Sections","Pages","ActiveSection","HomeComponentService","HomePreviewComponentService","$injector","$q"],ImagesectionController}(Directives.SectionController);Directives.ImagesectionController=ImagesectionController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("imagesection",Common.Directives.imagesection);var Common;!function(Common){var Directives;!function(Directives){var MapSectionModalController=function(){function MapSectionModalController(close,section){this.close=close,this.section=section,this.mapStyle=this.section.style,this.allowDragging=this.section.allowDragging,this.showStreetViewControl=this.section.showStreetViewControl,this.showZoomControl=this.section.showZoomControl,this.showMapSatelliteControl=this.section.showMapSatelliteControl,this.showMarker=this.section.showMarker,this.bubbleText=this.section.bubbleText,this.shown=!0}return MapSectionModalController.prototype.closeModal=function(){this.shown=!1,this.close({},0)},MapSectionModalController.prototype.changeMapStyle=function(val){this.mapStyle=val},MapSectionModalController.prototype.done=function(){this.section.style=this.mapStyle,this.section.allowDragging=this.allowDragging,this.section.showStreetViewControl=this.showStreetViewControl,this.section.showZoomControl=this.showZoomControl,this.section.showMapSatelliteControl=this.showMapSatelliteControl,this.section.showMarker=this.showMarker,this.section.bubbleText=this.bubbleText,this.closeModal()},MapSectionModalController.$inject=["close","section"],MapSectionModalController}();Directives.MapSectionModalController=MapSectionModalController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("MapSectionModalController",Common.Directives.MapSectionModalController);var Common;!function(Common){var Directives;!function(Directives){function mapsection(){return{scope:{section:"="},controller:Common.Directives.MapSectionController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/mapsection/mapsection.html",restrict:"E",replace:!0,transclude:!0}}Directives.mapsection=mapsection;var MapSectionController=function(_super){function MapSectionController($scope,Sections,Pages,ActiveSection,HomeComponentService,HomePreviewComponentService,EnvironmentService,ModalService,$injector,GoogleMaps,NgMap){var _this=this;_super.call(this,$scope,Pages,ActiveSection,Sections,HomeComponentService,$injector),this.$scope=$scope,this.Sections=Sections,this.Pages=Pages,this.ActiveSection=ActiveSection,this.HomeComponentService=HomeComponentService,this.HomePreviewComponentService=HomePreviewComponentService,this.EnvironmentService=EnvironmentService,this.ModalService=ModalService,this.$injector=$injector,this.GoogleMaps=GoogleMaps,this.NgMap=NgMap,this.beforeSettingsOpenState={},this.activateAndSetMapPosition=function(){_this.activate(),_this.isActive()&&_this.setMapPosition()},this.saveAndDeactivate=function($event){$event.stopPropagation(),_this.isSectionEmpty(_this.section)?_this.HomePreviewComponentService.openDeleteModal(_this.section,!0):_this.setMapPosition().then(function(){_this.addOrUpdateSection(!0).then(function(response){var section=response.data;_this.setMapScrollAndDeactivate(section)})})},this.setMapPosition=function(){var deferred=_this.$q.defer();_this.section.zoomLevel=_this.map.getZoom(),_this.section.style=_this.map.mapTypeId;var loc=_this.googleMapWrapper.getLocation();return loc&&(_this.section.latitude=loc.lat(),_this.section.longitude=loc.lng()),deferred.resolve(),deferred.promise},this.setMapScroll=function(val){_this.googleMapWrapper.setMapScroll(val)},this.setMapScrollAndDeactivate=function(section){_this.setMapScroll(!1),_this.deactivate(section)},angular.copy(this.section,this.beforeSettingsOpenState),this.section.style||(this.section.style="roadmap"),GoogleMaps.init().then(function(){_this.mapLoaded=!0,_this.NgMap.getMap({id:"gmap_"+_this.section.sectionId}).then(function(m){_this.map=m,_this.googleMapWrapper=new Common.Models.GoogleMapsWrapper(m,"infoWindow_"+_this.section.sectionId,"gmapMarker_"+_this.section.sectionId)}).then(function(){_this.googleMapWrapper.setMapScroll(!1),_this.updateMap()})})}return __extends(MapSectionController,_super),MapSectionController.prototype.isSectionEmpty=function(mSection){return!1},MapSectionController.prototype.onAddressKeyUp=function(){this.section.zoomLevel<=15&&(this.googleMapWrapper.setZoom(17),this.section.zoomLevel=17)},MapSectionController.prototype.toggleSettings=function(){var _this=this;this.EnvironmentService.isMobile?this.ModalService.showModal({templateUrl:"partials/mapsection/mapsection.modal.html",controller:"MapSectionModalController",controllerAs:"vm",inputs:{section:this.section}}).then(function(modal){modal.close.then(function(){_this.updateMap()})}):(this.beforeSettingsOpenState.style=this.section.style,this.beforeSettingsOpenState.allowDragging=this.section.allowDragging,this.beforeSettingsOpenState.showStreetViewControl=this.section.showStreetViewControl,this.beforeSettingsOpenState.showZoomControl=this.section.showZoomControl,this.beforeSettingsOpenState.showMapSatelliteControl=this.section.showMapSatelliteControl,this.beforeSettingsOpenState.showMarker=this.section.showMarker,this.beforeSettingsOpenState.bubbleText=this.section.bubbleText,this.showSettings=!this.showSettings),this.googleMapWrapper.centerMap()},MapSectionController.prototype.cancelMap=function($event){this.updateMap(),this.cancel($event)},MapSectionController.prototype.updateMap=function(){this.showMarkerChange(),this.showMapSatelliteControlChange(),this.showZoomControlChange(),this.showStreetViewControlChange(),this.allowDraggingChange(),this.setMapStyle(),this.googleMapWrapper.setZoom(this.section.zoomLevel),this.googleMapWrapper.centerMap()},MapSectionController.prototype.changeMapStyle=function(val){this.section.style=val,this.googleMapWrapper.setMapStyle(val)},MapSectionController.prototype.setMapStyle=function(){this.googleMapWrapper.setMapStyle(this.section.style)},MapSectionController.prototype.showMarkerChange=function(){this.googleMapWrapper.setMarkerVisible(this.section.showMarker),this.section.showMarker&&this.section.bubbleText&&this.section.bubbleText.length>0?this.googleMapWrapper.openInfoWindow():this.googleMapWrapper.closeInfoWindow()},MapSectionController.prototype.showMapSatelliteControlChange=function(){this.googleMapWrapper.setMapTypeControl(this.section.showMapSatelliteControl)},MapSectionController.prototype.showZoomControlChange=function(){this.googleMapWrapper.setZoomControl(this.section.showZoomControl)},MapSectionController.prototype.showStreetViewControlChange=function(){this.googleMapWrapper.setStreetViewControl(this.section.showStreetViewControl)},MapSectionController.prototype.allowDraggingChange=function(){this.googleMapWrapper.setMapDrag(this.section.allowDragging)},MapSectionController.prototype.cancelSettingsChange=function(){this.section.style=this.beforeSettingsOpenState.style,this.section.allowDragging=this.beforeSettingsOpenState.allowDragging,this.section.showStreetViewControl=this.beforeSettingsOpenState.showStreetViewControl,this.section.showZoomControl=this.beforeSettingsOpenState.showZoomControl,this.section.showMapSatelliteControl=this.beforeSettingsOpenState.showMapSatelliteControl,this.section.showMarker=this.beforeSettingsOpenState.showMarker,this.section.bubbleText=this.beforeSettingsOpenState.bubbleText,this.toggleSettings(),this.updateMap(),this.googleMapWrapper.centerMap()},MapSectionController.$inject=["$scope","Sections","Pages","ActiveSection","HomeComponentService","HomePreviewComponentService","EnvironmentService","ModalService","$injector","GoogleMaps","NgMap"],MapSectionController}(Directives.SectionController);Directives.MapSectionController=MapSectionController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("mapsection",Common.Directives.mapsection);var Common;!function(Common){var Directives;!function(Directives){function newssection(){return{scope:{section:"="},controller:Common.Directives.NewssectionController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/newssection/newssection.html",restrict:"E",transclude:!0}}var NewssectionController=function(_super){function NewssectionController($scope,Pages,Sections,HomeComponentService,ActiveSection,$injector,$filter){_super.call(this,$scope,Pages,ActiveSection,Sections,HomeComponentService,$injector),this.$scope=$scope,this.Pages=Pages,this.Sections=Sections,this.HomeComponentService=HomeComponentService,this.ActiveSection=ActiveSection,this.$injector=$injector,this.$filter=$filter,this.news={title:"",date:new Date,description:"",url:""},this.editNewsItemFlag=[],this.showAddNewsFlag=!1,this.pages=[],this.pages=Pages.list,this.newNewsDate=new Date}return __extends(NewssectionController,_super),NewssectionController.prototype.cancelAdd=function(){this.showAddNewsFlag=!1,this.newNewsDate=this.savedNewsDateForCancel,this.resetNews()},NewssectionController.prototype.deleteNews=function(section,itemIndex){var _this=this;this.Sections.deleteItem(this.Pages.currentPage.pageType,this.Pages.currentPage.pageId,section.type,section.sectionId,itemIndex).success(function(){_this.lodash.pullAt(_this.section.newsItems,itemIndex),_this.hideEditNewsItem(-1)})},NewssectionController.prototype.isSectionEmpty=function(mSection){return null==mSection},NewssectionController.prototype.saveItem=function(){var _this=this;this.news.index=0,this.news.type="News",this.news.date=this.newNewsDate,this.Sections.addItem(this.Pages.currentPage.pageType,this.Pages.currentPage.pageId,this.section.type,this.section.sectionId,this.news).success(function(item){_this.section.newsItems.unshift(item),_this.resetNews()}),this.UserEvents.send("EngEditContentV4")},NewssectionController.prototype.showAddNews=function(open){this.savedNewsDateForCancel=new Date,this.resetNews(),angular.isDefined(open)?this.showAddNewsFlag=open:this.showAddNewsFlag=!this.showAddNewsFlag;for(var i=0;i<this.editNewsItemFlag.length;i++)this.editNewsItemFlag[i]=!1},NewssectionController.prototype.showEditNewsItem=function($event,itemIndex){if($event.stopPropagation(),this.isActive()&&!this.editNewsItemFlag[itemIndex]){
for(var i=0;i<this.editNewsItemFlag.length;i++)this.editNewsItemFlag[i]=!1;this.showAddNews(!1),this.news=angular.copy(this.section.newsItems[itemIndex]),this.editNewsItemFlag[itemIndex]=!0}},NewssectionController.prototype.isEditingItem=function(){for(var i=0;i<this.editNewsItemFlag.length;i++)if(this.editNewsItemFlag[i])return!0;return!1},NewssectionController.prototype.hideEditNewsItem=function(index,$event){$event&&$event.stopPropagation();for(var i=0;i<this.editNewsItemFlag.length;i++)this.editNewsItemFlag[i]=!1;index>=0&&(this.section.newsItems[index].date=this.news.date)},NewssectionController.prototype.updateNewsItem=function($event,itemIndex){var _this=this;$event.stopPropagation(),this.news.type="News",this.news.date=this.section.newsItems[itemIndex].date,this.Sections.updateItem(this.Pages.currentPage.pageType,this.Pages.currentPage.pageId,this.section.type,this.section.sectionId,itemIndex,this.news).success(function(data){_this.section.newsItems[itemIndex]=data,_this.editNewsItemFlag[itemIndex]=!1})},NewssectionController.prototype.formatV3Url=function(pageId){return pageId&&pageId.indexOf("_")>-1?pageId.replace("_","/category/"):pageId},NewssectionController.prototype.formatV4Url=function(pageId){return pageId&&pageId.indexOf("/category/")>-1?pageId.replace("/category/","_"):pageId},NewssectionController.prototype.resetNews=function(){this.news={title:"",date:new Date,description:"",url:""}},NewssectionController.$inject=["$scope","Pages","Sections","HomeComponentService","ActiveSection","$injector","$filter"],NewssectionController}(Directives.SectionController);Directives.NewssectionController=NewssectionController,Directives.newssection=newssection}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("newssection",Common.Directives.newssection);var Common;!function(Common){var Directives;!function(Directives){function ngOnloadDirective(){return{restrict:"A",scope:{callback:"&ngOnload"},link:function(scope,element,attrs){element.on("load",function(event){return scope.callback({event:event})})}}}Directives.ngOnloadDirective=ngOnloadDirective}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("ngOnload",Common.Directives.ngOnloadDirective);var Common;!function(Common){var Directives;!function(Directives){function packeryContainer(){return{constrain:"A",scope:{onStaticClick:"&",onDragEnd:"&"},link:function(scope,element,attrs){element.ready(function(){var packery=new Packery(element[0],{itemSelector:".item",columnWidth:227,rowHeight:172});packery.on("layoutComplete",function(){scope.$emit("packery:layoutComplete",this)}),packery.on("dragItemPositioned",function(){scope.$emit("packery:dragItemPositioned",this)}),scope.$on("packery:reLayout",function(){packery.layout()}),angular.forEach(packery.getItemElements(),function(item){var draggable=new Draggabilly(item,{containment:!0});packery.bindDraggabillyEvents(draggable),draggable.on("dragEnd",function(event,pointer){scope.onDragEnd(event)}).on("staticClick",function(event,pointer){scope.onStaticClick(event)})}),packery.layout()})}}}Directives.packeryContainer=packeryContainer}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("packeryContainer",Common.Directives.packeryContainer);var Common;!function(Common){var Directives;!function(Directives){function photoalbumImage(){return{scope:{editmode:"&",image:"=",editimage:"=?",minheight:"@?",maxheight:"@?",minwidth:"@?",maxwidth:"@?",hasCaption:"=?",hasPosition:"=?",fitstyle:"@?",onDelete:"&"},controller:Common.Directives.photoalbumImageController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/photoalbum-image/photoalbum-image.html",restrict:"E",replace:!0,transclude:!0}}Directives.photoalbumImage=photoalbumImage;var photoalbumImageController=function(){function photoalbumImageController($scope,HomeComponentService,EnvironmentService,Pages,$stateParams,PhotoAlbum){this.$scope=$scope,this.HomeComponentService=HomeComponentService,this.EnvironmentService=EnvironmentService,this.Pages=Pages,this.$stateParams=$stateParams,this.PhotoAlbum=PhotoAlbum,this.uploading=!1,this.uploadProgress=0,this.editimage=!1,this.minheight="150px",this.minwidth="200px"}return photoalbumImageController.prototype.deleteImage=function(){var _this=this;this.PhotoAlbum.deleteImage(this.Pages.currentPage.pageId,this.image.imageContainerId).then(function(){_this.onDelete({imageId:_this.image.imageContainerId})})},photoalbumImageController.prototype.uploadImage=function(file){var _this=this;if(!file)throw Error("uploadImage: file is empty");var pageId=this.Pages.currentPage.pageId;this.PhotoAlbum.replaceFile(pageId,this.image.imageContainerId,file).then(function(response){_this.image=response,_this.uploading=!1,_this.editimage=!1,_this.PhotoAlbum.updateImage(pageId,_this.image)})["catch"](function(err){_this.uploading=!1,_this.editimage=!1})},photoalbumImageController.$inject=["$scope","HomeComponentService","EnvironmentService","Pages","$stateParams","PhotoAlbum"],photoalbumImageController}();Directives.photoalbumImageController=photoalbumImageController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("photoalbumImage",Common.Directives.photoalbumImage);var Common;!function(Common){var Directives;!function(Directives){function popoverTether($compile){return{restrict:"EA",replace:!0,scope:{popoverTether:"="},compile:function(tElement,tAttrs,transclude){return{pre:function(scope,element,attrs,controller){},post:function(scope,element,attrs,controller){var _this=this,tether=new Tether({element:document.querySelector(attrs.target),target:element[0],attachment:attrs.attachment,targetAttachment:attrs.targetAttachment,offset:attrs.offset,enabled:!1});tether.enable(),scope.popoverTether=tether,this.targetElement=document.querySelector(attrs.target),element.on("$destroy",function(){var parent=_this.targetElement.parentElement;parent&&parent.removeChild(_this.targetElement)})}}}}}Directives.popoverTether=popoverTether}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("popoverTether",Common.Directives.popoverTether);var Common;!function(Common){var Directives;!function(Directives){function previewSiteUrlPopup(){return{bindings:{},controller:Common.Directives.PreviewSiteUrlPopupController,controllerAs:"vm",templateUrl:"partials/preview-site-url-popup/preview-site-url-popup.html",restrict:"E",replace:!0}}Directives.previewSiteUrlPopup=previewSiteUrlPopup;var PreviewSiteUrlPopupController=function(){function PreviewSiteUrlPopupController($scope,User,CustomerFlagsService,HomeComponentService){var _this=this;this.$scope=$scope,this.User=User,this.CustomerFlagsService=CustomerFlagsService,this.HomeComponentService=HomeComponentService,this.url=this.User.user.fullUrl,this.checkDisplayBox(),this.$scope.$watch("vm.HomeComponentService.editmode",function(editmode){_this.checkDisplayBox()})}return PreviewSiteUrlPopupController.prototype.checkDisplayBox=function(){var _this=this;this.HomeComponentService.editmode||this.HomeComponentService.activeSection||this.hasBeenShown||this.CustomerFlagsService.hasFlag("V4ShowLiveSiteUrlBox").then(function(hasFlag){hasFlag&&(_this.show=!0,_this.hasBeenShown=!0,_this.CustomerFlagsService["delete"]("V4ShowLiveSiteUrlBox"))})},PreviewSiteUrlPopupController.prototype.gotIt=function(){this.show=!1},PreviewSiteUrlPopupController.$inject=["$scope","User","CustomerFlagsService","HomeComponentService"],PreviewSiteUrlPopupController}();Directives.PreviewSiteUrlPopupController=PreviewSiteUrlPopupController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").component("ssPreviewSiteUrlPopup",Common.Directives.previewSiteUrlPopup());var Common;!function(Common){var Directives;!function(Directives){function signaturesection($compile){return{scope:{section:"="},controller:Common.Directives.SignaturesectionController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/signaturesection/signaturesection.html",restrict:"E",transclude:!0}}Directives.signaturesection=signaturesection;var SignaturesectionController=function(_super){function SignaturesectionController($scope,Pages,ActiveSection,HomeComponentService,HomePreviewComponentService,Sections,$injector,$rootScope,$q,$translate){var _this=this;_super.call(this,$scope,Pages,ActiveSection,Sections,HomeComponentService,$injector),this.$scope=$scope,this.Pages=Pages,this.ActiveSection=ActiveSection,this.HomeComponentService=HomeComponentService,this.HomePreviewComponentService=HomePreviewComponentService,this.Sections=Sections,this.$injector=$injector,this.$rootScope=$rootScope,this.$q=$q,this.$translate=$translate,this.regardsTextLimit=60,this.signatureTextLimit=35,this.handleSelectedFontChanged=function(){_this.selectFont(_this.font)},this.regardsTextChanged=function(){_this.regardsLimitReached=_this.section.regardsText.length>=_this.regardsTextLimit},this.signatureTextChanged=function(){_this.signatureLimitReached=_this.section.signatureText.length>=_this.signatureTextLimit},this.selectFont=function(font){_this.font=font,_this.section.signatureFontType=font.id},this.saveAndDeactivate=function($event){$event.stopPropagation(),_this.isSectionEmpty(_this.section)?_this.HomePreviewComponentService.openDeleteModal(_this.section,!0):_this.saveSection().then(function(section){_this.deactivate(section)})},this.saveSection=function(showNotification){void 0===showNotification&&(showNotification=!0);var deferred=_this.$q.defer();return _this.trimTooLongTexsts().then(function(){_this.preSaveSectionImage().then(function(){_this.addOrUpdateSection(!0,showNotification).then(function(response){var section=response.data;deferred.resolve(section)},function(err){deferred.reject(err)})},function(err){deferred.reject(err)})},function(err){deferred.reject(err)}),deferred.promise},this.trimTooLongTexsts=function(){var deferred=_this.$q.defer();return _this.section.regardsText=_this.trimText(_this.section.regardsText,_this.regardsTextLimit),_this.section.signatureText=_this.trimText(_this.section.signatureText,_this.signatureTextLimit),deferred.resolve(!0),deferred.promise},this.buildFontList(),this.font=this.lodash.find(this.fonts,function(f){return f.id==_this.section.signatureFontType}),null!==this.section.initSection&&this.section.initSection===!0&&this.$translate("HOME.PREVIEW.SIGNATURE_SECTION.REGARDS_TEXT_PLACEHOLDER").then(function(regards){_this.$translate("HOME.PREVIEW.SIGNATURE_SECTION.SIGNATURE_TEXT_PLACEHOLDER").then(function(signature){_this.section.regardsText=regards,_this.section.signatureText=signature,_this.saveSection(!1),_this.section.initSection=null,_this.updateOriginalSection()})})}return __extends(SignaturesectionController,_super),SignaturesectionController.prototype.isSectionEmpty=function(mSection){var isSectionEmpty=!1;return null!=mSection.signatureText&&""!=mSection.signatureText||null!=mSection.regardsText&&""!=mSection.regardsText||null!=mSection.image.url&&""!=mSection.image.url||(isSectionEmpty=!0),isSectionEmpty},SignaturesectionController.prototype.buildFontList=function(){this.fonts=[{id:"DancingScript",display:"Dancing Script",family:"'Dancing Script', cursive;"},{id:"Montez",display:"Montez",family:"'Montez', cursive"},{id:"Pacifico",display:"Pacifico",family:"'Pacifico', cursive;"},{id:"Unkempt",display:"Unkempt",family:"'Unkempt', cursive"}]},SignaturesectionController.prototype.onRegardsKeypress=function(event){this.regardsLimitReached&&event.preventDefault()},SignaturesectionController.prototype.onSignatureKeypress=function(event){this.signatureLimitReached&&event.preventDefault()},SignaturesectionController.prototype.preSaveSectionImage=function(){var def=this.$q.defer(),sec=this.section;if(sec&&sec.image&&sec.image.blob){var uploadPromise=this.SectionImagesApi.upload(this.Pages.currentPage.pageType,this.Pages.currentPage.pageId,this.section.type,this.section.sectionId,sec.image,sec.image.blob);uploadPromise.then(function(response){sec.image.url=response.url,sec.image.id=response.id,def.resolve()})}else def.resolve();return def.promise},SignaturesectionController.prototype.trimText=function(text,limit){return text.length>=limit?text.substring(0,limit):text},SignaturesectionController.$inject=["$scope","Pages","ActiveSection","HomeComponentService","HomePreviewComponentService","Sections","$injector","$rootScope","$q","$translate"],SignaturesectionController}(Directives.SectionController);Directives.SignaturesectionController=SignaturesectionController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("signaturesection",Common.Directives.signaturesection);var Common;!function(Common){var Directives;!function(Directives){function sitesubtitle(){return{scope:{sitesubtitle:"="},controller:Common.Directives.SiteSubtitleController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/sitesubtitle/sitesubtitle_contenteditable.html",restrict:"E",transclude:!0}}Directives.sitesubtitle=sitesubtitle;var SiteSubtitleController=function(){function SiteSubtitleController($scope,element,Site,HomeComponentService,lodash,$rootScope){var _this=this;this.$scope=$scope,this.element=element,this.Site=Site,this.HomeComponentService=HomeComponentService,this.lodash=lodash,this.$rootScope=$rootScope,this.saveFast=function(subtitle){_this.Site.update({subtitle:subtitle})},this.cancel=function(){_this.Site.get().then(function(data){_this.sitesubtitle=data.subtitle})},angular.element(element).on("keydown",function(event){13===event.keyCode?event.preventDefault():27===event.keyCode&&(_this.cancel(),event.preventDefault())}),this.save=this.lodash.debounce(function(subtitle){return _this.saveFast(subtitle)},1e3)}return SiteSubtitleController.$inject=["$scope","$element","Site","HomeComponentService","lodash","$rootScope"],SiteSubtitleController}();Directives.SiteSubtitleController=SiteSubtitleController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("sitesubtitle",Common.Directives.sitesubtitle);var Common;!function(Common){var Directives;!function(Directives){function sitetitle($compile){return{scope:{sitetitle:"="},controller:Common.Directives.SitetitleController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/sitetitle/sitetitle_contenteditable.html",restrict:"E",transclude:!0}}Directives.sitetitle=sitetitle;var SitetitleController=function(){function SitetitleController($scope,element,Site,HomeComponentService,lodash,$rootScope){var _this=this;this.$scope=$scope,this.element=element,this.Site=Site,this.HomeComponentService=HomeComponentService,this.lodash=lodash,this.$rootScope=$rootScope,this.saveFast=function(title){_this.Site.update({title:title})},this.cancel=function(){_this.Site.get().then(function(data){_this.sitetitle=data.title})},angular.element(element).on("keydown",function(event){13===event.keyCode?event.preventDefault():27===event.keyCode&&(_this.cancel(),event.preventDefault())}),this.save=this.lodash.debounce(function(title){return _this.saveFast(title)},1e3)}return SitetitleController.$inject=["$scope","$element","Site","HomeComponentService","lodash","$rootScope"],SitetitleController}();Directives.SitetitleController=SitetitleController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("sitetitle",Common.Directives.sitetitle);var Common;!function(Common){var Directives;!function(Directives){var Sitetitlev4editorModalController=function(){function Sitetitlev4editorModalController($scope,$compile,close,headersettings,EnvironmentService){this.$scope=$scope,this.$compile=$compile,this.close=close,this.headersettings=headersettings,this.EnvironmentService=EnvironmentService,this.shown=!0,this.EnvironmentService.isMobile?this.showDesktopLayouts=!1:this.showDesktopLayouts=!0}return Sitetitlev4editorModalController.prototype.closeModal=function(){this.shown=!1,this.close({},0)},Sitetitlev4editorModalController.prototype.done=function(){this.closeModal()},Sitetitlev4editorModalController.prototype.setHeaderLayout=function(layoutId){this.headersettings.setLayoutSetting(layoutId)},Sitetitlev4editorModalController.prototype.selectMobileLayout=function(layoutId){this.headersettings.setLayoutSetting(layoutId),this.shown=!1,this.close({},0)},Sitetitlev4editorModalController.$inject=["$scope","$compile","close","headersettings","EnvironmentService"],Sitetitlev4editorModalController}();Directives.Sitetitlev4editorModalController=Sitetitlev4editorModalController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("Sitetitlev4editorModalController",Common.Directives.Sitetitlev4editorModalController);var Common;!function(Common){var Directives;!function(Directives){function sitetitlev4editor($compile){return{scope:{showTetherBox:"="},controller:Common.Directives.Sitetitlev4editorController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/sitetitlev4editor/sitetitlev4editor.html",restrict:"E",transclude:!0}}Directives.sitetitlev4editor=sitetitlev4editor;var Sitetitlev4editorController=function(){function Sitetitlev4editorController($scope,$compile,$document,$element,Site,HomeComponentService,$rootScope,EnvironmentService,ActiveSection,lodash,$location,$anchorScroll,headersettings,ModalService,User,Pages,$window,UserEvents,MdNotificationService,$translate){var _this=this;this.$scope=$scope,this.$compile=$compile,this.$document=$document,this.$element=$element,this.Site=Site,this.HomeComponentService=HomeComponentService,this.$rootScope=$rootScope,this.EnvironmentService=EnvironmentService,this.ActiveSection=ActiveSection,this.lodash=lodash,this.$location=$location,this.$anchorScroll=$anchorScroll,this.headersettings=headersettings,this.ModalService=ModalService,this.User=User,this.Pages=Pages,this.$window=$window,this.UserEvents=UserEvents,this.MdNotificationService=MdNotificationService,this.$translate=$translate,this.useDraggable=!0,this.showTetherBox="",angular.element($element).on("keydown",function(event){13===event.keyCode?event.preventDefault():27===event.keyCode&&_this.cancel(event)}),this.originalSite=this.Site.current,this.titleId="title",this.siteedit=this.lodash.clone(this.Site.current)}return Sitetitlev4editorController.prototype.saveFast=function($event){var _this=this;return""==this.siteedit.title?void this.$translate("HOME.NOTIFICATIONS.ERROR_MESSAGE.EMPTY_TITLE").then(function(text){_this.MdNotificationService.showErrorToast(text)}):void("layout4"==this.Site.current.design?(this.showTetherBox="",$event.stopPropagation(),this.headersettings.storeCurrentSetting().then(function(){_this.headersettings.site.logo!==_this.Site.current.logo&&_this.UserEvents.send("V4LogoChanged"),_this.headersettings.updateOriginal();var delta={title:_this.siteedit.title,subtitle:_this.siteedit.subtitle,logo:_this.headersettings.site.logo};null==_this.headersettings.site.logoImage&&(delta.logoImageId=0),_this.Site.update(delta).then(function(_data){_this.deactivate(),angular.copy(_this.siteedit,_this.originalSite),_this.$translate("HOME.NOTIFICATIONS.SUCCESS_MESSAGE.SECTION_SAVED").then(function(text){_this.MdNotificationService.showSimpleToast(text)})})})):this.Site.update({title:this.siteedit.title,subtitle:this.siteedit.subtitle}).then(function(data){_this.deactivate(),angular.copy(_this.siteedit,_this.originalSite),_this.$translate("HOME.NOTIFICATIONS.SUCCESS_MESSAGE.SECTION_SAVED").then(function(text){_this.MdNotificationService.showSimpleToast(text)})}))},Sitetitlev4editorController.prototype.deactivate=function(){this.HomeComponentService.activeSection=null,this.ActiveSection.activeSectionId=null,this.HomeComponentService.editmode=!0},Sitetitlev4editorController.prototype.cancel=function($event){$event.stopPropagation(),this.siteedit=angular.copy(this.originalSite),"layout4"==this.Site.current.design&&this.headersettings.revertToOriginal(),this.deactivate()},Sitetitlev4editorController.prototype.isActive=function(){return this.ActiveSection.isActive(this.titleId)},Sitetitlev4editorController.prototype.activate=function(){if(this.HomeComponentService.editmode||this.HomeComponentService.activeSection)if(this.HomeComponentService.editmode=!1,this.HomeComponentService.sidebar="none",null==this.HomeComponentService.activeSection){if(this.isActive())return;this.HomeComponentService.activeSection=this.titleId,this.ActiveSection.activeSectionId=this.titleId,this.HomeComponentService.editmode&&angular.copy(this.siteedit,this.originalSite)}else if(this.HomeComponentService.activeSection!=this.titleId){var prefix=this.HomeComponentService.scrolltotop?"section_":"savecancel_";this.$location.hash(prefix+this.HomeComponentService.activeSection.sectionId),this.$anchorScroll()}},Sitetitlev4editorController.prototype.getLogos=function(event){},Sitetitlev4editorController.prototype.getFonts=function(event){this.EnvironmentService.isMobile||(this.HomeComponentService.sidebar="design-fontpacks-selected",event.stopPropagation())},Sitetitlev4editorController.prototype.openSettings=function(event){this.useDraggable?"layout4"==this.Site.current.design?this.showTetherBox="none":this.showTetherBox="logos":this.ModalService.showModal({templateUrl:"partials/sitetitlev4editor/sitetitlev4editor-modal.html",controller:"Sitetitlev4editorModalController",controllerAs:"vm"})},Sitetitlev4editorController.prototype.openSettingsLogos=function(event){(this.HomeComponentService.editmode||this.isActive())&&(this.showTetherBox="logos",this.EnvironmentService.isMobile&&this.ModalService.showModal({templateUrl:"partials/ss-title-settings/ss-title-settings-mobile.html",controller:"SSTitleSettingsMobileController",controllerAs:"vm",inputs:{showTetherBox:this.showTetherBox}}))},Sitetitlev4editorController.prototype.openSettingsMobile=function(event){"layout4"==this.Site.current.design?this.showTetherBox="none":this.showTetherBox="logos",this.ModalService.showModal({templateUrl:"partials/ss-title-settings/ss-title-settings-mobile.html",controller:"SSTitleSettingsMobileController",controllerAs:"vm",inputs:{showTetherBox:this.showTetherBox}})},Sitetitlev4editorController.prototype.openLayoutsMobile=function(event){this.ModalService.showModal({templateUrl:"partials/sitetitlev4editor/sitetitlev4editor-modal-layouts-mobile.html",controller:"Sitetitlev4editorModalController",controllerAs:"vm"})},Sitetitlev4editorController.$inject=["$scope","$compile","$document","$element","Site","HomeComponentService","$rootScope","EnvironmentService","ActiveSection","lodash","$location","$anchorScroll","headersettings","ModalService","User","Pages","$window","UserEvents","MdNotificationService","$translate"],Sitetitlev4editorController}();Directives.Sitetitlev4editorController=Sitetitlev4editorController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("sitetitlev4editor",Common.Directives.sitetitlev4editor);var Common;!function(Common){var Directives;!function(Directives){function slideshow(){return{scope:{section:"="},controller:Common.Directives.SlideshowController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/slideshowsection/slideshowsection.html",restrict:"E",transclude:!0}}var SlideshowController=function(_super){function SlideshowController($scope,Sections,$stateParams,ActiveSection,HomeComponentService,HomePreviewComponentService,Pages,SectionImagesApi,SectionsApi,screenSize,$injector,PagesMapper,EnvironmentService,MdNotificationService,$q,$translate){var _this=this;_super.call(this,$scope,Pages,ActiveSection,Sections,HomeComponentService,$injector),this.$scope=$scope,this.Sections=Sections,this.$stateParams=$stateParams,this.ActiveSection=ActiveSection,this.HomeComponentService=HomeComponentService,this.HomePreviewComponentService=HomePreviewComponentService,this.Pages=Pages,this.SectionImagesApi=SectionImagesApi,this.SectionsApi=SectionsApi,this.screenSize=screenSize,this.$injector=$injector,this.PagesMapper=PagesMapper,this.EnvironmentService=EnvironmentService,this.MdNotificationService=MdNotificationService,this.$q=$q,this.$translate=$translate,this.pages=[],this.editimage=!1,this.slideshowMaxlength=5,this.slideshowImages=[],this.offlineBlobs=[null,null,null,null,null],this.transitions=[{value:"Fade",name:"Fade"},{value:"Cubic",name:"Cubic"},{value:"Stripe",name:"Stripe"},{value:"Slide",name:"Slide"},{value:"UpDown",name:"Up/Down"},{value:"Random",name:"Random"}],this.uploadBlobs=function(){var deferred=_this.$q.defer(),blobsToUpload=_this.lodash.filter(_this.offlineBlobs,function(item){return null!==item});return blobsToUpload.length>0?_this.SectionImagesApi.uploadBlobs("standard",_this.$stateParams.pageId,"slideshow",_this.section.sectionId,blobsToUpload).then(function(data){_this.section.images.forEach(function(sectionImage){0==sectionImage.image.id&&(sectionImage.image.id=data[0],data.splice(0,1))}),deferred.resolve()},function(err){deferred.reject()}):deferred.resolve(),_this.offlineBlobs=[null,null,null,null,null],deferred.promise},this.reconvertLinksForClient=function(){var deferred=_this.$q.defer();return _this.convertLinksFromV3ToV4(_this.section.images),deferred.resolve(),deferred.promise},this.cancel=function($event){$event.stopPropagation();var isOriginalEmpty=_this.isSectionEmpty(_this.originalSection);isOriginalEmpty?_this.HomePreviewComponentService.openDeleteModal(_this.section,!0):(_this.section=angular.copy(_this.originalSection),_this.deactivate(_this.section),_this.offlineBlobs=[null,null,null,null,null],_this.updateSlideshowImages())},this.saveAndDeactivate=function($event){$event.stopPropagation(),_this.isSectionEmpty(_this.section)?_this.HomePreviewComponentService.openDeleteModal(_this.section,!0):(_this.$translate("HOME.NOTIFICATIONS.SPINNER_MESSAGE.SECTION_SAVING").then(function(text){_this.MdNotificationService.showSpinnerToast(text)}),_this.uploadBlobs().then(function(){_this.addOrUpdateSection(!0).then(function(){_this.reconvertLinksForClient().then(function(){_this.deactivate(_this.section)})})}))},this.addSlides=function(blobArray){return blobArray.length+_this.slideshowImages.length>_this.slideshowMaxlength?void(_this.limitMsg=!0):void blobArray.forEach(function(element,index){var indexInSectionImages=_this.slideshowImages.length;_this.offlineBlobs[indexInSectionImages]=element;var urlCreator=window.URL||window.webkitURL,filesrc=urlCreator.createObjectURL(element);_this.section.images[indexInSectionImages].image.url=filesrc,_this.section.images[indexInSectionImages].image.id=0,_this.slideshowImages.push(_this.section.images[indexInSectionImages]),_this.selectSlide()})},this.removeSlide=function(slideIndex){_this.section.images[slideIndex].image.url="",_this.section.images[slideIndex].image.id=0,_this.section.images[slideIndex].title="",_this.section.images[slideIndex].text="",_this.section.images[slideIndex].link=null,_this.reorderSectionImages()},this.reorderSectionImages=function(){for(var i=_this.section.images.length-1;i>=0;i--){var sectionImage=_this.section.images[i];if(""==sectionImage.image.url){var splicedElem=_this.section.images.splice(i,1)[0];_this.section.images.push(splicedElem),_this.offlineBlobs.splice(i,1),_this.offlineBlobs.push(null)}}_this.updateSlideshowImages(),_this.selectSlide()},this.convertSectionImageLinkPageIdsToStrings(),this.convertLinksFromV3ToV4(this.section.images),this.pages=Pages.list,this.imageId=1,this.file=[],this.uploadingImgs=[],this.limitMsg=!1,this.fitstyle="cover",this.currentIndexSlide=0,this.isMobile=this.screenSize.is("xs, sm"),this.updateSlideshowImages()}return __extends(SlideshowController,_super),SlideshowController.prototype.onEmptyHover=function(image){""===image.image.url&&angular.element(".image_list__element_v2 .thumb-image").addClass("thumb-image-empty-hovered")},SlideshowController.prototype.onEmptyHoverOut=function(image){""===image.image.url&&angular.element(".image_list__element_v2 .thumb-image").removeClass("thumb-image-empty-hovered")},SlideshowController.prototype.isSectionEmpty=function(mSection){var isSectionEmpty=!1;return null!=mSection.images[0].image.url&&""!=mSection.images[0].image.url||(isSectionEmpty=!0),isSectionEmpty},SlideshowController.prototype.firstEmptySectionImage=function(){return this.lodash.findIndex(this.section.images,function(o){return""==o.image.url})},SlideshowController.prototype.updateSlideshowImages=function(){var nonEmptyImages=this.lodash.filter(this.section.images,function(o){return""!==o.image.url});this.slideshowImages=this.lodash.map(nonEmptyImages,function(i){return{url:i.image.url,captionTitle:i.title,caption:i.text,link:i.link}})},SlideshowController.prototype.convertSectionImageLinkPageIdsToStrings=function(){this.lodash.each(this.section.images,function(image){image.link&&image.link.pageId&&(image.link.pageId=image.link.pageId.toString())})},SlideshowController.prototype.convertLinksFromV3ToV4=function(images){this.lodash.each(images,function(image){var isWebshopLink=image.link&&image.link.pageId&&image.link.pageItemId>0;isWebshopLink&&(image.link.pageId=image.link.pageId.toString()+"_"+image.link.pageItemId,image.link.pageItemId=0)})},SlideshowController.prototype.convertLinksFromV4ToV3=function(images){this.lodash.each(images,function(image){var isWebshopLink=image.link.pageId.indexOf("_")>0;if(isWebshopLink){var ids=image.link.pageId.split("_");image.link.pageId=ids[0],image.link.pageItemId=ids[1]}})},SlideshowController.prototype.saveSlide=function(slideIndex){var _this=this;void 0===slideIndex&&(slideIndex=this.currentIndexSlide);var slide=this.section.images[slideIndex];slide.type=this.section.type.toLowerCase(),slide.link&&slide.link.pageId?this.convertLinksFromV4ToV3([slide]):slide.link=null,this.Sections.updateItem(this.Pages.currentPage.pageType,this.$stateParams.pageId,this.section.type,this.section.sectionId,slideIndex,slide).success(function(){_this.convertLinksFromV3ToV4([slide])}),this.updateSlideshowImages()},SlideshowController.prototype.saveSlidesAndDeactive_v2=function($event){var _this=this;angular.forEach(this.section.images,function(image,key){var slide=image;slide.type=_this.section.type.toLowerCase(),slide.link&&slide.link.pageId?_this.convertLinksFromV4ToV3([slide]):slide.link=null,_this.Sections.updateItem(_this.Pages.currentPage.pageType,_this.$stateParams.pageId,_this.section.type,_this.section.sectionId,key,slide)}),this.updateSlideshowImages(),this.saveAndDeactivate($event)},SlideshowController.prototype.updateSlide=function(blob){var urlCreator=window.URL||window.webkitURL;this.section.images[this.currentIndexSlide].image.url=urlCreator.createObjectURL(blob),this.section.images[this.currentIndexSlide].image.id=0,this.offlineBlobs[this.currentIndexSlide]=blob,this.updateSlideshowImages,this.editimage=!1},SlideshowController.prototype.uploadNewSlides=function(section,blobArray){if(blobArray)return blobArray.length+this.slideshowImages.length>this.slideshowMaxlength?void(this.limitMsg=!0):void this.addSlides(blobArray)},SlideshowController.prototype.selectSlide=function(index){if(void 0===index&&(index=this.currentIndexSlide),this.editimage)return this.limitMsg=!1,void(this.editModeMsg=!0);var choosable=0<=index&&index<this.slideshowImages.length;if(choosable&&(this.currentIndexSlide=choosable?index:this.currentIndexSlide,this.currentIndexSlide=index<this.slideshowImages.length?this.currentIndexSlide:this.slideshowImages.length-1,this.section.images[this.currentIndexSlide]?(this.image=this.section.images[this.currentIndexSlide].image,this.imageId=this.section.images[this.currentIndexSlide].image.id):(this.image=null,this.imageId=null)),
this.editModeMsg=!1,choosable&&$(".image_list__element_v2").length>0){var elemWidth=$(".image_list__element_v2").width(),elemMargin=+$(".image_list__element_v2").css("marginRight").replace(/[^-\d\.]/g,"");$(".thumbnail_v2 .grid-content").animate({scrollLeft:(elemWidth+elemMargin)*(this.currentIndexSlide-1)})}},SlideshowController.prototype.nextSlide=function(){this.selectSlide((this.currentIndexSlide+this.slideshowImages.length+1)%this.slideshowImages.length)},SlideshowController.prototype.prevSlide=function(){this.selectSlide((this.currentIndexSlide+this.slideshowImages.length-1)%this.slideshowImages.length)},SlideshowController.prototype.deleteSlide=function(slideIndex){void 0===slideIndex&&(slideIndex=this.currentIndexSlide),this.removeSlide(slideIndex)},SlideshowController.prototype.activateSectionAndSetHeight=function(){this.isActive()||(this.selectSlide(),this.activate())},SlideshowController.$inject=["$scope","Sections","$stateParams","ActiveSection","HomeComponentService","HomePreviewComponentService","Pages","SectionImagesApi","SectionsApi","screenSize","$injector","PagesMapper","EnvironmentService","MdNotificationService","$q","$translate"],SlideshowController}(Directives.SectionController);Directives.SlideshowController=SlideshowController,Directives.slideshow=slideshow}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("slideshow",Common.Directives.slideshow);var Common;!function(Common){var Directives;!function(Directives){function sortSectionsControls(){return{bindings:{sectionIndex:"<",sections:"<",sortingcontrols:"<",section:"<"},controller:Common.Directives.SortSectionsControlsController,controllerAs:"vm",templateUrl:"partials/sortSectionsControls/sortSectionsControls.html"}}Directives.sortSectionsControls=sortSectionsControls;var SortSectionsControlsController=function(){function SortSectionsControlsController($scope,Sections,Pages,HomeComponentService,$document,UserEvents,EnvironmentService){this.$scope=$scope,this.Sections=Sections,this.Pages=Pages,this.HomeComponentService=HomeComponentService,this.$document=$document,this.UserEvents=UserEvents,this.EnvironmentService=EnvironmentService}return SortSectionsControlsController.prototype.swapArrayElements=function(arr,indexA,indexB){var temp=arr[indexA];arr[indexA]=arr[indexB],arr[indexB]=temp},SortSectionsControlsController.prototype.sortSection=function(event,sectionType,sectionId,currentIndex,newIndex){var _this=this;return event.stopImmediatePropagation(),this.UserEvents.send("V4ReorderSectionsClicked"),this.Sections.sort(this.Pages.currentPage.pageType,this.Pages.currentPage.pageId,sectionType,sectionId,newIndex).then(function(){_this.swapArrayElements(_this.sections,currentIndex,newIndex),_this.sortingcontrols=_this.sortingcontrols.map(function(v){return v=!1}),_this.sortingcontrols[newIndex]=!0,_this.$document.duScrollToElement(document.getElementById("section"+newIndex),60,300)}),!1},SortSectionsControlsController.$inject=["$scope","Sections","Pages","HomeComponentService","$document","UserEvents","EnvironmentService"],SortSectionsControlsController}();Directives.SortSectionsControlsController=SortSectionsControlsController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").component("sortSectionsControls",Common.Directives.sortSectionsControls());var Common;!function(Common){var Directives;!function(Directives){function ssApplyCancel($compile){return{scope:{apply:"&",cancel:"&"},controller:Common.Directives.ssApplyCancelController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/ss-applycancel/ss-applycancel.html",restrict:"E",transclude:!0}}Directives.ssApplyCancel=ssApplyCancel;var ssApplyCancelController=function(){function ssApplyCancelController($scope,EnvironmentService){this.$scope=$scope,this.EnvironmentService=EnvironmentService}return ssApplyCancelController.prototype.onapply=function($event){this.apply&&this.apply({$event:$event})},ssApplyCancelController.prototype.oncancel=function($event){this.cancel&&this.cancel({$event:$event})},ssApplyCancelController.$inject=["$scope","EnvironmentService"],ssApplyCancelController}();Directives.ssApplyCancelController=ssApplyCancelController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("ssApplyCancel",Common.Directives.ssApplyCancel);var Common;!function(Common){var Directives;!function(Directives){function ssDatepicker($templateCache,$compile,$document,datesCalculator){return{restrict:"A",require:"ngModel",scope:{config:"=datepickerConfig"},templateUrl:"partials/ss-datepicker/ss-datepicker.html",link:function(scope,element,attrs,ngModel){function init(){angular.isDefined(ngModel.$modelValue)&&moment.isDate(ngModel.$modelValue)&&(scope.calendarCursor=ngModel.$modelValue),setTimeout(function(){ngModel.$setViewValue(new Date(ngModel.$viewValue.toString()));var start=moment(),date=moment().toDate();""!==ngModel.$viewValue?(start=moment(ngModel.$viewValue),date=moment(ngModel.$viewValue,defaultConfig.dateFormat,moment.locale()).toDate()):(start=moment(),date=moment().toDate());var firstDayOfMonth=start.date(1),day={date:date,isToday:start.isSame(today,"day"),isInMonth:start.isSame(firstDayOfMonth,"month"),isSelected:start.isSame(dateSelected,"day"),isSelectable:afterMinDate&&beforeMaxDate&&beforeFuture},afterMinDate=!scope.config.minDate||start.isAfter(scope.config.minDate,"day"),beforeMaxDate=!scope.config.maxDate||start.isBefore(scope.config.maxDate,"day"),isFuture=start.isAfter(today),beforeFuture=scope.config.allowFuture||!isFuture;scope.saveDay(day)},0)}function onDocumentClick(e){scope.reselectAndHide()}function getWeeks(date){var weeks=[];date=moment.utc(date);var firstDayOfMonth=moment(date).date(1),lastDayOfMonth=moment(date).date(date.daysInMonth()),startDay=moment(firstDayOfMonth),endDay=moment(lastDayOfMonth);startDay=0===firstDayOfMonth.weekday()?startDay:startDay.weekday(0),endDay=6===lastDayOfMonth.weekday()?endDay:endDay.weekday(6);for(var currentWeek=[],start=moment(startDay);start.isBefore(moment(endDay).add(1,"days"));start.add(1,"days")){var afterMinDate=!scope.config.minDate||start.isAfter(scope.config.minDate,"day"),beforeMaxDate=!scope.config.maxDate||start.isBefore(scope.config.maxDate,"day"),isFuture=start.isAfter(today),beforeFuture=scope.config.allowFuture||!isFuture,day={date:moment(start).toDate(),isToday:start.isSame(today,"day"),isInMonth:start.isSame(firstDayOfMonth,"month"),isSelected:start.isSame(dateSelected,"day"),isSelectable:afterMinDate&&beforeMaxDate&&beforeFuture};currentWeek.push(day),6!==start.weekday()&&start!==endDay||(weeks.push(currentWeek),currentWeek=[])}return weeks}function resetSelectedDays(){scope.currentWeeks.forEach(function(week,wIndex){week.forEach(function(day,dIndex){scope.currentWeeks[wIndex][dIndex].isSelected=!1})})}var selectedDay,lastSavedDay,dateSelected=moment.utc(),today=moment.utc(),defaultConfig={allowFuture:!0,dateFormat:"LL",minDate:null,maxDate:null};scope.config=angular.extend(defaultConfig,scope.config),angular.isDefined(scope.config.minDate)&&moment.utc(scope.config.minDate).subtract(1,"day"),angular.isDefined(scope.config.maxDate)&&moment.utc(scope.config.maxDate).add(1,"day"),scope.calendarCursor=today,scope.currentWeeks=[],scope.daysNameList=datesCalculator.getDaysNames(),scope.monthsList=moment.months(),scope.yearsList=datesCalculator.getYearsList(),scope.currentDate,scope.today=moment().format("LL"),scope.pickerDisplayed=!1,init(),scope.$watch(function(){return ngModel.$modelValue},function(value){value&&(dateSelected=scope.calendarCursor=moment.utc(value,scope.config.dateFormat),scope.currentDate=dateSelected)}),scope.$watch("calendarCursor",function(val){scope.currentWeeks=getWeeks(val)}),element.bind("click",function(e){scope.$apply(function(){$document.on("click",onDocumentClick)})}),scope.prevMonth=function(){scope.calendarCursor=moment(scope.calendarCursor).subtract(1,"months")},scope.nextMonth=function(){scope.calendarCursor=moment(scope.calendarCursor).add(1,"months")},scope.selectDay=function(day){(!day.isFuture||scope.config.allowFuture&&day.isFuture)&&(resetSelectedDays(),day.isSelected=!0,selectedDay=day,ngModel.$setViewValue(new Date(day.date)),ngModel.$render(),scope.setDateAndHide())},scope.setDateAndHide=function(){selectedDay&&(ngModel.$setViewValue(new Date(selectedDay.date)),ngModel.$ModelValue=new Date(selectedDay.date),scope.saveDay(selectedDay)),scope.pickerDisplayed=!1},scope.reselectAndHide=function(){resetSelectedDays(),scope.calendarCursor=moment(scope.calendarCursor).add(1,"months").subtract(1,"months"),ngModel.$setViewValue(new Date(lastSavedDay.date)),scope.pickerDisplayed=!1},scope.saveDay=function(day){lastSavedDay=day}}}}Directives.ssDatepicker=ssDatepicker}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("ssDatepicker",Common.Directives.ssDatepicker);var Common;!function(Common){var Directives;!function(Directives){function goback($window){return{restrict:"A",priority:1,link:function(scope,element,attrs){element.click(function(e){$window.history.back()})}}}Directives.goback=goback}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("goback",Common.Directives.goback);var Common;!function(Common){var Directives;!function(Directives){var ssHintDialogController=function(){function ssHintDialogController($scope,User,$window,close,EnvironmentService,HomeComponentService,HintService,UserEvents){var _this=this;this.$scope=$scope,this.User=User,this.$window=$window,this.close=close,this.EnvironmentService=EnvironmentService,this.HomeComponentService=HomeComponentService,this.HintService=HintService,this.UserEvents=UserEvents,this.customDomain="",this.addressChoice="",this.closeModal=function(){_this.UserEvents.send("V4BeaconStartHideBeacons"),_this.HintService.skipTour(),_this.shown=!1},this.shown=!0,this.username=this.User.user.url}return ssHintDialogController.prototype.finishTour=function(){this.shown=!1},ssHintDialogController.prototype.lastTour=function(){return""==this.HintService.nextTour},ssHintDialogController.prototype.nextTour=function(){this.HintService.startNextTour()},ssHintDialogController.prototype.startTour=function(){this.UserEvents.send("V4BeaconStartIGotIt"),this.shown=!1},ssHintDialogController.$inject=["$scope","User","$window","close","EnvironmentService","HomeComponentService","HintService","UserEvents"],ssHintDialogController}();Directives.ssHintDialogController=ssHintDialogController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("ssHintDialogController",Common.Directives.ssHintDialogController);var Common;!function(Common){var Directives;!function(Directives){var ssHintTooltipController=function(){function ssHintTooltipController($scope,HintService,$mdToast,$mdPanel,mdPanelRef,hint,visible,UserEvents){this.$scope=$scope,this.HintService=HintService,this.$mdToast=$mdToast,this.$mdPanel=$mdPanel,this.mdPanelRef=mdPanelRef,this.hint=hint,this.visible=visible,this.UserEvents=UserEvents,this.hint=hint,this.visible=visible,this.HintService.activateHint(this.hint.id),this.HintService.setPanel(this.mdPanelRef)}return ssHintTooltipController.prototype.closeHint=function(){this.HintService.closeHint(),this.HintService.activeHint=null},ssHintTooltipController.prototype.skipTour=function(){this.UserEvents.send("V4DisabledBeaconTour"),this.HintService.skipTour(),this.mdPanelRef.close()},ssHintTooltipController.$inject=["$scope","HintService","$mdToast","$mdPanel","mdPanelRef","hint","visible","UserEvents"],ssHintTooltipController}();Directives.ssHintTooltipController=ssHintTooltipController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("ssHintTooltipController",Common.Directives.ssHintTooltipController);var Common;!function(Common){var Services;!function(Services){"use strict";var HintService=function(){function HintService(Experiments,lodash,ModalService,UserEvents){this.Experiments=Experiments,this.lodash=lodash,this.ModalService=ModalService,this.UserEvents=UserEvents,this.activeTour="",this.nextTour=""}return HintService.prototype.setHints=function(hintsId){"AddContentTour"==hintsId?this.hints=[{id:"AddContentHint1",beaconNumber:"1",direction:"top center",header:"HOME.BEACONS.ADD_CONTENT_TOUR.HINT_1_HEADER",text:"HOME.BEACONS.ADD_CONTENT_TOUR.HINT_1_TEXT",target:".add-button:visible",trigger:"targetVisible",blocker:".modal:visible, fullscreen-container *",delay:500,previousHint:"",zIndex:500,nextHint:"",isActive:!0,chainName:"welcome"},{id:"AddContentHint2",beaconNumber:"2",direction:"top center",header:"HOME.BEACONS.ADD_CONTENT_TOUR.HINT_2_HEADER",text:"HOME.BEACONS.ADD_CONTENT_TOUR.HINT_2_TEXT",target:".svg-section-types--textnoimage-dims:visible",trigger:"targetVisible",blocker:".modal:visible, fullscreen-container *",delay:500,zIndex:2e4,previousHint:"",isActive:!0,nextHint:"",chainName:"welcome"},{id:"AddContentHint3",direction:"top center",beaconNumber:"3",header:"HOME.BEACONS.ADD_CONTENT_TOUR.HINT_3_HEADER",text:"HOME.BEACONS.ADD_CONTENT_TOUR.HINT_3_TEXT",target:".save-button:visible",trigger:"targetVisible",blocker:".modal:visible, fullscreen-container *",delay:500,previousHint:"",zIndex:500,isActive:!0,nextHint:"",chainName:"welcome"}]:"PreviewTour"==hintsId&&(this.hints=[{id:"PreviewHint1",beaconNumber:"1",direction:"top center",header:"HOME.BEACONS.PREVIEW_TOUR.HINT_1_HEADER",text:"HOME.BEACONS.PREVIEW_TOUR.HINT_1_TEXT",target:".add-button:visible",trigger:"targetVisible",blocker:".modal:visible, fullscreen-container *",delay:2e4,previousHint:"",zIndex:500,nextHint:"",isActive:!0,chainName:"welcome"},{id:"PreviewHint2",beaconNumber:"2",direction:"top center",header:"HOME.BEACONS.PREVIEW_TOUR.HINT_2_HEADER",text:"HOME.BEACONS.PREVIEW_TOUR.HINT_2_TEXT",target:".svg-section-types--textnoimage-dims:visible",trigger:"targetVisible",blocker:".modal:visible, fullscreen-container *",delay:500,previousHint:"",zIndex:500,nextHint:"PreviewHint3",isActive:!0,chainName:"welcome"},{id:"PreviewHintMobile2",direction:"Continue Editing",beaconNumber:"2",header:"HOME.BEACONS.PREVIEW_TOUR.HINT_3_HEADER",text:"HOME.BEACONS.PREVIEW_TOUR.HINT_3_TEXT",target:".save-button:visible",trigger:"targetVisible",blocker:".modal:visible, fullscreen-container *",delay:500,previousHint:"",zIndex:500,nextHint:"",isActive:!0,chainName:"welcome"},{id:"PreviewHint3",direction:"Continue Editing",beaconNumber:"3",header:"HOME.BEACONS.PREVIEW_TOUR.HINT_3_HEADER",text:"HOME.BEACONS.PREVIEW_TOUR.HINT_3_TEXT",target:".save-button:visible",trigger:"targetVisible",blocker:".modal:visible, fullscreen-container *",delay:500,previousHint:"",zIndex:2e4,nextHint:"",isActive:!1,chainName:"welcome"}])},HintService.prototype.closeHint=function(){this.panel.close()},HintService.prototype.activateHint=function(hintId){this.UserEvents.send("V4ActivatedAnyBeacon"),this.activeHint=hintId},HintService.prototype.deactiveStep=function(hintId){this.lodash.find(this.hints,{id:hintId}).isActive=!1;var nextHintId=this.lodash.find(this.hints,{id:hintId}).nextHint;this.lodash.find(this.hints,{id:nextHintId}).isActive=!0},HintService.prototype.isHintActive=function(hintId){var hint=this.lodash.find(this.hints,{id:hintId});return!!hint.isActive},HintService.prototype.isTourActive=function(tour){return this.activeTour===tour},HintService.prototype.endTour=function(nextTourId){this.UserEvents.send("V4CompletedBeaconTour"),this.activeTour="",this.nextTour=nextTourId,this.ModalService.showModal({templateUrl:"partials/ss-hint/ss-hint-dialog-end.html",controller:"ssHintDialogController",controllerAs:"vm"})},HintService.prototype.enableHint=function(id){this.activeTour=id,this.setHints(id)},HintService.prototype.setPanel=function(mdPanelRef){this.panel=mdPanelRef},HintService.prototype.skipTour=function(){this.activeTour=""},HintService.prototype.startNextTour=function(){this.startTour(this.nextTour)},HintService.prototype.startTour=function(tourId){""===this.activeTour&&(null!=this.panel&&(this.panel.close(),this.activeHint=""),this.UserEvents.send("V4SeenBeaconTour"),this.enableHint(tourId),"AddContentTour"===tourId&&this.ModalService.showModal({templateUrl:"partials/ss-hint/ss-hint-dialog-start.html",controller:"ssHintDialogController",controllerAs:"vm"}))},HintService.prototype.updateHints=function(item){for(var i=this.hints.length-1;i>=0;i--)if(this.hints[i].id===item){this.hints.splice(i,1);break}},HintService.$inject=["Experiments","lodash","ModalService","UserEvents"],HintService}();Services.HintService=HintService}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("HintService",Common.Services.HintService);var Common;!function(Common){var Directives;!function(Directives){function ssHint(){return{bindings:{hintid:"<",beaconnumber:"<",visible:"="},controller:Common.Directives.ssHintController,controllerAs:"vm",templateUrl:"partials/ss-hint/ss-hint.html"}}Directives.ssHint=ssHint;var ssHintController=function(){function ssHintController($scope,$timeout,$q,$interval,$document,$element,HintService,$window,lodash,CustomerFlagsService,HelpboxService,EnvironmentService,Pages,$mdPanel){var _this=this;this.$scope=$scope,this.$timeout=$timeout,this.$q=$q,this.$interval=$interval,this.$document=$document,this.$element=$element,this.HintService=HintService,this.$window=$window,this.lodash=lodash,this.CustomerFlagsService=CustomerFlagsService,this.HelpboxService=HelpboxService,this.EnvironmentService=EnvironmentService,this.Pages=Pages,this.$mdPanel=$mdPanel,this.arrowDirection="rightUp",this.queue=[],this.showHint=function($event){if(null!=this.HintService.activeHint&&this.hintid!=this.HintService.activeHint&&(this.HintService.activeHint=null,this.HintService.closeHint()),null!=this.HintService.activeHint&&this.hintid==this.HintService.activeHint)this.HintService.activeHint=null,this.HintService.closeHint();else{this.hints=this.HintService.hints,this.hint=this.lodash.find(this.hints,{id:this.hintid});var beaconClass=".beacon-hint_"+this.hintid,animation=this._mdPanel.newPanelAnimation(),position=this._mdPanel.newPanelPosition().relativeTo(beaconClass).addPanelPosition(this._mdPanel.xPosition.CENTER,this._mdPanel.yPosition.BELOW);animation.withAnimation({open:"demo-dialog-custom-animation-open",close:"demo-dialog-custom-animation-close"});var config={attachTo:angular.element(document.body),controller:Directives.ssHintTooltipController,controllerAs:"vm",templateUrl:"partials/ss-hint/ss-hint-tooltip.html",position:position,panelClass:"menu-panel-container",locals:{hint:this.hint,visible:this.visible},openFrom:$event,focusOnOpen:!1,zIndex:this.hint.zIndex,propagateContainerEvents:!0,groupName:["toolbar","menus"]};this._mdPanel.open(config),this._mdPanel,this.HintService.activeHint=this.hintid}},this._mdPanel=$mdPanel,HintService.hintDirective=this,this.$element.on("$destroy",function(){null!=_this.HintService.activeHint&&_this.hintid==_this.HintService.activeHint&&(_this.HintService.activeHint=null,_this.HintService.closeHint())})}return ssHintController.$inject=["$scope","$timeout","$q","$interval","$document","$element","HintService","$window","lodash","CustomerFlagsService","HelpboxService","EnvironmentService","Pages","$mdPanel"],ssHintController}();Directives.ssHintController=ssHintController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").component("ssHint",Common.Directives.ssHint());var Common;!function(Common){var Directives;!function(Directives){function ssImage(){return{scope:{editmode:"&",image:"=",onUpload:"&",onDelete:"&",editimage:"=?",minheight:"@?",maxheight:"@?",minwidth:"@?",maxwidth:"@?",initialwidth:"@?",hasCaption:"=?",hasPosition:"=?",fitstyle:"@?",section:"=",imageContainerId:"=?",showPreview:"<",active:"&"},controller:Common.Directives.ssImageController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/ss-image/ss-image.html",restrict:"E",replace:!0,transclude:!0}}Directives.ssImage=ssImage;var ssImageController=function(){function ssImageController($q,$scope,HomeComponentService,SectionImagesApi,Pages,Sections,$stateParams,UserEvents,lodash,$rootScope,EnvironmentService){this.$q=$q,this.$scope=$scope,this.HomeComponentService=HomeComponentService,this.SectionImagesApi=SectionImagesApi,this.Pages=Pages,this.Sections=Sections,this.$stateParams=$stateParams,this.UserEvents=UserEvents,this.lodash=lodash,this.$rootScope=$rootScope,this.EnvironmentService=EnvironmentService,this.uploading=!1,this.editimage=!1,null!==this.showPreview&&void 0!==this.showPreview||(this.showPreview=!0),(window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("Trident")>-1)&&$(".ssImageField").attr("style","height: 100%;")}return ssImageController.prototype.deleteImage=function(){this.onDelete({image:this.image}),this.image.url="",this.image.caption="",this.image.id=0,this.image.blob=null},ssImageController.prototype.uploadImage=function(blob){var _this=this,res=this.onUpload({blob:blob});if(!res||!res.then){var def=this.$q.defer();this.editimage=!1;var urlCreator=window.URL||window.webkitURL;return this.section.image.url&&urlCreator.revokeObjectURL(this.section.image.url),this.section.image.url=urlCreator.createObjectURL(blob),this.section.image.blob=blob,def.resolve(),def.promise}if(res&&res.then)return res.then(function(img){_this.editimage=!1}),res},ssImageController.prototype.saveCaption=function(){this.Sections.edit(this.Pages.currentPage.pageType,this.Pages.currentPage.pageId,this.section)},ssImageController.$inject=["$q","$scope","HomeComponentService","SectionImagesApi","Pages","Sections","$stateParams","UserEvents","lodash","$rootScope","EnvironmentService"],ssImageController}();Directives.ssImageController=ssImageController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("ssImage",Common.Directives.ssImage);var Common;!function(Common){var Directives;!function(Directives){function ssImageCaption(){return{bindings:{editmode:"<",image:"<",onCaptionChanged:"&"},controller:Common.Directives.ssImageControllerCaption,controllerAs:"vm",templateUrl:"partials/ss-image/ss-image__caption.html",restrict:"E",replace:!0}}Directives.ssImageCaption=ssImageCaption;var ssImageControllerCaption=function(){function ssImageControllerCaption(HomeComponentService){this.HomeComponentService=HomeComponentService}return ssImageControllerCaption.$inject=["HomeComponentService"],ssImageControllerCaption}();Directives.ssImageControllerCaption=ssImageControllerCaption}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").component("ssImageCaption",Common.Directives.ssImageCaption());var Common;!function(Common){var Directives;!function(Directives){function ssImageEditorCanvas(){return{bindings:{editimage:"=",image:"=",fitstyle:"<",minheight:"<",maxheight:"<",minwidth:"<",maxwidth:"<",initialwidth:"<",height:"="},controller:Common.Directives.ssImageEditorCanvasController,controllerAs:"vm",templateUrl:"partials/ss-image/ss-image__editor-canvas.html",restrict:"E",replace:!0}}Directives.ssImageEditorCanvas=ssImageEditorCanvas;var ssImageEditorCanvasController=function(){function ssImageEditorCanvasController($scope,EnvironmentService){var _this=this;this.$scope=$scope,this.EnvironmentService=EnvironmentService,$scope.$watch("vm.image.url",function(newValue,oldValue){newValue!==oldValue&&_this.objectfitFallback(!1)})}return ssImageEditorCanvasController.prototype.objectfitFallback=function(load){if("objectFit"in document.documentElement.style==!1){var imageElm=document.getElementById(this.image.imageContainerId);load&&(imageElm.parentElement.style.width=this.initialwidth),imageElm.className="objectfit-fallback-image",imageElm.style.backgroundSize=this.fitstyle,window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("Trident")>-1?angular.element(imageElm).parent().parent().parent().parent().css("min-height","1px"):(imageElm.style.backgroundImage="url("+this.image.url+")",imageElm.src="")}},ssImageEditorCanvasController.$inject=["$scope","EnvironmentService"],ssImageEditorCanvasController}();Directives.ssImageEditorCanvasController=ssImageEditorCanvasController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").component("ssImageEditorCanvas",Common.Directives.ssImageEditorCanvas());var Common;!function(Common){var Directives;!function(Directives){function ssImageEditorControls(){return{bindings:{uploading:"=",editimage:"=",imageId:"=",image:"=",onUpload:"&"},controller:Common.Directives.ssImageEditorControlsController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/ss-image/ss-image__editor-controls.html",restrict:"E",replace:!0}}Directives.ssImageEditorControls=ssImageEditorControls;var ssImageEditorControlsController=function(){function ssImageEditorControlsController($scope,HomeComponentService,$q){this.$scope=$scope,this.HomeComponentService=HomeComponentService,this.$q=$q,this.ImageRotation=0,this.MAX_IMAGE_SIZE=980,this.IMAGE_QUALITY=80,this.doneDisabled=!1}return ssImageEditorControlsController.prototype.getCropper=function(){var _this=this,def=this.$q.defer();if(!this.cropper&&this.image.imageContainerId){var imageHtml=document.getElementById(this.image.imageContainerId);this.cropper=new Cropper(imageHtml,{autoCrop:!1,viewMode:1,autoCropArea:1,built:function(){def.resolve(_this.cropper)},dragMode:"none",zoomOnTouch:!1,zoomOnWheel:!1,center:!1,background:!1,modal:!1,checkCrossOrigin:!0})}else def.resolve(this.cropper);return def.promise},ssImageEditorControlsController.prototype.toggle_cropper=function(){this.crop_state?(this.crop_state=!1,this.getCropper().then(function(cropobj){cropobj.clear(),cropobj.disable()})):(this.crop_state=!0,this.getCropper().then(function(cropobj){cropobj.enable(),cropobj.crop()}))},ssImageEditorControlsController.prototype.rotate=function(orientation){var _this=this;void 0===orientation&&(orientation="right"),"right"===orientation?this.ImageRotation+=90:this.ImageRotation-=90,this.ImageRotation=this.ImageRotation%360,this.ImageRotation=this.ImageRotation<0?this.ImageRotation+360:this.ImageRotation,this.getCropper().then(function(cropobj){var canvasData=cropobj.getCanvasData(),ratio=canvasData.naturalWidth/canvasData.naturalHeight;ratio<1&&(ratio=1),_this.crop_state?cropobj.rotateTo(_this.ImageRotation%360):cropobj.enable().rotateTo(_this.ImageRotation%360).scale(1/ratio,1/ratio).disable()})},ssImageEditorControlsController.prototype.crop=function(callback){var _this=this;this.getCropper().then(function(cropobj){var croppedCanvas=cropobj.getCroppedCanvas();if(croppedCanvas)croppedCanvas.toBlob(function(blob){callback(blob,0)},"image/jpeg",1);else{var imageHtml=document.getElementById(_this.image.imageContainerId);blobUtil.imgSrcToBlob(imageHtml.src,"Anonymous",1).then(function(blob){callback(blob,_this.ImageRotation)})}})},ssImageEditorControlsController.prototype.resizeAndSave=function(blob,rotation){var _this=this;if(void 0===rotation&&(rotation=0),!blob)throw Error("no blob for resize");canvasResize(blob,{width:this.MAX_IMAGE_SIZE,height:this.MAX_IMAGE_SIZE,crop:!1,quality:this.IMAGE_QUALITY,rotate:rotation,callback:function(data,_width,_height){blobUtil.imgSrcToBlob(data).then(function(blob){blob.name="name.jpg";var res=_this.onUpload({blob:blob});res&&res.then?res.then(function(){_this.doneComplete()}):_this.doneComplete()})}})},ssImageEditorControlsController.prototype.doneComplete=function(){var _this=this;this.ImageRotation=0,this.editimage=!1,this.uploading=!1,this.doneDisabled=!1,this.getCropper().then(function(cropobj){cropobj&&!cropobj.destroyed&&(cropobj.destroy(),cropobj.destroyed=!0),_this.cropper=null})},ssImageEditorControlsController.prototype.done=function(){var _this=this;this.doneDisabled||(this.doneDisabled=!0,this.uploading=!0,this.crop(function(blob,rotation){_this.resizeAndSave(blob,rotation)}))},ssImageEditorControlsController.$inject=["$scope","HomeComponentService","$q"],ssImageEditorControlsController}();Directives.ssImageEditorControlsController=ssImageEditorControlsController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").component("ssImageEditorControls",Common.Directives.ssImageEditorControls());var Common;!function(Common){var Directives;!function(Directives){function ssImageEditorMenu(){return{bindings:{hasPosition:"<",hasReorder:"<",editimage:"=",onDelete:"&",image:"="},controller:Common.Directives.ssImageEditorMenuController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/ss-image/ss-image__editor-menu.html",restrict:"E",replace:!0}}Directives.ssImageEditorMenu=ssImageEditorMenu;var ssImageEditorMenuController=function(){function ssImageEditorMenuController(EnvironmentService){this.EnvironmentService=EnvironmentService}return ssImageEditorMenuController.prototype.gotoEditImageMode=function(){(this.image.url||this.image.blob)&&(this.editimage=!0)},ssImageEditorMenuController.$inject=["EnvironmentService"],ssImageEditorMenuController}();Directives.ssImageEditorMenuController=ssImageEditorMenuController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").component("ssImageEditorMenu",Common.Directives.ssImageEditorMenu());var Common;!function(Common){var Directives;!function(Directives){function ssImageUploadButton(){return{bindings:{file:"&",onUpload:"&",section:"=",imageContainerId:"=?"},controller:Common.Directives.ssImageControllerUploadButton,controllerAs:"vm",bindToController:!0,templateUrl:"partials/ss-image/ss-image__upload-button.html",restrict:"E",replace:!0}}Directives.ssImageUploadButton=ssImageUploadButton;var ssImageControllerUploadButton=function(){function ssImageControllerUploadButton(ModalService,$scope,$stateParams,$document,HomeComponentService,$attrs,Pages,lodash,Experiments,HomePreviewComponentService,SectionImagesApi,$timeout){var _this=this;this.ModalService=ModalService,this.$scope=$scope,this.$stateParams=$stateParams,this.$document=$document,this.HomeComponentService=HomeComponentService,this.$attrs=$attrs,this.Pages=Pages,this.lodash=lodash,this.Experiments=Experiments,this.HomePreviewComponentService=HomePreviewComponentService,this.SectionImagesApi=SectionImagesApi,this.$timeout=$timeout,this.uploadProgress=0,this.hasLibrary=!0,this.HomePreviewComponentService.sectionIdJustAdded===this.section.sectionId&&this.HomePreviewComponentService.sectionIdInitialModal!==this.section.sectionId&&("Photo"===this.section.type||"Hero"===this.section.type||"Text"===this.section.type&&"Unknown"!==this.section.image.position)&&""===this.section.image.url&&(this.HomePreviewComponentService.sectionIdInitialModal=this.section.sectionId,this.showSelectImageModal()),this.save=this.lodash.debounce(function(){return _this.uploadAndSave()},1e3)}return ssImageControllerUploadButton.prototype.showSelectImageModal=function(){var _this=this;"Text"===this.section.type&&(this.section.image.position="Unknown"===this.section.image.position?"TopRight":this.section.image.position),this.HomeComponentService.activeSection=this.section,this.$timeout(function(){_this.Experiments.getTrack(Common.Services.ExperimentId.PHOTO_API_SEARCH).then(function(track){"V4PhotoAPISearch"===track?_this.ModalService.showModal({templateUrl:"partials/home.selectimagemodal.pixabay/selectimagemodalpixabay.html",controller:"SelectImageModalPixabayController",controllerAs:"vm"}).then(function(modal){modal.close.then(function(fl){fl&&(fl.file?_this.file=fl.file:_this.file=fl,
_this.file&&_this.uploadAndSave())})}):_this.ModalService.showModal({templateUrl:"partials/home.selectimagemodal/selectimagemodal.html",controller:"SelectImageModalController",controllerAs:"vm"}).then(function(modal){modal.close.then(function(fl){fl&&(fl.file?_this.file=fl.file:_this.file=fl,_this.file&&_this.uploadAndSave())})})})},0)},ssImageControllerUploadButton.prototype.hasImage=function(){var image,_this=this;if("Columns"===this.section.type){var castedSection=this.section,column=this.lodash.find(castedSection.columns,function(column){return column.image.imageContainerId==_this.imageContainerId});image=column?column.image:null}else image=this.section.image;return!(!image||!image.url)},ssImageControllerUploadButton.prototype.setActiveSection=function(){this.HomeComponentService.activeSection=this.section},ssImageControllerUploadButton.prototype.uploadAndSave=function(){var _this=this;if(this.file||this.section.image.url){if(!this.lodash.includes(this.file.type,"image"))return;var upload=this.onUpload({blob:this.file});upload&&upload.then?upload.then(function(data){_this.uploadProgress=0,_this.file=null},function(error){},function(uploadPercentage){_this.uploadProgress=uploadPercentage}):this.uploadImage(this.file)}},ssImageControllerUploadButton.prototype.uploadImage=function(blob){var urlCreator=window.URL||window.webkitURL;this.section.image.url&&urlCreator.revokeObjectURL(this.section.image.url),this.section.image.url=urlCreator.createObjectURL(blob),this.section.image.blob=blob},ssImageControllerUploadButton.$inject=["ModalService","$scope","$stateParams","$document","HomeComponentService","$attrs","Pages","lodash","Experiments","HomePreviewComponentService","SectionImagesApi","$timeout"],ssImageControllerUploadButton}();Directives.ssImageControllerUploadButton=ssImageControllerUploadButton}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").component("ssImageUploadButton",Common.Directives.ssImageUploadButton());var Common;!function(Common){var Directives;!function(Directives){var MdNotificationController=function(){function MdNotificationController($scope,$timeout,$mdToast,textcontent){this.$scope=$scope,this.$timeout=$timeout,this.$mdToast=$mdToast,this.textcontent=textcontent,this.textContent=textcontent}return MdNotificationController.$inject=["$scope","$timeout","$mdToast","textcontent"],MdNotificationController}();Directives.MdNotificationController=MdNotificationController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("MdNotificationController",Common.Directives.MdNotificationController);var Common;!function(Common){var Directives;!function(Directives){function ssModal($compile){return{scope:{modalId:"@",type:"@",xcancel:"@",ssTitle:"@",message:"@?",okText:"@?",okIcon:"@?",closeText:"@?",callToAction:"@?",cancelText:"@?",onOk:"&",onCancel:"&",promptPlaceholder:"@",answer:"=",closeService:"&",shown:"=",showClose:"@",closeActionOff:"="},controller:Common.Directives.SSModalController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/ss-modal/ss-modal.html",restrict:"E",transclude:!0}}Directives.ssModal=ssModal;var SSModalController=function(){function SSModalController($scope,$translate,HomeComponentService,$element,$q,$window){var _this=this;this.$scope=$scope,this.$translate=$translate,this.HomeComponentService=HomeComponentService,this.$element=$element,this.$q=$q,this.$window=$window,this.okText||this.$translate("HOME.OK").then(function(ok){_this.okText=ok}),this.closeText||this.$translate("HOME.CLOSE").then(function(close){_this.closeText=close}),this.cancelText||this.$translate("HOME.CANCEL").then(function(cancel){_this.cancelText=cancel}),$scope.$watch("vm.shown",function(){void 0!==_this.shown&&_this.animate(_this.shown).then(function(){document.querySelector("ss-modal aside").focus(),_this.shown&&"prompt"==_this.type&&document.getElementById("promptinput").focus()})}),$window.onkeydown=function(event){27===event.keyCode&&(_this.handleModalCancel(),event.preventDefault())}}return SSModalController.prototype.close=function(result){this.closeActionOff!==!0&&(this.shown=!1),this.closeService&&this.closeService(result&&"object"==typeof result?result:{},0)},SSModalController.prototype.animate=function(val){var def=this.$q.defer(),elem=this.$element.children().first(),dialog=elem.children().first();return val&&(dialog[0].tabIndex=-1,dialog[0].focus()),def.resolve(),def.promise},SSModalController.prototype.handleModalOk=function(){var _this=this;if(!this.working)if(this.working=!0,this.onOk){var promise=this.onOk();promise?promise.then(function(result){result&&_this.close(result),_this.working=!1}):(this.close(),this.working=!1)}else this.close(),this.working=!1},SSModalController.prototype.handleModalCancel=function(){this.working||(this.working=!0,this.close(),this.onCancel(),this.shown=!1,this.working=!1)},SSModalController.prototype.hideOverlay=function(){this.handleModalCancel()},SSModalController.$inject=["$scope","$translate","HomeComponentService","$element","$q","$window"],SSModalController}();Directives.SSModalController=SSModalController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("ssModal",Common.Directives.ssModal);var Common;!function(Common){var Directives;!function(Directives){function ssPagemenu($compile){return{scope:{displayType:"@",alignment:"@",expand:"="},controller:Common.Directives.ssPagemenuController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/ss-pagemenu/ss-pagemenu.html",restrict:"E",replace:!0}}Directives.ssPagemenu=ssPagemenu;var ssPagemenuController=function(){function ssPagemenuController($scope,Pages,EnvironmentService,lodash,ModalService,HomeComponentService,HelpboxService,ActiveSection,Site,$state,$timeout){var _this=this;this.$scope=$scope,this.Pages=Pages,this.EnvironmentService=EnvironmentService,this.lodash=lodash,this.ModalService=ModalService,this.HomeComponentService=HomeComponentService,this.HelpboxService=HelpboxService,this.ActiveSection=ActiveSection,this.Site=Site,this.$state=$state,this.$timeout=$timeout,this.expand=!1,this.isOpen=!0,this.expanded=!1,this.initialMenuHeight=35,this.oldMenuPages=this.lodash.clone(this.Pages.list),this.flatList=this.Pages.flatList;var currPageId=this.Pages.currentPage.pageId,isSubPage=this.Pages.isSubPage(currPageId),hasChildren=this.Pages.currentPage.subPages.length>0;this.isOpen=(isSubPage||hasChildren)&&"layout4"!=this.Site.current.design,this.isOpenForPageId=this.isOpen?hasChildren?currPageId:this.Pages.findParentPage(currPageId).pageId:"",this.$timeout(function(){_this.splitPageList()}),$scope.$watch("vm.Pages.list",function(){_this.oldMenuPages=_this.lodash.clone(_this.Pages.list),_this.$timeout(function(){_this.splitPageList()})},!0),this.currentMenuHeight=this.initialMenuHeight,angular.element(".ss-pagemenu__desktop__page-list-element").ready(function(){_this.updateMenuHeightFromOpenElement(angular.element(".open-subpage"))})}return ssPagemenuController.prototype.splitPageList=function(){for(var mainMenu=document.getElementsByClassName("ss-pagemenu__desktop")[0],mainMenuElements=document.getElementsByClassName("ss-pagemenu__desktop__page-list-element"),total_length=0,i=0;i<mainMenuElements.length-1;i++)if(total_length+=mainMenuElements[i].offsetWidth,total_length>mainMenu.offsetWidth-130){this.oldMenuPages=this.lodash.slice(this.Pages.list,0,i-1),this.subMenuPages=this.lodash.slice(this.Pages.list,i-1);break}},ssPagemenuController.prototype.clickedPageName=function(){null!=this.HomeComponentService.activeSection&&(this.HomeComponentService.activeSection=null,this.ActiveSection.activeSectionId=null,this.HomeComponentService.editmode=!0)},ssPagemenuController.prototype.gotoPage=function(pageId,categoryId,$event){"title"!==this.HomeComponentService.activeSection&&(null!=this.HomeComponentService.activeSection&&(this.HomeComponentService.activeSection=null,this.ActiveSection.activeSectionId=null,this.HomeComponentService.editmode=!0),this.HelpboxService.triggerTipsConditionChange("clickedPageTitleInMenu"),this.$state.go("home",{pageId:pageId,categoryId:categoryId}),$event.stopPropagation())},ssPagemenuController.prototype.isOpenSubMenu=function(pageId){var page=this.Pages.findPage(pageId);return page.subPages.length>0&&this.isOpenForPageId==pageId&&this.isOpen&&!this.ActiveSection.isActive("title")},ssPagemenuController.prototype.toggleIsOpen=function(pageId,$event){pageId!=this.isOpenForPageId&&""!=this.isOpenForPageId||(this.isOpen=!this.isOpen),this.isOpenForPageId=this.isOpen?pageId:"",this.collapseMenu(),this.updateMenuHeightFromOpenElement(angular.element($event.currentTarget).closest(".ss-pagemenu__desktop__page-list-element"))},ssPagemenuController.prototype.updateMenuHeightFromOpenElement=function(openSubmenElement){var subpagemenuheight=this.isOpen&&openSubmenElement.length?openSubmenElement.find(".ss-pagemenu__desktop__subpagemenu.subpages").height():0;this.currentMenuHeight=this.initialMenuHeight+subpagemenuheight,this.updateMenuHeight(this.currentMenuHeight)},ssPagemenuController.prototype.updateMenuHeight=function(height){angular.element(".ss-pagemenu__desktop__page-list").height(height)},ssPagemenuController.prototype.expandMenu=function(){this.updateMenuHeight(this.initialMenuHeight+angular.element(".ss-pagemenu__desktop__subpagemenu.mainpages").height()),this.expanded=!0},ssPagemenuController.prototype.collapseMenu=function(){this.updateMenuHeight(this.currentMenuHeight),this.expanded=!1},ssPagemenuController.prototype.expandSubMenu=function($event){angular.element($event.currentTarget).addClass("sub-menu-open")},ssPagemenuController.prototype.collapseSubMenu=function($event){angular.element($event.currentTarget).removeClass("sub-menu-open")},ssPagemenuController.prototype.isCurrentPage=function(pageId,categoryId){return this.Pages.currentPage.pageId==pageId},ssPagemenuController.prototype.getSubPage=function(){var page=this.Pages.findParentPage(this.Pages.currentPage.pageId);return page?page:this.Pages.currentPage.subPages.length>0?this.Pages.currentPage:null},ssPagemenuController.prototype.openMobileModal=function($event){$event.preventDefault(),this.ModalService.showModal({templateUrl:"partials/home.layout4mobilemenumodal/home.layout4mobilemenumodal.html",controller:"HomeLayout4MobileMenuModal",controllerAs:"vm"})},ssPagemenuController.$inject=["$scope","Pages","EnvironmentService","lodash","ModalService","HomeComponentService","HelpboxService","ActiveSection","Site","$state","$timeout"],ssPagemenuController}();Directives.ssPagemenuController=ssPagemenuController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("ssPagemenu",Common.Directives.ssPagemenu);var Common;!function(Common){var Directives;!function(Directives){function ssPoster($compile){return{priority:99,link:function(scope,element,attr){attr.$observe("ssPoster",function(value){value&&attr.$set("poster",value)})}}}Directives.ssPoster=ssPoster}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("ssPoster",Common.Directives.ssPoster);var Common;!function(Common){var Directives;!function(Directives){function ssSalesPitchBox(){return{bindings:{},controller:Common.Directives.ssSalesPitchBoxController,controllerAs:"vm",templateUrl:"partials/ss-salepitchesbox/ss-salespitchbox.html"}}Directives.ssSalesPitchBox=ssSalesPitchBox;var ssSalesPitchBoxController=function(){function ssSalesPitchBoxController($scope,ModalService,User,lodash,UserEvents){this.$scope=$scope,this.ModalService=ModalService,this.User=User,this.lodash=lodash,this.UserEvents=UserEvents,this.pitch=this.lodash.find(this.User.user.salesPitches,{name:"RightBarSalesPitch"})}return ssSalesPitchBoxController.prototype.openOfferModal=function(offerType){offerType&&"blue"==offerType?this.UserEvents.send("V4UpgradeToPROBlue"):this.UserEvents.send("V4UpgradeToPROGreen"),this.ModalService.showModal({templateUrl:"partials/home.offer/home.offer.html",controller:"HomeOfferController",controllerAs:"vm"}).then(function(modal){})["catch"](function(err){throw err})},ssSalesPitchBoxController.$inject=["$scope","ModalService","User","lodash","UserEvents"],ssSalesPitchBoxController}();Directives.ssSalesPitchBoxController=ssSalesPitchBoxController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").component("ssSalesPitchBox",Common.Directives.ssSalesPitchBox());var Common;!function(Common){var Directives;!function(Directives){function ssSaveCancel($compile){return{scope:{save:"&",cancel:"&"},controller:Common.Directives.ssSaveCancelController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/ss-savecancel/ss-savecancel.html",restrict:"E",transclude:!0}}Directives.ssSaveCancel=ssSaveCancel;var ssSaveCancelController=function(){function ssSaveCancelController($scope,EnvironmentService,HomeComponentService,HintService){this.$scope=$scope,this.EnvironmentService=EnvironmentService,this.HomeComponentService=HomeComponentService,this.HintService=HintService}return ssSaveCancelController.prototype.onsave=function($event){this.save&&this.save({$event:$event})},ssSaveCancelController.prototype.oncancel=function($event){this.cancel&&this.cancel({$event:$event})},ssSaveCancelController.prototype.isBeaconActive=function(tour,hintId){return!!this.HintService.isTourActive(tour)&&(this.hintId=hintId,!0)},ssSaveCancelController.$inject=["$scope","EnvironmentService","HomeComponentService","HintService"],ssSaveCancelController}();Directives.ssSaveCancelController=ssSaveCancelController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("ssSaveCancel",Common.Directives.ssSaveCancel);var Common;!function(Common){var Directives;!function(Directives){function ssSectionEditTitle($compile){return{scope:{text:"@"},controller:Common.Directives.ssSectionEditTitleController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/ss-section-edit-title/ss-section-edit-title.html",restrict:"E",transclude:!0}}Directives.ssSectionEditTitle=ssSectionEditTitle;var ssSectionEditTitleController=function(){function ssSectionEditTitleController($scope){this.$scope=$scope}return ssSectionEditTitleController.$inject=["$scope"],ssSectionEditTitleController}();Directives.ssSectionEditTitleController=ssSectionEditTitleController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("ssSectionEditTitle",Common.Directives.ssSectionEditTitle);var Common;!function(Common){var Directives;!function(Directives){function onFinishRender(){return{restrict:"A",link:function(scope,element,attrs,ngModel){scope.$last&&scope.$evalAsync(attrs.onFinishRender)}}}Directives.onFinishRender=onFinishRender}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("onFinishRender",Common.Directives.onFinishRender);var Common;!function(Common){var Directives;!function(Directives){function ssSlideshow(){return{scope:{images:"=",transition:"=",active:"=",playtoIndex:"=",fullscreenImageId:"=?"},controller:Common.Directives.ssSlideshowController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/ss-slideshow/ss-slideshow.html",restrict:"E",replace:!0}}Directives.ssSlideshow=ssSlideshow;var ssSlideshowController=function(){function ssSlideshowController($scope,$element,$document,$q,lodash,HomeComponentService,EnvironmentService){var _this=this;this.$scope=$scope,this.$element=$element,this.$document=$document,this.$q=$q,this.lodash=lodash,this.HomeComponentService=HomeComponentService,this.EnvironmentService=EnvironmentService,this.imageChanges=0,this.initializeTransitions(),this.initializeSlider().then(function(){_this.$scope.$watch("vm.HomeComponentService.editmode",function(){return _this.handleEditmodeChanged()}),_this.$scope.$watch("vm.transition",function(){return _this.updateTransition()}),_this.$scope.$watch("vm.active",function(){return _this.handleActiveChanged()}),_this.$scope.$watch("vm.playtoIndex",function(){return _this.handlePlayToIndexChanged()}),_this.$scope.$watch("vm.fullscreenImageId",function(){return _this.handleFullscreenImageIdChanged()}),_this.fullscreenContainer=angular.element(_this.$document.find("fullscreen-container")),_this.fullscreenOriginContainer=angular.element(_this.$element),_this.currentContainer=_this.fullscreenOriginContainer,_this.$document.on("keydown",function(event){27===event.keyCode&&_this.isFullscreen&&(event.preventDefault(),_this.fullscreen(!1))})})}return ssSlideshowController.prototype.initializeSlider=function(){var deferred=this.$q.defer(),transition=this.getTransitionById(this.transition);return this.jssorOptions={$StartIndex:this.playtoIndex?this.playtoIndex:0,$AutoPlay:!0,$Idle:3e3,$FillMode:1,$SlideshowOptions:{$Class:$JssorSlideshowRunner$,$Transitions:[transition]},$ArrowNavigatorOptions:{$Class:$JssorArrowNavigator$,$ChanceToShow:2},$DragOrientation:0,onReady:function(){deferred.resolve()}},deferred.promise},ssSlideshowController.prototype.next=function(){this.jssorObject.next()},ssSlideshowController.prototype.previous=function(){this.jssorObject.previous()},ssSlideshowController.prototype.fullscreen=function(toggle){toggle?(this.fullscreenContainer.append(this.$element.find(".slideshow__fullscreen-container")),this.currentContainer=this.fullscreenContainer):(this.fullscreenOriginContainer.append(this.fullscreenContainer.find(".slideshow__fullscreen-container")),this.currentContainer=this.fullscreenOriginContainer,this.fullscreenImageId=null),this.jssorObject.play(),this.isFullscreen=toggle,this.jssorObject.updateSliderWidth()},ssSlideshowController.prototype.handleActiveChanged=function(){this.jssorObject.slider&&(this.active?this.jssorObject.play():this.jssorObject.pause())},ssSlideshowController.prototype.handlePlayToIndexChanged=function(){void 0!==this.playtoIndex&&this.jssorObject&&this.active&&this.jssorObject.playTo(this.playtoIndex)},ssSlideshowController.prototype.handleFullscreenImageIdChanged=function(){this.fullscreenImageId&&this.showFullScreenImage()},ssSlideshowController.prototype.handleEditmodeChanged=function(){this.jssorObject.updateSliderWidth()},ssSlideshowController.prototype.showFullScreenImage=function(){var _this=this;if(this.fullscreenImageId){var index=this.lodash.findIndex(this.images,function(image){return image.id===_this.fullscreenImageId});index>-1&&(this.fullscreen(!0),this.jssorObject.goTo(index),this.jssorObject.pause())}},ssSlideshowController.prototype.slideChanged=function(jssorData){this.currentSlideIndex=jssorData.slideIndex,this.currentImage=this.images[this.currentSlideIndex],this.currentImageHasCaption=null==this.currentImage.caption||0===this.currentImage.caption.length},ssSlideshowController.prototype.updateTransition=function(){var transition=this.getTransitionById(this.transition);this.jssorObject.setTransition(transition)},ssSlideshowController.prototype.getTransitionById=function(id){var transition;if(id&&"Random"!==id)transition=this.transitions[id];else{var min=0,max=this.transitions.length-1,transitionIndex=Math.floor(Math.random()*(max-min))+min;transition=this.transitions[transitionIndex]}return transition},ssSlideshowController.prototype.initializeTransitions=function(){this.transitions=[],this.transitions.Fade={$Duration:1200,$Opacity:2,$Brother:{$Duration:1200,$Opacity:2}},this.transitions.Cubic={$Duration:1e3,$Delay:30,$Cols:8,$Rows:4,$Clip:15,$SlideOut:!0,$Formation:$JssorSlideshowFormations$.$FormationStraightStairs,$Easing:$JssorEasing$.$EaseOutQuad,$Assembly:2049},this.transitions.Stripe={$Duration:1e3,$Cols:8,$Clip:1},this.transitions.Slide={$Duration:1200,x:-1,$Easing:{$Left:$JssorEasing$.$EaseInOutQuart,$Opacity:$JssorEasing$.$EaseLinear},$Opacity:0,$Brother:{$Duration:1200,x:1,$Easing:{$Left:$JssorEasing$.$EaseInOutQuart,$Opacity:$JssorEasing$.$EaseLinear},$Opacity:0}},this.transitions.UpDown={$Duration:1200,y:1,$Easing:{$Top:$JssorEasing$.$EaseInOutQuart,$Opacity:$JssorEasing$.$EaseLinear},$Opacity:2,$ZIndex:-10,$Brother:{$Duration:1200,y:1,$Easing:{$Top:$JssorEasing$.$EaseInOutQuart,$Opacity:$JssorEasing$.$EaseLinear},$Opacity:2,$ZIndex:-10,$Shift:-100}}},ssSlideshowController.$inject=["$scope","$element","$document","$q","lodash","HomeComponentService","EnvironmentService"],ssSlideshowController}();Directives.ssSlideshowController=ssSlideshowController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("ssSlideshow",Common.Directives.ssSlideshow);var Common;!function(Common){var Directives;!function(Directives){function ssSlideshowTransition(){return{bindings:{transition:"="},controller:Common.Directives.ssSlideshowTransitionController,controllerAs:"vm",templateUrl:"partials/ss-slideshow-transition/ss-slideshow-transition.html"}}Directives.ssSlideshowTransition=ssSlideshowTransition;var ssSlideshowTransitionController=function(){function ssSlideshowTransitionController(screenSize,$translate){this.screenSize=screenSize,this.$translate=$translate,this.isMobile=this.screenSize.is("xs, sm"),this.initializeTransitions()}return ssSlideshowTransitionController.prototype.initializeTransitions=function(){var _this=this;this.transitions=[{value:"Fade",name:"Fade"},{value:"Cubic",name:"Cubic"},{value:"Stripe",name:"Stripe"},{value:"Slide",name:"Slide"},{value:"UpDown",name:"Up/Down"},{value:"Random",name:"Random"}],this.transitions.forEach(function(tr){_this.$translate("HOME.PREVIEW.PHOTO_ALBUM.TRANSITIONS."+tr.value.toUpperCase()).then(function(text){tr.name=text})})},ssSlideshowTransitionController.$inject=["screenSize","$translate"],ssSlideshowTransitionController}();Directives.ssSlideshowTransitionController=ssSlideshowTransitionController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").component("ssSlideshowTransition",Common.Directives.ssSlideshowTransition());var Common;!function(Common){var Directives;!function(Directives){function ssTexteditor($compile){return{scope:{text:"=",defaultText:"=",onChange:"&",onChangeNoUserEvent:"&",active:"&",toolbarOptions:"=",sectionId:"="},controller:Common.Directives.ssTexteditorController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/ss-texteditor/ss-texteditor.html",restrict:"E",transclude:!0}}Directives.ssTexteditor=ssTexteditor;var ssTexteditorController=function(){function ssTexteditorController($scope,$stateParams,$timeout,$sce,$element,$document,Pages,User,TinymceUtil,EnvironmentService,HomeComponentService,$translate,lodash,$window,$rootScope,$location,$anchorScroll){var _this=this;this.$scope=$scope,this.$stateParams=$stateParams,this.$timeout=$timeout,this.$sce=$sce,this.$element=$element,this.$document=$document,this.Pages=Pages,this.User=User,this.TinymceUtil=TinymceUtil,this.EnvironmentService=EnvironmentService,this.HomeComponentService=HomeComponentService,this.$translate=$translate,this.lodash=lodash,this.$window=$window,this.$rootScope=$rootScope,this.$location=$location,this.$anchorScroll=$anchorScroll,this.hasFocus=!1,this.toolbarStatus={},this.showEmoticons=!1,this.showFontsizeOptions=!1,this.showFonttypeOptions=!1,this.showFontColorOptions=!1,this.emoticons=Common.Tinymce.EMOTICONS,this.emoticonsmobile=Common.Tinymce.EMOTICONSMOBILE,this.fonts=Common.Tinymce.FONTS,this.colors=Common.Tinymce.COLORS,this.emoticon_local_url="assets/img/emoticons/",this.emoticon_global_url=Common.Globals.ABSOLUTE_DOMAIN_URL+"/images/tinyMceEditor/smilies/",this.formatButtons=[{command:"bold",style:"ss-icon-bold"},{command:"italic",style:"ss-icon-italic"},{command:"underline",style:"ss-icon-underline"}],this.alignButtons=[{command:"justifyleft",style:"ss-icon-align-left"},{command:"justifycenter",style:"ss-icon-align-center"},{command:"justifyright",style:"ss-icon-align-right"},{command:"justifyfull",style:"ss-icon-align-justify"}],this.directionalButtons=[{command:"mceDirectionLTR",style:"ss-icon-bdo-paragraph-ltr"},{command:"mceDirectionRTL",style:"ss-icon-bdo-paragraph-rtl"},{command:"bdoLTR",style:"ss-icon-bdo-selection-ltr"},{command:"bdoRTL",style:"ss-icon-bdo-selection-rtl"}],this.flags={bold:!1},this.tinymceOptions={setup:function(editor){_this.editorInst=editor,editor.on("click focus execCommand",function(){_this.updateToolbar()})},onChange:function(e){}},this.tinymceOptions=TinymceUtil.merge(this.tinymceOptions),this.tinymceOptions.directionality=EnvironmentService.directionality?"rtl":"ltr";var currentCulture=this.User.user.culture,currentLocale=currentCulture.substr(0,currentCulture.indexOf("-"));"en"!=currentLocale&&(this.tinymceOptions.language_url="/i18n/tinymce_locale/"+currentLocale+".js"),this.populateInternalLinks(),this.checkText(this.text,!0),$scope.$watch("vm.EnvironmentService.directionality",function(newValue,oldValue){newValue!==oldValue&&_this.setDirectionality(newValue)}),$element.on("click",function(event){_this.hasFocus=!0,event.preventDefault();var elm=_this.$element[0];if(elm&&HomeComponentService.editmode===!0){var subElm=elm.getElementsByClassName("mce-content-body")[0];if(subElm){var tinymceID=subElm.getAttribute("id");tinyMCE.get(tinymceID).focus()}}if(event.target&&HomeComponentService.editmode===!1){var element=$(event.target),link=element.attr("href");if(_this.tinymceOptions.link_list.filter(function(e){return e.value==link}).length>0)if(link.indexOf("/category/")>-1){var urlParts=link.split("/"),categoryId=urlParts.pop();urlParts.pop();var pageId=urlParts.pop(),redirectLink="#/pages/"+pageId+"_"+categoryId}else var urlParts=link.split("/"),pageId=urlParts.pop(),redirectLink="#/pages/"+pageId;else redirectLink=link;$window.location.href=redirectLink}}),this.checkCookie(!1)}return ssTexteditorController.prototype.isVisibleToolbarItem=function(name){if(!this.toolbarOptions||this.toolbarOptions.length<=0)return!0;var res=this.toolbarOptions.filter(function(item){return item==name});return res&&res.length>0},ssTexteditorController.prototype.checkCookie=function(increment){if(this.EnvironmentService.isMobile){var cookieValue=Number(Cookies.get(Common.Services.CookieNames.SEEN_MOBILE_TOOLBAR_INTRO));if(void 0===cookieValue||isNaN(cookieValue))Cookies.set(Common.Services.CookieNames.SEEN_MOBILE_TOOLBAR_INTRO,0,Common.Globals.DEFAULT_COOKIE_SETTINGS);else if(cookieValue>1)angular.element(window.document.getElementsByClassName("swipe-intro")).addClass("hidden");else if(increment&&!isNaN(cookieValue)){var current=cookieValue+1;Cookies.set(Common.Services.CookieNames.SEEN_MOBILE_TOOLBAR_INTRO,current,Common.Globals.DEFAULT_COOKIE_SETTINGS)}}},ssTexteditorController.prototype.checkText=function(value,isInit){void 0===isInit&&(isInit=!1);var plaintext="none";value&&(plaintext=value.toString().replace(/<(?:.|\n)*?>/gm,""),plaintext=plaintext.trim()),""!==value&&""!==plaintext&&void 0!==value||isInit||(this.handleTextEditorFocus(),this.onChangeNoUserEvent(!1))},ssTexteditorController.prototype.populateInternalLinks=function(){for(var internalLinks=[],links=this.Pages.flatList,i=0;i<links.length;i++){var pageName=links[i].pageName,url=this.Pages.prettyUrl(links[i].pageId);internalLinks.push({title:pageName,value:url})}this.tinymceOptions.link_list=internalLinks},ssTexteditorController.prototype.setDirectionality=function(value){this.lodash.isBoolean(value)&&(this.tinymceOptions.directionality=value?"rtl":"ltr")},ssTexteditorController.prototype.updateToolbar=function(){for(var _this=this,i=0;i<this.formatButtons.length;i++){var statusChangeDetectedByWebkit="true"===this.editorInst.queryCommandValue(this.formatButtons[i].command),statusChangeDetectedByIE=1==this.editorInst.queryCommandValue(this.formatButtons[i].command);this.toolbarStatus[this.formatButtons[i].command]=statusChangeDetectedByWebkit||statusChangeDetectedByIE}for(var i=0;i<this.alignButtons.length;i++)this.toolbarStatus[this.alignButtons[i].command]=1==this.editorInst.queryCommandState(this.alignButtons[i].command);for(var i=0;i<this.directionalButtons.length;i++)this.toolbarStatus[this.directionalButtons[i].command]="true"===this.editorInst.queryCommandValue(this.directionalButtons[i].command);var selectedElm=this.editorInst.selection.getNode(),anchorElm=this.editorInst.dom.getParent(selectedElm,"a[href]");this.toolbarStatus.link=null!==anchorElm;var anchorElm=this.editorInst.dom.getParent(selectedElm,'p[dir="ltr"]');this.toolbarStatus.mceDirectionLTR=null!==anchorElm;var anchorElm=this.editorInst.dom.getParent(selectedElm,'p[dir="rtl"]');this.toolbarStatus.mceDirectionRTL=null!==anchorElm;var anchorElm=this.editorInst.dom.getParent(selectedElm,'bdo[dir="ltr"]');this.toolbarStatus.bdoLTR=null!==anchorElm;var anchorElm=this.editorInst.dom.getParent(selectedElm,'bdo[dir="rtl"]');this.toolbarStatus.bdoRTL=null!==anchorElm;var fontSize=this.editorInst.queryCommandValue("fontSize").toString();fontSize.indexOf("px")>-1&&(this.toolbarStatus.fontSize=fontSize.replace("px",""));var node=this.editorInst.selection.getSel().baseNode.parentElement,fontFamily=this.editorInst.dom.getStyle(node,"font-family",!0),font=this.fonts.filter(function(f){return f.fontfamily==fontFamily})[0];font||(font=this.fonts[0]),this.toolbarStatus.font=font;var fontColor=this.editorInst.dom.getStyle(node,"color",!0),color=this.colors.filter(function(c){var col=_this.toHexColorString(fontColor);return c.value.toUpperCase()==col.toUpperCase()})[0];color||(color=this.colors[0]),this.toolbarStatus.fontColor=color,this.toolbarStatus.hasUndo=this.editorInst.undoManager.hasUndo(),this.toolbarStatus.hasRedo=this.editorInst.undoManager.hasRedo()},ssTexteditorController.prototype.toHex=function(n){for(var hex=n.toString(16);hex.length<2;)hex="0"+hex;return hex},ssTexteditorController.prototype.toHexColorString=function(rgb){rgb=rgb.substring(4,rgb.length-1).replace(/ /g,"").split(",");var r=this.toHex(parseInt(rgb[0],10)),g=this.toHex(parseInt(rgb[1],10)),b=this.toHex(parseInt(rgb[2],10));return"#"+r+g+b},ssTexteditorController.prototype.editorLink=function(){this.handleTextEditorFocus(),this.editorInst.plugins.link.showDialog(this.editorInst.settings.link_list)},ssTexteditorController.prototype.editorShowEmoticons=function(){this.showEmoticons=!this.showEmoticons,this.showFonttypeOptions=!1,this.showFontsizeOptions=!1,this.showFontColorOptions=!1},ssTexteditorController.prototype.editorShowFontsizeOptions=function(){this.showEmoticons=!1,this.showFonttypeOptions=!1,this.showFontColorOptions=!1,this.showFontsizeOptions=!this.showFontsizeOptions},ssTexteditorController.prototype.editorShowFonttypeOptions=function(){this.showEmoticons=!1,this.showFontsizeOptions=!1,this.showFontColorOptions=!1,this.showFonttypeOptions=!this.showFonttypeOptions},ssTexteditorController.prototype.editorShowFontColorOptions=function(){this.showEmoticons=!1,this.showFontsizeOptions=!1,this.showFonttypeOptions=!1,this.showFontColorOptions=!this.showFontColorOptions},ssTexteditorController.prototype.editorEmoticon=function(icon,e){this.handleTextEditorFocus(),this.showEmoticons=!1;var linkElm=this.editorInst.dom.getParent(e.target,"a");linkElm&&this.editorInst.insertContent('<img style="height:18px;width:18px;" src="'+linkElm.getAttribute("data-mce-url")+'" alt="'+linkElm.getAttribute("data-mce-alt")+'" />')},ssTexteditorController.prototype.editor=function(command,ui,value){this.handleTextEditorFocus();var tinymceID=this.$element[0].getElementsByClassName("mce-content-body")[0].getAttribute("id");tinyMCE.get(tinymceID).execCommand(command,ui,value),this.closeToolbarOptions()},ssTexteditorController.prototype.closeToolbarOptions=function(){this.showFontsizeOptions=!1,this.showEmoticons=!1,this.showFonttypeOptions=!1,this.showFontColorOptions=!1},
ssTexteditorController.prototype.handleTextEditorFocus=function(){this.textEditorBlurTimeout&&this.$timeout.cancel(this.textEditorBlurTimeout),this.hasFocus=!0},ssTexteditorController.prototype.handleTextEditorBlur=function(event){var _this=this;this.checkText(this.text);var isNoToolbarDialogOpen=0==this.editorInst.windowManager.windows.length;null!==event.sourceCapabilities&&isNoToolbarDialogOpen&&(this.textEditorBlurTimeout=this.$timeout(function(){_this.hasFocus=!1},200))},ssTexteditorController.prototype.handleTouchStartEvent=function(){this.checkCookie(!0),angular.element(window.document.getElementsByClassName("swipe-intro")).on("mousedown touchstart",function(){angular.element(window.document.getElementsByClassName("swipe-intro")).addClass("hidden")})},ssTexteditorController.prototype.isTextLocked=function(event,editmode,sectionId){if(editmode)if(this.HomeComponentService.activeSection&&this.HomeComponentService.activeSection.sectionId!==sectionId){event.stopPropagation();var prefix=this.HomeComponentService.scrolltotop?"section_":"savecancel_";"title"==this.HomeComponentService.activeSection?this.$location.hash("site-preview"):this.$location.hash(prefix+this.HomeComponentService.activeSection.sectionId),this.$anchorScroll()}else this.handleTextEditorFocus();else event.stopPropagation()},ssTexteditorController.prototype.isTextBlank=function(){var plaintext="none";return this.text&&(plaintext=this.text.toString().replace(/<(?:.|\n)*?>/gm,""),plaintext=plaintext.trim()),""===this.text||""===plaintext||void 0===this.text},ssTexteditorController.$inject=["$scope","$stateParams","$timeout","$sce","$element","$document","Pages","User","TinymceUtil","EnvironmentService","HomeComponentService","$translate","lodash","$window","$rootScope","$location","$anchorScroll"],ssTexteditorController}();Directives.ssTexteditorController=ssTexteditorController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("ssTexteditor",Common.Directives.ssTexteditor);var Common;!function(Common){var Directives;!function(Directives){function ssTitlesettingsControls(){return{bindings:{showTetherBox:"="},controller:Common.Directives.ssTitlesettingsControlsController,controllerAs:"vm",templateUrl:"partials/ss-title-settings/ss-title-settings-controls.html"}}Directives.ssTitlesettingsControls=ssTitlesettingsControls;var ssTitlesettingsControlsController=function(){function ssTitlesettingsControlsController($scope,headersettings,EnvironmentService,HomeComponentService,$anchorScroll,$location,UserEvents,DesignereditorAssetsService,User,ModalService,Site,lodash,$window){this.$scope=$scope,this.headersettings=headersettings,this.EnvironmentService=EnvironmentService,this.HomeComponentService=HomeComponentService,this.$anchorScroll=$anchorScroll,this.$location=$location,this.UserEvents=UserEvents,this.DesignereditorAssetsService=DesignereditorAssetsService,this.User=User,this.ModalService=ModalService,this.Site=Site,this.lodash=lodash,this.$window=$window,this.logosArray=[],this.logosArrayFree=[],this.logosArrayPro=[],this.uploadBackgroundProgress=0,this.more="none",this.hasPitchBox=!User.user.isPremiumCustomer,this.logosArrayFree=this.lodash.filter(DesignereditorAssetsService.logosArray,{Premium:!1}),this.logosArrayPro=this.lodash.filter(DesignereditorAssetsService.logosArray,{Premium:!0});document.getElementById("dragsettings");this.EnvironmentService.isMobile?this.showDesktopLayouts=!1:this.showDesktopLayouts=!0}return ssTitlesettingsControlsController.prototype.showMore=function(design_section){this.showTetherBox=design_section,this.more=design_section},ssTitlesettingsControlsController.prototype.isShowTetherBox=function(){return""!==this.showTetherBox},ssTitlesettingsControlsController.prototype.setHeaderLayout=function(layoutId){this.headersettings.setLayoutSetting(layoutId)},ssTitlesettingsControlsController.$inject=["$scope","headersettings","EnvironmentService","HomeComponentService","$anchorScroll","$location","UserEvents","DesignereditorAssetsService","User","ModalService","Site","lodash","$window"],ssTitlesettingsControlsController}();Directives.ssTitlesettingsControlsController=ssTitlesettingsControlsController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").component("ssTitlesettingscontrols",Common.Directives.ssTitlesettingsControls());var Common;!function(Common){var Directives;!function(Directives){function ssTitlesettingsLogos(){return{bindings:{showTetherBox:"="},controller:Common.Directives.ssTitlesettingslogosController,controllerAs:"vm",templateUrl:"partials/ss-title-settings/ss-title-settings-logos.html"}}Directives.ssTitlesettingsLogos=ssTitlesettingsLogos;var ssTitlesettingslogosController=function(){function ssTitlesettingslogosController($scope,headersettings,EnvironmentService,HomeComponentService,$anchorScroll,$location,UserEvents,DesignereditorAssetsService,User,ModalService,Site,lodash,$window){this.$scope=$scope,this.headersettings=headersettings,this.EnvironmentService=EnvironmentService,this.HomeComponentService=HomeComponentService,this.$anchorScroll=$anchorScroll,this.$location=$location,this.UserEvents=UserEvents,this.DesignereditorAssetsService=DesignereditorAssetsService,this.User=User,this.ModalService=ModalService,this.Site=Site,this.lodash=lodash,this.$window=$window,this.logosArray=[],this.logosArrayFree=[],this.logosArrayPro=[],this.uploadBackgroundProgress=0,this.more="none",this.hasPitchBox=!User.user.isPremiumCustomer,this.logosArrayFree=this.lodash.filter(DesignereditorAssetsService.logosArray,{Premium:!1}),this.logosArrayPro=this.lodash.filter(DesignereditorAssetsService.logosArray,{Premium:!0});document.getElementById("dragsettings");this.siteedit=headersettings.site,"layout4"!==this.HomeComponentService.design&&(this.siteedit=this.Site.current),this.EnvironmentService.isMobile?this.showDesktopLayouts=!1:this.showDesktopLayouts=!0}return ssTitlesettingslogosController.prototype.setLogo=function(selectedLogo,removeImage){var _this=this;if("layout4"===this.HomeComponentService.design){var LogoNameOrNull=selectedLogo?selectedLogo.LogoName:null,delta={logo:LogoNameOrNull};"image"==this.headersettings.site.logo&&removeImage&&(this.headersettings.site.logoImage=null),this.headersettings.site.logo=LogoNameOrNull}else{this.scrollToHeader(),this.UserEvents.send("V4LogoChanged");var LogoNameOrNull=selectedLogo?selectedLogo.LogoName:null,delta={logo:LogoNameOrNull};"image"==this.Site.current.logo&&removeImage&&(delta.logoImageId=0,this.siteedit.logoImage=null),this.Site.update(delta).then(function(site){_this.Site.current.logo=LogoNameOrNull,_this.siteedit.logo=LogoNameOrNull})["finally"](function(){_this.working=!1})}},ssTitlesettingslogosController.prototype.scrollToHeader=function(){this.EnvironmentService.isMobile?this.$window.location.href="#site-header":this.$location.hash("site-header"),this.$anchorScroll()},ssTitlesettingslogosController.prototype.uploadLogoImage=function(file){var _this=this;this.scrollToHeader(),this.working||(this.working=!0,file&&file.size>0?this.Site.uploadLogoImage(file).then(function(logoImage){"layout4"===_this.HomeComponentService.design?(_this.headersettings.site.logoImage=logoImage,_this.headersettings.site.logo="image"):(_this.Site.current.logoImage=logoImage,_this.Site.current.logo="image"),_this.siteedit.logoImage=logoImage,_this.siteedit.logo="image"},function(error){},function(progress){_this.uploadBackgroundProgress=progress})["finally"](function(){_this.uploadBackgroundProgress=0,_this.working=!1}):this.working=!1)},ssTitlesettingslogosController.prototype.showProModal=function(){this.ModalService.showModal({templateUrl:"partials/home.offer/home.offer.html",controller:"HomeOfferController",controllerAs:"vm"}).then(function(modal){})["catch"](function(err){throw err})},ssTitlesettingslogosController.prototype.showMore=function(design_section){this.showTetherBox=design_section,this.more=design_section},ssTitlesettingslogosController.prototype.done=function(){this.showTetherBox=""},ssTitlesettingslogosController.prototype.isShowTetherBox=function(){return""!==this.showTetherBox},ssTitlesettingslogosController.prototype.setHeaderLayout=function(layoutId){this.headersettings.setLayoutSetting(layoutId)},ssTitlesettingslogosController.$inject=["$scope","headersettings","EnvironmentService","HomeComponentService","$anchorScroll","$location","UserEvents","DesignereditorAssetsService","User","ModalService","Site","lodash","$window"],ssTitlesettingslogosController}();Directives.ssTitlesettingslogosController=ssTitlesettingslogosController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").component("ssTitlesettingslogos",Common.Directives.ssTitlesettingsLogos());var Common;!function(Common){var Directives;!function(Directives){var SSTitleSettingsMobileController=function(){function SSTitleSettingsMobileController(Site,$scope,$compile,close,headersettings,EnvironmentService,showTetherBox){this.Site=Site,this.$scope=$scope,this.$compile=$compile,this.close=close,this.headersettings=headersettings,this.EnvironmentService=EnvironmentService,this.showTetherBox=showTetherBox,this.stringName="fdsfd",this.shown=!0,this.EnvironmentService.isMobile?this.showDesktopLayouts=!1:this.showDesktopLayouts=!0}return SSTitleSettingsMobileController.prototype.closeModal=function(){this.showTetherBox="",this.shown=!1,this.close({},0)},SSTitleSettingsMobileController.prototype.done=function(){this.closeModal()},SSTitleSettingsMobileController.prototype.setHeaderLayout=function(layoutId){this.headersettings.setLayoutSetting(layoutId)},SSTitleSettingsMobileController.prototype.selectMobileLayout=function(layoutId){this.headersettings.setLayoutSetting(layoutId),this.shown=!1,this.close({},0)},SSTitleSettingsMobileController.$inject=["Site","$scope","$compile","close","headersettings","EnvironmentService","showTetherBox"],SSTitleSettingsMobileController}();Directives.SSTitleSettingsMobileController=SSTitleSettingsMobileController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("SSTitleSettingsMobileController",Common.Directives.SSTitleSettingsMobileController);var Common;!function(Common){var Directives;!function(Directives){function ssTitlesettings(){return{bindings:{showTetherBox:"="},controller:Common.Directives.ssTitlesettingsController,controllerAs:"vm",templateUrl:"partials/ss-title-settings/ss-title-settings.html"}}Directives.ssTitlesettings=ssTitlesettings;var ssTitlesettingsController=function(){function ssTitlesettingsController($scope,headersettings,EnvironmentService,HomeComponentService,$anchorScroll,$location,UserEvents,DesignereditorAssetsService,User,ModalService,Site,lodash,$window){this.$scope=$scope,this.headersettings=headersettings,this.EnvironmentService=EnvironmentService,this.HomeComponentService=HomeComponentService,this.$anchorScroll=$anchorScroll,this.$location=$location,this.UserEvents=UserEvents,this.DesignereditorAssetsService=DesignereditorAssetsService,this.User=User,this.ModalService=ModalService,this.Site=Site,this.lodash=lodash,this.$window=$window,this.logosArray=[],this.logosArrayFree=[],this.logosArrayPro=[],this.uploadBackgroundProgress=0,this.more="none",this.hasPitchBox=!User.user.isPremiumCustomer,this.logosArrayFree=this.lodash.filter(DesignereditorAssetsService.logosArray,{Premium:!1}),this.logosArrayPro=this.lodash.filter(DesignereditorAssetsService.logosArray,{Premium:!0});var dm=document.getElementById("dragsettings");dm.addEventListener("dragstart",this.drag_start,!1),document.body.addEventListener("dragover",this.drag_over,!1),document.body.addEventListener("drop",this.drop,!1),this.EnvironmentService.isMobile?this.showDesktopLayouts=!1:this.showDesktopLayouts=!0}return ssTitlesettingsController.prototype.drag_start=function(event){var style=window.getComputedStyle(event.target,null);event.dataTransfer.setData("text/plain",parseInt(style.getPropertyValue("left"),10)-event.clientX+","+(parseInt(style.getPropertyValue("top"),10)-event.clientY))},ssTitlesettingsController.prototype.drag_over=function(event){return event.preventDefault(),!1},ssTitlesettingsController.prototype.drop=function(event){var offset=event.dataTransfer.getData("text/plain").split(","),dm=document.getElementById("dragsettings");return dm.style.left=event.clientX+parseInt(offset[0],10)+"px",dm.style.top=event.clientY+parseInt(offset[1],10)+"px",event.preventDefault(),!1},ssTitlesettingsController.prototype.showMore=function(design_section){this.showTetherBox=design_section,this.more=design_section,this.EnvironmentService.isMobile&&this.ModalService.showModal({templateUrl:"partials/ss-title-settings/ss-title-settings-mobile.html",controller:"SSTitleSettingsMobileController",controllerAs:"vm",inputs:{showTetherBox:this.showTetherBox}})},ssTitlesettingsController.prototype.setLogo=function(selectedLogo,removeImage){var LogoNameOrNull=selectedLogo?selectedLogo.LogoName:null;this.headersettings.site.logo=LogoNameOrNull},ssTitlesettingsController.prototype.scrollToHeader=function(){this.$location.hash("site-preview"),this.$anchorScroll()},ssTitlesettingsController.prototype.done=function(){this.showTetherBox=""},ssTitlesettingsController.prototype.isShowTetherBox=function(){return""!==this.showTetherBox},ssTitlesettingsController.prototype.setHeaderLayout=function(layoutId){this.headersettings.setLayoutSetting(layoutId)},ssTitlesettingsController.$inject=["$scope","headersettings","EnvironmentService","HomeComponentService","$anchorScroll","$location","UserEvents","DesignereditorAssetsService","User","ModalService","Site","lodash","$window"],ssTitlesettingsController}();Directives.ssTitlesettingsController=ssTitlesettingsController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").component("ssTitlesettings",Common.Directives.ssTitlesettings());var Common;!function(Common){var Directives;!function(Directives){function textsection($compile){return{scope:{section:"="},controller:Common.Directives.TextsectionController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/textsection/textsection.html",restrict:"E",transclude:!0}}Directives.textsection=textsection;var TextsectionController=function(_super){function TextsectionController($scope,Sections,Pages,ActiveSection,HomeComponentService,HomePreviewComponentService,$element,EnvironmentService,$injector,Experiments,$translate){var _this=this;_super.call(this,$scope,Pages,ActiveSection,Sections,HomeComponentService,$injector),this.$scope=$scope,this.Sections=Sections,this.Pages=Pages,this.ActiveSection=ActiveSection,this.HomeComponentService=HomeComponentService,this.HomePreviewComponentService=HomePreviewComponentService,this.$element=$element,this.EnvironmentService=EnvironmentService,this.$injector=$injector,this.Experiments=Experiments,this.$translate=$translate,this.saveAndDeactivate=function($event){$event.stopPropagation();var isCurrentSectionEmpty=_this.isSectionEmpty(_this.section);isCurrentSectionEmpty?_this.HomePreviewComponentService.openDeleteModal(_this.section,!0):_this.saveSection().then(function(section){_this.deactivate(section)})},this.saveSection=function(showNotification){void 0===showNotification&&(showNotification=!0);var def=_this.$q.defer();return _this.preSaveSectionImage().then(function(){_this.addOrUpdateSection(!0,showNotification).then(function(response){var section=response.data;def.resolve(section)})}),def.promise},$element.on("click",function(event){event.preventDefault()}),this.$translate("HOME.DEFAULT_TEXT_IN_TEXTSECTION.HEADLINE").then(function(headline){_this.$translate("HOME.DEFAULT_TEXT_IN_TEXTSECTION.TEXT").then(function(text){_this.defaultHeadline=headline,_this.defaultText=text,null!==_this.section.initSection&&_this.section.initSection===!0&&_this.init()})})}return __extends(TextsectionController,_super),TextsectionController.prototype.isSectionEmpty=function(mSection){var isSectionEmpty=!1,textSection=this.lodash.clone(mSection);return null!=textSection.headline&&""!=textSection.headline||!this.isTextBlank(textSection.text)||null!=textSection.image.url&&""!=textSection.image.url||(isSectionEmpty=!0),isSectionEmpty},TextsectionController.prototype.preSaveSectionImage=function(){var def=this.$q.defer(),sec=this.section;if(sec&&sec.image&&sec.image.blob){var uploadPromise=this.SectionImagesApi.upload(this.Pages.currentPage.pageType,this.Pages.currentPage.pageId,this.section.type,this.section.sectionId,sec.image,sec.image.blob);uploadPromise.then(function(response){sec.image.url=response.url,sec.image.id=response.id,def.resolve()})}else def.resolve();return def.promise},TextsectionController.prototype.init=function(){this.section.text=this.defaultText,this.saveSection(!1),this.updateOriginalSection(),null==this.section.initSection},TextsectionController.prototype.checkHeadline=function(){this.section.headline===this.defaultHeadline&&(this.section.headline="")},TextsectionController.$inject=["$scope","Sections","Pages","ActiveSection","HomeComponentService","HomePreviewComponentService","$element","EnvironmentService","$injector","Experiments","$translate"],TextsectionController}(Directives.SectionController);Directives.TextsectionController=TextsectionController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("textsection",Common.Directives.textsection);var Common;!function(Common){var Directives;!function(Directives){function titlesection(){return{scope:{section:"="},controller:Common.Directives.TitleSectionController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/titlesection/titlesection.html",restrict:"E",replace:!0,transclude:!0}}Directives.titlesection=titlesection;var TitleSectionController=function(_super){function TitleSectionController($scope,Sections,Pages,ActiveSection,HomeComponentService,HomePreviewComponentService,$injector,$translate){var _this=this;_super.call(this,$scope,Pages,ActiveSection,Sections,HomeComponentService,$injector),this.$scope=$scope,this.Sections=Sections,this.Pages=Pages,this.ActiveSection=ActiveSection,this.HomeComponentService=HomeComponentService,this.HomePreviewComponentService=HomePreviewComponentService,this.$injector=$injector,this.$translate=$translate,this.saveAndDeactivate=function($event){$event.stopPropagation();var isCurrentSectionEmpty=_this.isSectionEmpty(_this.section);isCurrentSectionEmpty?_this.HomePreviewComponentService.openDeleteModal(_this.section,!0):_this.saveSection().then(function(section){_this.deactivate(section)})},this.saveSection=function(showNotification){void 0===showNotification&&(showNotification=!0);var deferred=_this.$q.defer();return _this.addOrUpdateSection(!0,showNotification).then(function(response){var section=response.data;deferred.resolve(section)}),deferred.promise},this.defaultHeadline='<p><span style="font-size: 24px;">'+this.$translate.instant("HOME.PREVIEW.TITLE_SECTION.DEFAULT_TEXT")+"</span></p>",null!=this.section.title&&""!=this.section.title||(this.originalSection.title=this.section.title=this.defaultHeadline),this.HomePreviewComponentService.sectionIdJustAdded==this.section.sectionId&&(this.saveSection(!1),null==HomePreviewComponentService.sectionIdJustAdded)}return __extends(TitleSectionController,_super),TitleSectionController.prototype.isSectionEmpty=function(mSection){return this.isTextBlank(mSection.title)},TitleSectionController.$inject=["$scope","Sections","Pages","ActiveSection","HomeComponentService","HomePreviewComponentService","$injector","$translate"],TitleSectionController}(Directives.SectionController);Directives.TitleSectionController=TitleSectionController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("titlesection",Common.Directives.titlesection);var Common;!function(Common){var Directives;!function(Directives){function videosection($compile){return{scope:{section:"="},controller:Common.Directives.VideosectionController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/videosection/videosection.html",restrict:"E",transclude:!0}}Directives.videosection=videosection;var VideosectionController=function(_super){function VideosectionController($scope,$sce,Sections,lodash,ActiveSection,HomeComponentService,HomePreviewComponentService,EnvironmentService,InternalMedia,Pages,$interval,$injector,$q){var _this=this;_super.call(this,$scope,Pages,ActiveSection,Sections,HomeComponentService,$injector),this.$scope=$scope,this.$sce=$sce,this.Sections=Sections,this.lodash=lodash,this.ActiveSection=ActiveSection,this.HomeComponentService=HomeComponentService,this.HomePreviewComponentService=HomePreviewComponentService,this.EnvironmentService=EnvironmentService,this.InternalMedia=InternalMedia,this.Pages=Pages,this.$interval=$interval,this.$injector=$injector,this.$q=$q,this.addSection={},this.uploadPercentage=0,this.uploading=!1,this.isEmptyParent=function(videoSection){var isEmpty=!0;if("ExternalVideo"===videoSection.type){var extVideoSection=videoSection;isEmpty=!extVideoSection.url}else if("InternalMedia"===videoSection.type){var intVideoSection=videoSection;isEmpty="NoVideo"==intVideoSection.media.status}return isEmpty&&_this.addSection.url&&_this.addSection.url.length>0&&(_this.addSection.url.indexOf("youtube")>=0||_this.addSection.url.indexOf("vimeo")>=0)&&(isEmpty=!1),Boolean(isEmpty)},this.saveAndDeactivate=function($event){$event.stopPropagation(),_this.updateModel(),_this.isSectionEmpty(_this.section)?_this.HomePreviewComponentService.openDeleteModal(_this.section,!0):_this.addExternalVideoIfNeeded().then(function(){_this.addOrUpdateSection(!0).then(function(response){var section=response.data;_this.deactivate(section)})})},this.addExternalVideoIfNeeded=function(){var deferred=_this.$q.defer();return _this.addSection.url&&_this.addSection.url.length>0?_this.addExternalVideo(deferred):deferred.resolve(!0),deferred.promise},this.wrongRequestMsg=!1,this.wrongFileType=!1,this.noUrlInExternalInput=!1,this.updateViewModel(),$scope.$watch("vm.file",function(newValue){_this.file&&_this.validateFile(_this.file)&&_this.uploadInternalMediaAndSave()}),"NoVideo"===this.videoSection.status?this.innerEditMode="add":this.innerEditMode="edit"}return __extends(VideosectionController,_super),VideosectionController.prototype.validateFile=function(file){return!!this.lodash.includes(file.type,"video")||(this.wrongFileType=!0,this.wrongRequestMsg=!1,!1)},VideosectionController.prototype.sanitizeProtocols=function(url){if(url)return"https"===this.$location.protocol()&&url.indexOf("http:")>-1&&(url=url.replace("http:","https:")),url},VideosectionController.prototype.isSectionEmpty=function(mSection){var isSectionEmpty=this.isEmptyParent(this.originalSection);return isSectionEmpty},VideosectionController.prototype.addExternalVideo=function(deferred){var _this=this;if(this.addSection.url&&this.addSection.url.length>0){var oldSectionType=this.section.type,oldSectionId=this.section.sectionId,pageType=this.Pages.currentPage.pageType,pageId=this.Pages.currentPage.pageId,newSection={index:this.section.index,type:"ExternalVideo",title:"",text:"",url:this.addSection.url};this.Sections.add(pageType,pageId,newSection).success(function(data){_this.section=data,_this.updateViewModel(),_this.innerEditMode="edit",_this.Sections["delete"](pageType,pageId,oldSectionType,oldSectionId),_this.HomeComponentService.activeSection=null,_this.HomeComponentService.editmode=!0,_this.activate(),deferred.resolve(!0)}).error(function(data,status,headers,config){_this.wrongRequestMsg=!0,_this.wrongFileType=!1,_this.noUrlInExternalInput=!1,deferred.reject(!1)})}else this.noUrlInExternalInput=!0,deferred.reject(!1)},VideosectionController.prototype.addExternalVideoIfEnter=function($event){var deferred=this.$q.defer();13===$event.keyCode&&this.addExternalVideo(deferred)},VideosectionController.prototype.addExternalVideoFromMarkup=function(){var deferred=this.$q.defer();this.addExternalVideo(deferred)},VideosectionController.prototype.addInternalMediaSection=function(){var _this=this;this.innerEditMode="edit",this.section={index:this.section.index,type:"InternalMedia"};var pageId=this.Pages.currentPage.pageId,pageType=this.Pages.currentPage.pageType;this.Sections.add(pageType,pageId,this.section).success(function(data){_this.section=data,_this.updateViewModel()})},VideosectionController.prototype.uploadInternalMediaAndSave=function(){var _this=this;this.uploading=!0,this.InternalMedia.addMedia(this.Pages.currentPage.pageId,this.section.sectionId,this.file).then(function(media){_this.innerEditMode="edit",_this.section.media=media,_this.updateViewModel()},function(error){_this.uploading=!1},function(uploadPercentage){_this.uploadPercentage=uploadPercentage})},VideosectionController.prototype.pollInternalMediaStatus=function(){var _this=this;this.pollInternalMediaStatusInterval=this.$interval(function(){_this.Sections.get(_this.Pages.currentPage.pageType,_this.Pages.currentPage.pageId,_this.section.type,_this.section.sectionId).success(function(section){"InternalMedia"===section.type&&"Ready"===section.media.status&&(_this.Pages.currentPage.sections[_this.Pages.getSectionIndex(_this.section.sectionId)]=section,_this.section=section,_this.updateViewModel())})},5e3)},VideosectionController.prototype.updateModel=function(){this.section.title=this.videoSection.title,this.section.text=this.videoSection.text},VideosectionController.prototype.updateViewModel=function(){if("ExternalVideo"===this.section.type){var externalVideoSection=this.section;this.videoSection={type:externalVideoSection.type,title:externalVideoSection.title,text:externalVideoSection.text,url:this.$sce.trustAsResourceUrl(this.sanitizeProtocols(externalVideoSection.url)),status:"Ready",media:null}}else if("InternalMedia"===this.section.type){var internalMediaSection=this.section;this.videoSection={type:internalMediaSection.type,title:internalMediaSection.title,text:internalMediaSection.text,url:this.$sce.trustAsResourceUrl(this.sanitizeProtocols(internalMediaSection.media.url)),status:internalMediaSection.media.status,media:internalMediaSection.media},this.videoSection.media.posterUrl&&(this.videoSection.media.posterUrl=this.sanitizeProtocols(this.videoSection.media.posterUrl)),"edit"!==this.innerEditMode||"Processing"!==this.videoSection.status||this.pollInternalMediaStatusInterval||this.pollInternalMediaStatus(),this.pollInternalMediaStatusInterval&&"Processing"!==this.videoSection.status&&this.$interval.cancel(this.pollInternalMediaStatusInterval)}},VideosectionController.$inject=["$scope","$sce","Sections","lodash","ActiveSection","HomeComponentService","HomePreviewComponentService","EnvironmentService","InternalMedia","Pages","$interval","$injector","$q"],VideosectionController}(Directives.SectionController);Directives.VideosectionController=VideosectionController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("videosection",Common.Directives.videosection);var Common;!function(Common){var Directives;!function(Directives){function webshopProductAddButtonL4($compile){return{scope:{product:"="},controller:Common.Directives.WebshopProductAddButtonL4Controller,controllerAs:"vm",bindToController:!0,template:'<button class="new-button-l4" ng-click="$emit(\'product-element-clicked\')">Add to basket</button>',restrict:"E",replace:!0}}Directives.webshopProductAddButtonL4=webshopProductAddButtonL4;var WebshopProductAddButtonL4Controller=function(){function WebshopProductAddButtonL4Controller(){}return WebshopProductAddButtonL4Controller}();Directives.WebshopProductAddButtonL4Controller=WebshopProductAddButtonL4Controller}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("webshopProductAddButtonL4",Common.Directives.webshopProductAddButtonL4);var Common;!function(Common){var Directives;!function(Directives){function webshopProductAddButton($compile){return{scope:{product:"="},controller:Common.Directives.WebshopProductAddButtonController,controllerAs:"vm",bindToController:!0,template:'<a class="webshop__product__add-button" ng-click="$emit(\'product-element-clicked\')">Add to basket</a>',restrict:"E",replace:!0}}Directives.webshopProductAddButton=webshopProductAddButton;var WebshopProductAddButtonController=function(){function WebshopProductAddButtonController(){}return WebshopProductAddButtonController}();Directives.WebshopProductAddButtonController=WebshopProductAddButtonController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("webshopProductAddButton",Common.Directives.webshopProductAddButton);var Common;!function(Common){var Directives;!function(Directives){function webshopProductDescriptionL4($compile){return{scope:{product:"="},controller:Common.Directives.WebshopProductDescriptionL4Controller,controllerAs:"vm",bindToController:!0,template:'<div ng-click="$emit(\'product-element-clicked\')" class="webshoppage__product__description-l4">{{vm.product.description}}</div>',restrict:"E",replace:!0}}Directives.webshopProductDescriptionL4=webshopProductDescriptionL4;var WebshopProductDescriptionL4Controller=function(){function WebshopProductDescriptionL4Controller(){}return WebshopProductDescriptionL4Controller}();Directives.WebshopProductDescriptionL4Controller=WebshopProductDescriptionL4Controller}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("webshopProductDescriptionL4",Common.Directives.webshopProductDescriptionL4);var Common;!function(Common){var Directives;!function(Directives){function webshopProductDescription($compile){return{scope:{product:"="},controller:Common.Directives.WebshopProductDescriptionController,controllerAs:"vm",bindToController:!0,template:'<div ng-click="$emit(\'product-element-clicked\')" class="webshoppage__product__description">{{vm.product.description}}</div>',restrict:"E",replace:!0}}Directives.webshopProductDescription=webshopProductDescription;var WebshopProductDescriptionController=function(){function WebshopProductDescriptionController(){}return WebshopProductDescriptionController}();Directives.WebshopProductDescriptionController=WebshopProductDescriptionController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("webshopProductDescription",Common.Directives.webshopProductDescription);var Common;!function(Common){var Directives;!function(Directives){function webshopProductImage($compile){return{scope:{product:"="},controller:Common.Directives.WebshopProductImageController,controllerAs:"vm",bindToController:!0,templateUrl:"partials/webshop/product/image.html",restrict:"E",replace:!0}}Directives.webshopProductImage=webshopProductImage;var WebshopProductImageController=function(){function WebshopProductImageController(Site){this.Site=Site,this.product.images&&this.product.images.length>0&&(this.imageUrl=this.product.images[0].url)}return WebshopProductImageController.$inject=["Site"],WebshopProductImageController}();Directives.WebshopProductImageController=WebshopProductImageController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("webshopProductImage",Common.Directives.webshopProductImage);var Common;!function(Common){var Directives;!function(Directives){function webshopProductNameL4($compile){return{scope:{product:"="},controller:Common.Directives.WebshopProductNameL4Controller,controllerAs:"vm",bindToController:!0,template:'<div class="webshoppage__product__name-l4" ng-click="$emit(\'product-element-clicked\')"><span class="animate-right">{{vm.product.name}}</span></div>',
restrict:"E",replace:!0}}Directives.webshopProductNameL4=webshopProductNameL4;var WebshopProductNameL4Controller=function(){function WebshopProductNameL4Controller(){}return WebshopProductNameL4Controller}();Directives.WebshopProductNameL4Controller=WebshopProductNameL4Controller}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("webshopProductNameL4",Common.Directives.webshopProductNameL4);var Common;!function(Common){var Directives;!function(Directives){function webshopProductName($compile){return{scope:{product:"="},controller:Common.Directives.WebshopProductNameController,controllerAs:"vm",bindToController:!0,template:'<h4 class="webshoppage__product__name"><a href="#" ng-click="$emit(\'product-element-clicked\')">{{vm.product.name}}</a></h4>',restrict:"E",replace:!0}}Directives.webshopProductName=webshopProductName;var WebshopProductNameController=function(){function WebshopProductNameController(){}return WebshopProductNameController}();Directives.WebshopProductNameController=WebshopProductNameController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("webshopProductName",Common.Directives.webshopProductName);var Common;!function(Common){var Directives;!function(Directives){function webshopProductPriceL4($compile){return{scope:{product:"="},controller:Common.Directives.WebshopProductPriceL4Controller,controllerAs:"vm",bindToController:!0,template:'<div class="webshop__product__price-l4" ng-click="$emit(\'product-element-clicked\')">Price: {{vm.product.price}} {{vm.product.currency}}</div>',restrict:"E",replace:!0}}Directives.webshopProductPriceL4=webshopProductPriceL4;var WebshopProductPriceL4Controller=function(){function WebshopProductPriceL4Controller(){}return WebshopProductPriceL4Controller}();Directives.WebshopProductPriceL4Controller=WebshopProductPriceL4Controller}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("webshopProductPriceL4",Common.Directives.webshopProductPriceL4);var Common;!function(Common){var Directives;!function(Directives){function webshopProductPrice($compile){return{scope:{product:"="},controller:Common.Directives.WebshopProductPriceController,controllerAs:"vm",bindToController:!0,template:'<div class="webshop__product__price" ng-click="$emit(\'product-element-clicked\')">Price: {{vm.product.price}} {{vm.product.currency}}</div>',restrict:"E",replace:!0}}Directives.webshopProductPrice=webshopProductPrice;var WebshopProductPriceController=function(){function WebshopProductPriceController(){}return WebshopProductPriceController}();Directives.WebshopProductPriceController=WebshopProductPriceController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").directive("webshopProductPrice",Common.Directives.webshopProductPrice),angular.module("Common.Factories",[]),function(){"use strict";function datesCalculator(){function getYearsList(){for(var yearsList=[],i=2005;i<=moment().year();i++)yearsList.push(i);return yearsList}function getDaysNames(){for(var daysNameList=[],i=0;i<7;i++)daysNameList.push(moment().weekday(i).format("ddd"));return daysNameList}return{getYearsList:getYearsList,getDaysNames:getDaysNames}}angular.module("Common.Factories").factory("datesCalculator",datesCalculator)}();var Common;!function(Common){var Factories;!function(Factories){function translationErrorHandler(lodash){function logError(translationId,lang){}return lodash.debounce(logError,1e3)}Factories.translationErrorHandler=translationErrorHandler}(Factories=Common.Factories||(Common.Factories={}))}(Common||(Common={})),angular.module("Common.Factories").factory("translationErrorHandler",["lodash",Common.Factories.translationErrorHandler]),angular.module("Common.Filters",[]);var Common;!function(Common){var Filters;!function(Filters){function allcaps(){return function(input,scope){return input.toUpperCase()}}Filters.allcaps=allcaps}(Filters=Common.Filters||(Common.Filters={}))}(Common||(Common={})),angular.module("Common.Filters").filter("allcaps",Common.Filters.allcaps);var Common;!function(Common){var Filters;!function(Filters){function capitalize(){return function(input,scope){return null!==input&&(input=input.toLowerCase()),input.substring(0,1).toUpperCase()+input.substring(1)}}Filters.capitalize=capitalize}(Filters=Common.Filters||(Common.Filters={}))}(Common||(Common={})),angular.module("Common.Filters").filter("capitalize",Common.Filters.capitalize);var Common;!function(Common){var Filters;!function(Filters){function decodehtml($compile){return function(msg){var txt=document.createElement("textarea");return txt.innerHTML=msg,txt.value}}Filters.decodehtml=decodehtml}(Filters=Common.Filters||(Common.Filters={}))}(Common||(Common={})),angular.module("Common.Filters").filter("decodehtml",Common.Filters.decodehtml);var Common;!function(Common){var Filters;!function(Filters){function domainkeys(){return function(input){if(input){for(;input.indexOf("[123hjemmeside]")>-1;)input=input.replace("[123hjemmeside]","SimpleSite");for(;input.indexOf("[123hjemmeside.dk]")>-1;)input=input.replace("[123hjemmeside.dk]","SimpleSite.com");for(;input.indexOf("[123hjemmeside aps]")>-1;)input=input.replace("[123hjemmeside aps]",this.domainData.defaultCompanyName);for(;input.indexOf("[http://www.123hjemmeside.dk]")>-1;)input=input.replace("[http://www.123hjemmeside.dk]","https://www.simplesite.com/");for(;input.indexOf("[kundeservice@123hjemmeside.dk]")>-1;)input=input.replace("[kundeservice@123hjemmeside.dk]",this.domainData.customerSupportEmail);for(;input.indexOf("_domainname_")>-1;)input=input.replace("_domainname_",this.domainName)}return input}}Filters.domainkeys=domainkeys}(Filters=Common.Filters||(Common.Filters={}))}(Common||(Common={})),angular.module("Common.Filters").filter("domainkeys",Common.Filters.domainkeys);var Common;!function(Common){var Filters;!function(Filters){function htmlify(){return function(msg){try{msg=decodeURIComponent(escape(msg))}catch(error){}return msg}}Filters.htmlify=htmlify}(Filters=Common.Filters||(Common.Filters={}))}(Common||(Common={})),angular.module("Common.Filters").filter("htmlify",Common.Filters.htmlify);var Common;!function(Common){var Filters;!function(Filters){function internallinkforpreview(Pages){function populateInternalLinks(){for(var links=Pages.list,i=0;i<links.length;i++){var pageId=links[i].pageId,url=Pages.prettyUrl(pageId);internalLinks[url]=parseInt(pageId,10)}}var internalLinks=[],regex=/href="(.*?)"/g;return populateInternalLinks(),function(input,scope){if(null!==input)for(var match=regex.exec(input);null!==match;){var pageId=internalLinks[match[1]];pageId>0&&(input=input.replace(match[1],Pages.localUrl(pageId))),match=regex.exec(input)}return input}}Filters.internallinkforpreview=internallinkforpreview}(Filters=Common.Filters||(Common.Filters={}))}(Common||(Common={})),angular.module("Common.Filters").filter("internallinkforpreview",Common.Filters.internallinkforpreview);var Common;!function(Common){var Filters;!function(Filters){function nl2br($sce,$compile){return function(message,is_xhtml){var is_xhtml=is_xhtml||!0,breakTag=is_xhtml?"<br />":"<br>",msg="";return message&&(msg=message),msg=(msg+"").replace(/(?:\r\n|\r|\n)/g,breakTag),$sce.trustAsHtml(msg)}}Filters.nl2br=nl2br}(Filters=Common.Filters||(Common.Filters={}))}(Common||(Common={})),angular.module("Common.Filters").filter("nl2br",Common.Filters.nl2br);var Common;!function(Common){var Filters;!function(Filters){function livewebsite(User,$translate){return function(input,scope){if(null!==input){var txt=$translate.instant("HOME.LIVE_WEBSITE"),repl='<a target="_blank" href="//'+User.user.fullUrl+'">'+txt+"</a>";input=input.replace("[livewebsite]",repl)}return input}}Filters.livewebsite=livewebsite}(Filters=Common.Filters||(Common.Filters={}))}(Common||(Common={})),angular.module("Common.Filters").filter("subs_livewebsite",Common.Filters.livewebsite);var Common;!function(Common){var Filters;!function(Filters){function translatekey($translate){var regex=/\[@:(.*?)\]/g;return function(input,scope){if(null!==input)for(var match=regex.exec(input);null!==match;){var trkey=match[1],txt=$translate.instant(trkey);input=input.replace(match[0],txt),match=regex.exec(input)}return input}}Filters.translatekey=translatekey}(Filters=Common.Filters||(Common.Filters={}))}(Common||(Common={})),angular.module("Common.Filters").filter("subs_translatekey",Common.Filters.translatekey);var Common;!function(Common){var Filters;!function(Filters){function trusthtml($sce,$compile){return function(msg){return $sce.trustAsHtml(msg)}}Filters.trusthtml=trusthtml}(Filters=Common.Filters||(Common.Filters={}))}(Common||(Common={})),angular.module("Common.Filters").filter("trusthtml",Common.Filters.trusthtml);var Common;!function(Common){var ConfStrings;!function(ConfStrings){var ConfString=function(){function ConfString(act,option){this.active=act,this.key=option}return ConfString.prototype.isActive=function(){return this.active},ConfString.prototype.isOption=function(option){return this.key===option},ConfString.prototype.isBranch=function(confStringKey){return!(!this.isActive()||!this.isOption(confStringKey))},ConfString}();ConfStrings.ConfString=ConfString,ConfStrings.MyExperiment={options:["A","B","C"],check:new ConfString((!1),"Baseline")},ConfStrings.AccountMenuDeepExperiment={options:["Deep","Shallow"],check:new ConfString((!0),"Baseline")},ConfStrings.WebshopExperiment={options:["WebShop","NoWebShop"],check:new ConfString((!0),"NoWebShop")},ConfStrings.ShowEmptyElementsExperiment={options:["ShowEmpty","DontShowEmpty"],check:new ConfString((!0),"Baseline")},ConfStrings.RandomizedExperiment={options:["Randomized"],check:new ConfString((!0),"Randomized")},ConfStrings.ShowTemplatePages={options:["ShowTemplatePages","DontShowTemplatePages"],check:new ConfString((!0),"ShowTemplatePages")}}(ConfStrings=Common.ConfStrings||(Common.ConfStrings={}))}(Common||(Common={}));var Common;!function(Common){var Globals;!function(Globals){Globals.translationBusts={"/v3domainkeys.json":"12e8553636218e9711e27d2b204d08fc","/v3keys.json":"2e53c8bb659a7a993a1f1c3c6f4dffc3","/base/ar.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/base/cs.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/base/da.json":"79721b665bdd4930c8e04c0406ec09f7","/base/de.json":"f4412a4dcbbae0627d8fce8536eca46c","/base/el.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/base/en.json":"cc5263f16adc6d6ebb2752d2850c838b","/base/es.json":"ee448c116c62f44c51692e4594eb10de","/base/fi.json":"31b479cde74105c13673973286183039","/base/fr.json":"8c270b690706479b67bfd9946da27bda","/base/id.json":"2421ee373d523f9954d41ed372e94e34","/base/it.json":"0ed05e26ff3ac307f1d88662e9b5c16d","/base/ms.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/base/nb.json":"17ecccabce13b3e3a9cd1443d39fef60","/base/nl.json":"b02d4fa4691c9f831ea0ecf40d2a4090","/base/no.json":"f10123b368352cf255ebf45cd6112c9a","/base/pl.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/base/pt.json":"ad6fe5ce2358d8349423326f88864d64","/base/ru.json":"d37c414f6236fa8ea1af7d4b928db6bb","/base/sv.json":"979eddec32371b735ed9192fa935a98b","/base/tr.json":"9e18dc639a71a1b9c2594d4048528948","/domain/ar.json":"69cea5843607d392f172853906734e01","/domain/cs.json":"48e80c789edcea43b4557ecf3d14a4ec","/domain/da.json":"ff80758769e3d5215a7a02921c01d549","/domain/de.json":"f72ce3e8855e8ad001947b0c0ac6118d","/domain/el.json":"5ed3d73328a7e88ca607806703421238","/domain/en.json":"9da820ed836367259689ab744055b297","/domain/es.json":"13c1a6a340701fb7438939c5a47c3efa","/domain/fi.json":"d3843512f341b61906c40a8923d8028d","/domain/fr.json":"26776e0601d548277d099d76084deb13","/domain/id.json":"e492d7dacb50bd183dfb379d5e268588","/domain/it.json":"e4156eb1d96ff9342c0f3a1f7e94f9ab","/domain/ms.json":"00249a597d7124f413528a2151f59735","/domain/nb.json":"fb5047a62458c6e92b6f7ca1fbcd4451","/domain/nl.json":"532c3a4268fc390f7fc234282bf87e08","/domain/no.json":"fb5047a62458c6e92b6f7ca1fbcd4451","/domain/pl.json":"f18a2af899cdfb4766d1f305d0141a93","/domain/pt.json":"14de48add5e7ad5efc0056407088a534","/domain/ru.json":"e067f1fa40e65aaf27f3ed9522216357","/domain/sv.json":"233a2881652fed8c20a3baf7026ab761","/domain/tr.json":"2fd3b6b5df6e500fed592bcdb3ea2982","/domain/zh.json":"9da820ed836367259689ab744055b297","/home/ar.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/home/cs.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/home/da.json":"d154ce5d1d1e1b21bc8d1edb0baa73d1","/home/de.json":"a57e59be33b995c666f075c6bd947f54","/home/el.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/home/en.json":"a0406faaeb445f3a64953005706598fa","/home/es.json":"170df2dd497e81319067e21604a3ca29","/home/fi.json":"d2bfbf0d08ace64216e350adfe9104a5","/home/fr.json":"c448d7ab352d2a02c028e13432399773","/home/id.json":"e3491c2a95bcec500141859338a6c67d","/home/it.json":"0cfec7ae960eb29c6074cb5c7fff2730","/home/meta.json":"685da593633c16a4482df45768175170","/home/ms.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/home/nb.json":"9ccdd57cd7f706308b8ee22216f76618","/home/nl.json":"4e20dbde59b74c922711fd3b911df668","/home/no.json":"9ccdd57cd7f706308b8ee22216f76618","/home/pl.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/home/pt.json":"18bcb920f3a30d61b6577f86bd098524","/home/ru.json":"4683cb7fe8eff0ab66f497114db1fd85","/home/sv.json":"fc5ee37096a565e298967f68a8d8fc32","/home/tr.json":"8f5319aa0fd2ee25b69da05611223e77","/login/ar.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/login/cs.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/login/da.json":"ecc5dc69ac042651ab8b7fc63ccbf9bd","/login/de.json":"54973ccf8136d18767e47aad562cf40f","/login/el.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/login/en.json":"5217ce373f339c244f4798b6f27e31a4","/login/es.json":"8d850e16b90830dafcdc0a221217d660","/login/fi.json":"06ea0555bd4f382eda69b496019d0e24","/login/fr.json":"ed5d33d7a79bfbb461a7f50df6df2e28","/login/id.json":"df8bf2c608d25442e5305ab4b20c631f","/login/it.json":"e1f1ffa1734021179d9341fd80b5f515","/login/ms.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/login/nb.json":"f3cae9b08bd14304aebc2bfcf6d03dc4","/login/nl.json":"0e0626fdfa300f95dc663869a0299766","/login/pl.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/login/pt.json":"1524641232d8fc91e3ada187628c262b","/login/ru.json":"4eab43aa23e8601c47ae1bdb8f0b58e5","/login/sv.json":"853d54bd5fabe9e7f19a9aeece3ce379","/login/tr.json":"7890a7915335efd9322fb5632a44d786","/signup/ar.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/signup/cs.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/signup/da.json":"1d311e06e1bc66e422df050fc12408ad","/signup/de.json":"980b87d9ab771862eac73b01a4c4b15e","/signup/el.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/signup/en.json":"f02df9327a07491de149532574f9e16d","/signup/es.json":"d7ee2460c37456f4ed35834dd7aaf59c","/signup/fi.json":"abe4332c495272e4a70103854d59d5c0","/signup/fr.json":"2e3775df5058c4339b3b40b9c77962c9","/signup/id.json":"f41ed7d0c7bdebc08571df07dda3ed57","/signup/it.json":"ef4ef1ba0b9e76e9fecb09973bb27812","/signup/ms.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/signup/nb.json":"617699b90414dce3fef1f5467f87a225","/signup/nl.json":"0673fc76ceddfaddf4dee10459398f32","/signup/pl.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/signup/pt.json":"b358c44a984d8b3bef726f870af01e66","/signup/ru.json":"fa4a455d7aca47f8caa0c74932c1e415","/signup/sv.json":"48dcfe01ea9e2e995c418bd789bb48f9","/signup/tr.json":"1fb2ecbe298a478f4e605bd2cf8cfa8f","/subscription/ar.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/subscription/cs.json":"046a40196a9e65d03d791bc85d61c420","/subscription/da.json":"56a790fe47722752fbcee992d4dd7bd3","/subscription/de.json":"0fd8264b18d0bc11a1caa575580bfec2","/subscription/el.json":"dd1d2b95f998f51ef7060815cb59c0ca","/subscription/en.json":"3666e83875013c7d1e2e5d8444bbe4b3","/subscription/es.json":"f0434056039986c530cc2de841073474","/subscription/fi.json":"efb8d7711ae287dd196656e4884d833d","/subscription/fr.json":"f2c90cfa4b16df69fd7e53f172cc2c0f","/subscription/id.json":"ec7e85f511c7ecde311f41897d0fea04","/subscription/it.json":"3d29a75fcf0ed7dfff86d3db8f92fc69","/subscription/ms.json":"d8f800e5daf8287683eb39a1d3da70f0","/subscription/nb.json":"bdff50cdced8e3d5282059cae666abdf","/subscription/nl.json":"f42e323e1b7661c303ed3a1da69400f2","/subscription/pl.json":"7200b13be8df290e84f5de804d8ce402","/subscription/pt.json":"49eb65fced0fa831c276d63adbfdaa7b","/subscription/ru.json":"0a0d697a34ff77b8dc5a4411a74e4756","/subscription/sv.json":"b0696862d6dbde575616b8690c57a92c","/subscription/tr.json":"2d8126d78d7c13948648d27c363c3f22"}}(Globals=Common.Globals||(Common.Globals={}))}(Common||(Common={}));var Common;!function(Common){var Interfaces;!function(Interfaces){}(Interfaces=Common.Interfaces||(Common.Interfaces={}))}(Common||(Common={}));var Common;!function(Common){var Models;!function(Models){var LibraryImage=function(){function LibraryImage(name,id,tags){this.name=name,this.id=id,this.tags=tags}return LibraryImage}();Models.LibraryImage=LibraryImage}(Models=Common.Models||(Common.Models={}))}(Common||(Common={}));var Common;!function(Common){var Models;!function(Models){var MapStyle=function(){function MapStyle(styleName){switch(this.silverStyle=[{elementType:"geometry",stylers:[{color:"#f5f5f5"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f5f5"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#dadada"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#c9c9c9"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]}],this.retroStyle=[{elementType:"geometry",stylers:[{color:"#ebe3cd"}]},{elementType:"labels.text.fill",stylers:[{color:"#523735"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f1e6"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#c9b2a6"}]},{featureType:"administrative.land_parcel",elementType:"geometry.stroke",stylers:[{color:"#dcd2be"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#ae9e90"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#93817c"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#a5b076"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#447530"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#f5f1e6"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#fdfcf8"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#f8c967"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#e9bc62"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#e98d58"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.stroke",stylers:[{color:"#db8555"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#806b63"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"transit.line",elementType:"labels.text.fill",stylers:[{color:"#8f7d77"}]},{featureType:"transit.line",elementType:"labels.text.stroke",stylers:[{color:"#ebe3cd"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#b9d3c2"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#92998d"}]}],this.darkStyle=[{elementType:"geometry",stylers:[{color:"#212121"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{elementType:"labels.text.stroke",stylers:[{color:"#212121"}]},{featureType:"administrative",elementType:"geometry",stylers:[{color:"#757575"}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"administrative.land_parcel",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#181818"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"poi.park",elementType:"labels.text.stroke",stylers:[{color:"#1b1b1b"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#2c2c2c"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#8a8a8a"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#373737"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#3c3c3c"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#4e4e4e"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#000000"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#3d3d3d"}]}],this.nightStyle=[{elementType:"geometry",stylers:[{color:"#1d2c4d"}]},{elementType:"labels.text.fill",stylers:[{color:"#8ec3b9"}]},{elementType:"labels.text.stroke",stylers:[{color:"#1a3646"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#64779e"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{color:"#4b6878"}]},{featureType:"landscape.man_made",elementType:"geometry.stroke",stylers:[{color:"#334e87"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#023e58"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#283d6a"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#6f9ba5"}]},{featureType:"poi",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#023e58"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#3C7680"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#304a7d"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#2c6675"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#255763"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#b0d5ce"}]},{featureType:"road.highway",elementType:"labels.text.stroke",stylers:[{color:"#023e58"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#98a5be"}]},{featureType:"transit",elementType:"labels.text.stroke",stylers:[{color:"#1d2c4d"}]},{featureType:"transit.line",elementType:"geometry.fill",stylers:[{color:"#283d6a"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#3a4762"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#0e1626"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#4e6d70"}]}],styleName){case"Silver":return this.silverStyle;case"Retro":return this.retroStyle;case"Dark":return this.darkStyle;case"Night":return this.nightStyle;default:return null}}return MapStyle}();Models.MapStyle=MapStyle}(Models=Common.Models||(Common.Models={}))}(Common||(Common={}));var Common;!function(Common){var Models;!function(Models){var VideoBackground=function(){function VideoBackground(backgroundId,name){this.basePath="/assets/img/videobackgrounds/",this.backgroundId=backgroundId,this.name=name,this.posterUrl=this.basePath+name+".jpg",this.mp4Url=this.basePath+name+".mp4",this.webmUrl=this.basePath+name+".webm",this.gifUrl=this.basePath+name+".gif"}return VideoBackground}();Models.VideoBackground=VideoBackground}(Models=Common.Models||(Common.Models={}))}(Common||(Common={}));var Common;!function(Common){var Models;!function(Models){var GoogleMapsWrapper=function(){function GoogleMapsWrapper(m,windowId,markerId){this.google={},this.map={},this.map=m,this.windowId=windowId,this.markerId=markerId,this.setMapStyleOptions()}return GoogleMapsWrapper.prototype.openInfoWindow=function(){this.map.showInfoWindow(this.windowId,this.map.markers[this.markerId])},GoogleMapsWrapper.prototype.closeInfoWindow=function(){this.map.infoWindows&&this.map.infoWindows[this.windowId]&&this.map.infoWindows[this.windowId].close()},GoogleMapsWrapper.prototype.centerMap=function(){if(this.map.markers&&this.map.markers[this.markerId]){var position=this.map.markers[this.markerId].getPosition();this.map.setCenter(position)}},GoogleMapsWrapper.prototype.getLocation=function(){return this.map.markers&&this.map.markers[this.markerId]?this.map.markers[this.markerId].position:null},GoogleMapsWrapper.prototype.setMarkerVisible=function(val){this.map.markers&&this.map.markers[this.markerId]&&this.map.markers[this.markerId].setVisible(val)},GoogleMapsWrapper.prototype.setMapScroll=function(val){var options={scrollwheel:val};this.map.setOptions(options)},GoogleMapsWrapper.prototype.setMapDrag=function(val){var options={draggable:val};this.map.setOptions(options)},GoogleMapsWrapper.prototype.setZoom=function(val){this.map.setZoom(val)},GoogleMapsWrapper.prototype.setStreetViewControl=function(val){var options={streetViewControl:val};this.map.setOptions(options)},GoogleMapsWrapper.prototype.setZoomControl=function(val){var options={zoomControl:val};this.map.setOptions(options)},GoogleMapsWrapper.prototype.setMapTypeControl=function(val){var options={mapTypeControl:val};this.map.setOptions(options)},GoogleMapsWrapper.prototype.setMapStyleOptions=function(){if(!this.map.mapTypes.night){var options={mapTypeControlOptions:{mapTypeIds:["roadmap","satellite","hybrid","terrain","blackwhite","old","dark","night"]}};this.map.setOptions(options);for(var i in options.mapTypeControlOptions.mapTypeIds){var style=options.mapTypeControlOptions.mapTypeIds[i],styledMapType=this.getCustomMapStyle(style);styledMapType&&this.map.mapTypes.set(style,styledMapType)}}},GoogleMapsWrapper.prototype.getCustomMapStyle=function(style){var mapName="";switch(style){case"blackwhite":mapName="Silver";break;case"old":mapName="Retro";break;case"dark":mapName="Dark";break;case"night":mapName="Night";break;default:return null}var mapStyle=new Models.MapStyle(mapName);return new google.maps.StyledMapType(mapStyle,{name:mapName})},GoogleMapsWrapper.prototype.setMapStyle=function(style){this.map.setMapTypeId(style)},GoogleMapsWrapper}();Models.GoogleMapsWrapper=GoogleMapsWrapper}(Models=Common.Models||(Common.Models={}))}(Common||(Common={}));var Common;!function(Common){var Services;!function(Services){"use strict";var ActiveSection=function(){function ActiveSection(){var _this=this;this.isActive=function(sectionId){return sectionId===_this.activeSectionId}}return ActiveSection.prototype.deactivate=function(){this.activeSectionId=null},ActiveSection}();Services.ActiveSection=ActiveSection}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("ActiveSection",Common.Services.ActiveSection);var Common;!function(Common){var Services;!function(Services){"use strict";var AuthInterceptor=function(){function AuthInterceptor($q,$location){var _this=this;this.$q=$q,this.$location=$location,this.webapi_token="",this.request=function(config){if(config.headers=config.headers||{},_this.webapi_token=Cookies.get(Common.Services.CookieNames.WEBAPI_TOKEN),_this.webapi_token&&_this.webapi_token.length>1)config.headers.Authorization="Bearer "+_this.webapi_token;else{var dvt=_this.getParameterByName("dvt",null);null!=dvt&&""!=dvt&&(config.headers.Authorization="dvt "+dvt)}return config},this.response=function(config){return config},this.responseError=function(response){if(401===response.status)if(Common.Globals.USE_V3_LOGIN){var v3login=Common.Globals.ABSOLUTE_DOMAIN_URL+"/pages/service-login.aspx";window.location.href=v3login}else _this.$location.path("/login");return _this.$q.reject(response)}}return AuthInterceptor.prototype.getParameterByName=function(name,url){url||(url=window.location.href),name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);return results?results[2]?decodeURIComponent(results[2].replace(/\+/g," ")):"":null},AuthInterceptor.$inject=["$q","$location"],AuthInterceptor}();Services.AuthInterceptor=AuthInterceptor}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("AuthInterceptor",Common.Services.AuthInterceptor);var Common;!function(Common){var Services;!function(Services){"use strict";var param=function(obj){var name,value,fullSubName,subName,subValue,innerObj,i,query="";for(name in obj)if(value=obj[name],value instanceof Array)for(i=0;i<value.length;++i)subValue=value[i],fullSubName=name+"["+i+"]",innerObj={},innerObj[fullSubName]=subValue,query+=param(innerObj)+"&";else if(value instanceof Object)for(subName in value)subValue=value[subName],fullSubName=name+"["+subName+"]",innerObj={},innerObj[fullSubName]=subValue,query+=param(innerObj)+"&";else void 0!==value&&null!==value&&(query+=encodeURIComponent(name)+"="+encodeURIComponent(value)+"&");return query.length?query.substr(0,query.length-1):query},Auth=function(){function Auth($http,$q,$window,$state,User,Pages){this.$http=$http,this.$q=$q,this.$window=$window,this.$state=$state,this.User=User,this.Pages=Pages}return Auth.prototype.login=function(data){this.clearSessionData();var dataToSend={grant_type:"password",username:data.username+"/US",password:data.password},base64=btoa(Common.Globals.CLIENT_ID+":"+Common.Globals.CLIENT_SECRET),deferred=this.$q.defer();return this.$http({method:"POST",url:Common.Globals.API_PATH+"/account/login",data:param(dataToSend),headers:{Authorization:"Basic "+base64,"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(data){Cookies.set(Common.Services.CookieNames.WEBAPI_TOKEN,data.access_token,{expires:7}),deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject({status:status,error:data})}),deferred.promise},Auth.prototype.signup=function(data){data.culture="en",this.clearSessionData();var deferred=this.$q.defer();return this.$http({method:"POST",url:Common.Globals.API_PATH+"/account/signup",data:data}).success(function(data){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject({status:status,error:data})}),deferred.promise},Auth.prototype.logout=function(){var _this=this,deferred=this.$q.defer();return this.clearSessionData().then(function(){
Common.Globals.USE_V3_LOGIN?_this.$window.location.href=Common.V3Links.LOGOUT:deferred.resolve(!0)}),deferred.promise},Auth.prototype.clearSessionData=function(){var deferred=this.$q.defer(),cookiedomains=[".localdev.dk",".simplesite.com","v4.simplesite.com"];cookiedomains.push(Common.Globals.ABSOLUTE_DOMAIN_URL.substr(2));var cookiestodelte=["webapi_token","loggedin_token"];this.User.clear(),this.Pages.list=null;for(var cookieidx in cookiestodelte){var x=cookiestodelte[cookieidx];for(var cd in cookiedomains)Cookies.remove(x,{domain:cookiedomains[cd]})}return deferred.resolve(),deferred.promise},Auth.prototype.goToSignup=function(){if(Common.Globals.USE_V3_LOGIN){var url=Common.Globals.ABSOLUTE_DOMAIN_URL;this.$window.open(url,"_self")}else this.$state.go("signup")},Auth.prototype.goToLogin=function(){if(Common.Globals.USE_V3_LOGIN){var v3login=Common.Globals.ABSOLUTE_DOMAIN_URL+"/pages/service-login.aspx";this.$window.open(v3login,"_self")}else this.$state.go("login")},Auth.prototype.getToken=function(){return Cookies.get(Common.Services.CookieNames.WEBAPI_TOKEN)},Auth.$inject=["$http","$q","$window","$state","User","Pages"],Auth}();Services.Auth=Auth}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("Auth",Common.Services.Auth);var Common;!function(Common){var Services;!function(Services){"use strict";var Backgrounds=function(){function Backgrounds(lodash){this.lodash=lodash,this.backgrounds=[{id:"wedding-flowers",pro:!0},{id:"flowers-pink",pro:!0},{id:"flower-blur",pro:!0},{id:"marigolds",pro:!1},{id:"sunflower",pro:!1},{id:"grass-close",pro:!0},{id:"grass-yard",pro:!0},{id:"nature-grass2",pro:!0},{id:"nature-grass1",pro:!0},{id:"dandelion",pro:!1},{id:"rain",pro:!1},{id:"champs",pro:!1},{id:"beech-leaf",pro:!1},{id:"teaplantation",pro:!0},{id:"forest",pro:!1},{id:"mountain-pinetree",pro:!0},{id:"forest-twilight",pro:!0},{id:"fantasy",pro:!1},{id:"alps",pro:!1},{id:"earth",pro:!0},{id:"orion-nebula",pro:!1},{id:"nightsky",pro:!0},{id:"sky",pro:!1},{id:"sky-blue",pro:!0},{id:"ocean-deep",pro:!0},{id:"ocean",pro:!0},{id:"stone-on-beach",pro:!0},{id:"beach",pro:!1},{id:"sand",pro:!0},{id:"desert",pro:!0},{id:"palms-sunset",pro:!0},{id:"horse",pro:!1},{id:"bubbles",pro:!1},{id:"blur-redblack",pro:!1},{id:"blur-greenblue",pro:!1},{id:"blur-greenyellow",pro:!1},{id:"blur-orangered",pro:!1},{id:"theater",pro:!0},{id:"feathers",pro:!0},{id:"paper-crumpled-white",pro:!0},{id:"paper-crumpled-brown",pro:!0},{id:"wallpaper-white",pro:!1},{id:"yellow-fabric",pro:!1},{id:"hessian",pro:!0},{id:"wallpaper-beige",pro:!0},{id:"wallpaper-golden",pro:!0},{id:"grunge",pro:!1},{id:"concrete1",pro:!1},{id:"wooden-floor",pro:!1},{id:"wooden-planks",pro:!0},{id:"boards-brown",pro:!1},{id:"tiles-decorated",pro:!0},{id:"bricks",pro:!1},{id:"plastic",pro:!0},{id:"abstract-architecture",pro:!0},{id:"steel",pro:!1},{id:"surface-black",pro:!0},{id:"engine",pro:!1},{id:"construction-workers",pro:!0},{id:"electric",pro:!1},{id:"soundwave",pro:!1},{id:"concert",pro:!0},{id:"notes",pro:!0},{id:"painting-brushes",pro:!0},{id:"citylight",pro:!0},{id:"Manhattan",pro:!1},{id:"chalkboard-black",pro:!0},{id:"ballons",pro:!1},{id:"heart",pro:!1},{id:"babies",pro:!1},{id:"coffee",pro:!0},{id:"winestopper",pro:!1},{id:"plates",pro:!1},{id:"salad-green",pro:!0},{id:"balloon-animals",pro:!0},{id:"camera-fuzzy",pro:!0},{id:"cash-coin",pro:!0},{id:"city-from-air",pro:!0},{id:"green-hills",pro:!0},{id:"hobby-knitting",pro:!0},{id:"make-up-brushes",pro:!0},{id:"night-skyline",pro:!0},{id:"notebooks",pro:!0},{id:"peacock",pro:!0},{id:"people-party-dancing-music",pro:!0},{id:"peppers",pro:!0},{id:"power-lines-evening-sun",pro:!0},{id:"red-apartmentment-buildings",pro:!0},{id:"sea-beach-sand-sun",pro:!0},{id:"sea-city-landscape-sky",pro:!0},{id:"streetview",pro:!0},{id:"sunny-balconies",pro:!0},{id:"sunny-terrace",pro:!0},{id:"yellow-vehicle-vintage",pro:!0},{id:"xmas01",pro:!1},{id:"xmas02",pro:!1},{id:"xmas03",pro:!1}],this.patterns=[{id:"black_gradient",pro:!1,repeat:"x"},{id:"white_gradient",pro:!1,repeat:"x"},{id:"diagonal",pro:!1,repeat:"all"},{id:"figures4",pro:!0,repeat:"all"},{id:"figures1",pro:!0,repeat:"all"},{id:"leaves",pro:!1,repeat:"all"},{id:"kaleidoscope",pro:!1,repeat:"all"},{id:"ceramics",pro:!1,repeat:"all"},{id:"figures3",pro:!0,repeat:"all"},{id:"polygon",pro:!0,repeat:"all"},{id:"lines",pro:!1,repeat:"all"},{id:"princess",pro:!1,repeat:"all"},{id:"retro",pro:!1,repeat:"all"},{id:"figures2",pro:!0,repeat:"all"},{id:"kidscastle",pro:!0,repeat:"all"},{id:"snowflakes",pro:!1,repeat:"all"},{id:"tartan",pro:!1,repeat:"x"},{id:"trees",pro:!1,repeat:"x"},{id:"wallpaper4",pro:!0,repeat:"all"},{id:"crown",pro:!0,repeat:"all"},{id:"kids",pro:!1,repeat:"all"},{id:"paws",pro:!1,repeat:"all"},{id:"garden",pro:!1,repeat:"all"},{id:"fish",pro:!0,repeat:"all"},{id:"flowers2",pro:!0,repeat:"all"},{id:"roses",pro:!1,repeat:"all"},{id:"wine",pro:!1,repeat:"x"},{id:"skyline",pro:!1,repeat:"x"},{id:"wallpaper5",pro:!0,repeat:"all"},{id:"flowers3",pro:!0,repeat:"all"},{id:"bones",pro:!1,repeat:"all"},{id:"flowers5",pro:!0,repeat:"all"},{id:"gear",pro:!0,repeat:"all"},{id:"wallpaper1",pro:!0,repeat:"all"},{id:"wallpaper2",pro:!0,repeat:"all"},{id:"wallpaper3",pro:!0,repeat:"all"},{id:"flowers1",pro:!0,repeat:"all"},{id:"flowers4",pro:!0,repeat:"all"}]}return Backgrounds.prototype.getBackgroundStyles=function(backgroundImageUrl){if(null===backgroundImageUrl||void 0===backgroundImageUrl)return this._styles;if(void 0===this._styles||this._styles.backgroundImageUrl!==backgroundImageUrl)if(this._styles={backgroundImageUrl:backgroundImageUrl},backgroundImageUrl.indexOf("/pictures/")>0)this._styles.repeat="no-repeat",this._styles.size="cover";else if(backgroundImageUrl.indexOf("/patterns/")>0){var patternId=backgroundImageUrl.match(/\/patterns\/.*\/(.*)\..*/)[1],pattern=this.lodash.find(this.patterns,{id:patternId});this._styles.repeat="x"===pattern.repeat?"repeat-x":"y"===pattern.repeat?"repeat-y":"all"===pattern.repeat?"repeat":"no-repeat",this._styles.size="auto"}else this._styles.repeat="no-repeat",this._styles.size="cover";return this._styles},Backgrounds.$inject=["lodash"],Backgrounds}();Services.Backgrounds=Backgrounds}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("Backgrounds",Common.Services.Backgrounds);var Common;!function(Common){var Services;!function(Services){"use strict";Services.CookieNames={COMMENTS_INFOBOX:"comments-infobox",HINTS:"hints",SEEN_MOBILE_TOOLBAR_INTRO:"seen-mobile-toolbar-intro",WEBAPI_TOKEN:"webapi_token",HELPBOX_HISTORY:"helpbox_history",CONTACTME_INFOBOX:"contactme-infobox",SIGNEDUP_TOKEN:"signedup_token",LOGGEDIN_TOKEN:"loggedin_token",OFFERMODAL:"offerModal",CONTINUESW:"continueSW",NEW_CUSTOMER:"new_customer",EXPERIMENTS_123:"experiments_123",NEWLY_CREATED_PAGE:"newly-created-page"}}(Services=Common.Services||(Common.Services={}))}(Common||(Common={}));var Common;!function(Common){var Services;!function(Services){"use strict";var CustomerFlagsService=function(){function CustomerFlagsService($http,User,$q){this.$http=$http,this.User=User,this.$q=$q,this.API_PATH=Common.Globals.API_PATH}return CustomerFlagsService.prototype.send=function(flag){return this.$http({method:"POST",url:this.API_PATH+"/customers/"+this.User.user.customerId+"/customerflags",data:{flag:flag}})},CustomerFlagsService.prototype.hasFlag=function(flag){var deferred=this.$q.defer();return this.$http({method:"GET",url:this.API_PATH+"/customers/"+this.User.user.customerId+"/customerflags/"+flag.toLowerCase()}).then(function(response){deferred.resolve(response.data.hasFlag)})["catch"](function(err){deferred.reject(err)}),deferred.promise},CustomerFlagsService.prototype["delete"]=function(flag){return this.$http({method:"DELETE",url:this.API_PATH+"/customers/"+this.User.user.customerId+"/customerflags/"+flag.toLowerCase()})},CustomerFlagsService.$inject=["$http","User","$q"],CustomerFlagsService}();Services.CustomerFlagsService=CustomerFlagsService}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("CustomerFlagsService",Common.Services.CustomerFlagsService);var Common;!function(Common){var Services;!function(Services){"use strict";var DesignereditorAssetsService=function(){function DesignereditorAssetsService($rootScope){this.$rootScope=$rootScope,this.fontPacksArrayFull=["ds1-font1a-cyril","ds1-font1a-latin","ds1-font1b-all","ds2-font2a-all","ds2-font2b-all","ds3-font3a-latin","ds3-font3b-latin","ds4-font4a-cyril","ds4-font4a-latin","ds4-font4b-cyril","ds4-font4b-latin","font10-all","font11-all","font12-all","font13-latin","font14-latin","font15-latin","font16-all","font17-all","font18-latin","font19-latin","font20-latin","font21-latin","font22-latin","font5-all","font6-all","font7-all","font9-all"],this.fontPacksArray=["ds1-font1a-cyril","ds1-font1a-latin","ds1-font1b-all","ds2-font2b-all"],this.fontPacksArrayFree=["ds1-font1a-cyril","ds1-font1a-latin","ds1-font1b-all","ds2-font2a-all","ds2-font2b-all","ds3-font3a-latin","ds3-font3b-latin","ds4-font4a-cyril","ds4-font4a-latin","ds4-font4b-cyril","ds4-font4b-latin"],this.fontPacksArrayPro=["font10-all","font11-all","font12-all","font13-latin","font14-latin","font15-latin","font16-all","font17-all","font18-latin","font19-latin","font20-latin","font21-latin","font22-latin","font5-all","font6-all","font7-all","font9-all"],this.logosArray=[{Id:"@bullseye",LogoName:"bullseye",Name:"Bull's Eye",ClassName:"icon-bullseye",Enabled:!0,Premium:!1},{Id:"@book",LogoName:"book",Name:"Book",ClassName:"icon-book",Enabled:!0,Premium:!1},{Id:"@bolt",LogoName:"bolt",Name:"Lightning bolt",ClassName:"icon-bolt",Enabled:!0,Premium:!1},{Id:"@bolt-alt",LogoName:"bolt-alt",Name:"Lightning bolt 2",ClassName:"icon-bolt-alt",Enabled:!0,Premium:!0},{Id:"@bullhorn",LogoName:"bullhorn",Name:"Bull horn",ClassName:"icon-bullhorn",Enabled:!0,Premium:!1},{Id:"@bullhorn-alt",LogoName:"bullhorn-alt",Name:"Bull horn 2",ClassName:"icon-bullhorn-alt",Enabled:!0,Premium:!0},{Id:"@bullhorn-alt2",LogoName:"bullhorn-alt2",Name:"Bull horn 3",ClassName:"icon-bullhorn-alt2",Enabled:!0,Premium:!0},{Id:"@camera-retro",LogoName:"camera-retro",Name:"Retro camera",ClassName:"icon-camera-retro",Enabled:!0,Premium:!1},{Id:"@camera-alt",LogoName:"camera-alt",Name:"Camera",ClassName:"icon-camera-alt",Enabled:!0,Premium:!0},{Id:"@camera-alt2",LogoName:"camera-alt2",Name:"Camera 2",ClassName:"icon-camera-alt2",Enabled:!0,Premium:!0},{Id:"@cut",LogoName:"cut",Name:"Scissors",ClassName:"icon-cut",Enabled:!0,Premium:!1},{Id:"@dashboard",LogoName:"dashboard",Name:"Dashboard",ClassName:"icon-dashboard",Enabled:!0,Premium:!1},{Id:"@eye-open",LogoName:"eye-open",Name:"Eye",ClassName:"icon-eye-open",Enabled:!0,Premium:!1},{Id:"@eye-open-alt",LogoName:"eye-open-alt",Name:"Eye 2",ClassName:"icon-eye-open-alt",Enabled:!0,Premium:!0},{Id:"@gift",LogoName:"gift",Name:"Gift",ClassName:"icon-gift",Enabled:!0,Premium:!1},{Id:"@glass",LogoName:"glass",Name:"Glass",ClassName:"icon-glass",Enabled:!0,Premium:!1},{Id:"@glass-alt",LogoName:"glass-alt",Name:"Glass 2",ClassName:"icon-glass-alt",Enabled:!0,Premium:!0},{Id:"@globe",LogoName:"globe",Name:"Globe",ClassName:"icon-globe",Enabled:!0,Premium:!1},{Id:"@globe-alt",LogoName:"globe-alt",Name:"Globe 2",ClassName:"icon-globe-alt",Enabled:!0,Premium:!0},{Id:"@heart",LogoName:"heart",Name:"Love heart",ClassName:"icon-heart",Enabled:!0,Premium:!1},{Id:"@heart-alt",LogoName:"heart-alt",Name:"Love heart 2",ClassName:"icon-heart-alt",Enabled:!0,Premium:!0},{Id:"@heart-empty",LogoName:"heart-empty",Name:"Love heart 3",ClassName:"icon-heart-empty",Enabled:!0,Premium:!0},{Id:"@heart-empty-alt",LogoName:"heart-empty-alt",Name:"Love heart 4",ClassName:"icon-heart-empty-alt",Enabled:!0,Premium:!0},{Id:"@home",LogoName:"home",Name:"Home",ClassName:"icon-home",Enabled:!0,Premium:!1},{Id:"@home-alt",LogoName:"home-alt",Name:"Home 2",ClassName:"icon-home-alt",Enabled:!0,Premium:!0},{Id:"@leaf",LogoName:"leaf",Name:"Leaf",ClassName:"icon-leaf",Enabled:!0,Premium:!1},{Id:"@leaf-alt",LogoName:"leaf-alt",Name:"Leaf 2",ClassName:"icon-leaf-alt",Enabled:!0,Premium:!0},{Id:"@legal",LogoName:"legal",Name:"Gavel",ClassName:"icon-legal",Enabled:!0,Premium:!1},{Id:"@magic",LogoName:"magic",Name:"Magic wand",ClassName:"icon-magic",Enabled:!0,Premium:!1},{Id:"@music",LogoName:"music",Name:"Music",ClassName:"icon-music",Enabled:!0,Premium:!1},{Id:"@music-alt",LogoName:"music-alt",Name:"Music 2",ClassName:"icon-music-alt",Enabled:!0,Premium:!0},{Id:"@music-alt2",LogoName:"music-alt2",Name:"Music 3",ClassName:"icon-music-alt2",Enabled:!0,Premium:!0},{Id:"@plane",LogoName:"plane",Name:"Airplane",ClassName:"icon-plane",Enabled:!0,Premium:!1},{Id:"@plane-alt",LogoName:"plane-alt",Name:"Airplane 2",ClassName:"icon-plane-alt",Enabled:!0,Premium:!0},{Id:"@plane-alt2",LogoName:"plane-alt2",Name:"Airplane 3",ClassName:"icon-plane-alt2",Enabled:!0,Premium:!0},{Id:"@paper-plane",LogoName:"paper-plane",Name:"Paper airplane",ClassName:"icon-paper-plane",Enabled:!0,Premium:!0},{Id:"@paper-plane-alt",LogoName:"paper-plane-alt",Name:"Paper airplane 2",ClassName:"icon-paper-plane-alt",Enabled:!0,Premium:!0},{Id:"@pencil",LogoName:"pencil",Name:"Pencil",ClassName:"icon-pencil",Enabled:!0,Premium:!1},{Id:"@brush",LogoName:"brush",Name:"Brush",ClassName:"icon-brush",Enabled:!0,Premium:!0},{Id:"@palette",LogoName:"palette",Name:"Palette",ClassName:"icon-palette",Enabled:!0,Premium:!0},{Id:"@puzzle-piece",LogoName:"puzzle-piece",Name:"Puzzle piece",ClassName:"icon-puzzle-piece",Enabled:!0,Premium:!1},{Id:"@lightbulb",LogoName:"lightbulb",Name:"Light bulb",ClassName:"icon-lightbulb",Enabled:!0,Premium:!1},{Id:"@lightbulb-alt",LogoName:"lightbulb-alt",Name:"Light bulb 2",ClassName:"icon-lightbulb-alt",Enabled:!0,Premium:!0},{Id:"@beer",LogoName:"beer",Name:"Beer mug",ClassName:"icon-beer",Enabled:!0,Premium:!1},{Id:"@food",LogoName:"food",Name:"Food",ClassName:"icon-food",Enabled:!0,Premium:!1},{Id:"@food-alt",LogoName:"food-alt",Name:"Food 2",ClassName:"icon-food-alt",Enabled:!0,Premium:!0},{Id:"@food-alt2",LogoName:"food-alt2",Name:"Food 3",ClassName:"icon-food-alt2",Enabled:!0,Premium:!0},{Id:"@food-alt3",LogoName:"food-alt3",Name:"Food 4",ClassName:"icon-food-alt3",Enabled:!0,Premium:!0},{Id:"@coffee",LogoName:"coffee",Name:"Coffee",ClassName:"icon-coffee",Enabled:!0,Premium:!1},{Id:"@coffee-alt",LogoName:"coffee-alt",Name:"Coffee 2",ClassName:"icon-coffee-alt",Enabled:!0,Premium:!0},{Id:"@anchor",LogoName:"anchor",Name:"Anchor",ClassName:"icon-anchor",Enabled:!0,Premium:!1},{Id:"@lifebuoy",LogoName:"lifebuoy",Name:"Lifebuoy",ClassName:"icon-lifebuoy",Enabled:!0,Premium:!0},{Id:"@bell",LogoName:"bell",Name:"Bell",ClassName:"icon-bell",Enabled:!0,Premium:!0},{Id:"@cloud",LogoName:"cloud",Name:"Cloud",ClassName:"icon-cloud",Enabled:!0,Premium:!1},{Id:"@cloud-alt",LogoName:"cloud-alt",Name:"Cloud 2",ClassName:"icon-cloud-alt",Enabled:!0,Premium:!0},{Id:"@cloud-alt2",LogoName:"cloud-alt2",Name:"Cloud 3",ClassName:"icon-cloud-alt2",Enabled:!0,Premium:!0},{Id:"@compass",LogoName:"compass",Name:"Compass",ClassName:"icon-compass",Enabled:!0,Premium:!1},{Id:"@key",LogoName:"key",Name:"Key",ClassName:"icon-key",Enabled:!0,Premium:!1},{Id:"@key-alt",LogoName:"key-alt",Name:"Key 2",ClassName:"icon-key-alt",Enabled:!0,Premium:!0},{Id:"@key-alt2",LogoName:"key-alt2",Name:"Key 3",ClassName:"icon-key-alt2",Enabled:!0,Premium:!0},{Id:"@flag",LogoName:"flag",Name:"Flag",ClassName:"icon-flag",Enabled:!0,Premium:!1},{Id:"@flag-alt",LogoName:"flag-alt",Name:"Flag 2",ClassName:"icon-flag-alt",Enabled:!0,Premium:!0},{Id:"@headphones",LogoName:"headphones",Name:"Headphones",ClassName:"icon-headphones",Enabled:!0,Premium:!1},{Id:"@sound",LogoName:"sound",Name:"Speaker",ClassName:"icon-sound",Enabled:!0,Premium:!0},{Id:"@gamepad",LogoName:"gamepad",Name:"Gamepad",ClassName:"icon-gamepad",Enabled:!0,Premium:!1},{Id:"@microphone",LogoName:"microphone",Name:"Microphone",ClassName:"icon-microphone",Enabled:!0,Premium:!1},{Id:"@rocket",LogoName:"rocket",Name:"Rocket",ClassName:"icon-rocket",Enabled:!0,Premium:!1},{Id:"@truck",LogoName:"truck",Name:"Truck",ClassName:"icon-truck",Enabled:!0,Premium:!1},{Id:"@truck-alt",LogoName:"truck-alt",Name:"Truck 2",ClassName:"icon-truck-alt",Enabled:!0,Premium:!0},{Id:"@bicycle",LogoName:"bicycle",Name:"Bicycle",ClassName:"icon-bicycle",Enabled:!0,Premium:!0},{Id:"@ferry",LogoName:"ferry",Name:"Ferry boat",ClassName:"icon-ferry",Enabled:!0,Premium:!0},{Id:"@cogs",LogoName:"cogs",Name:"Cogs",ClassName:"icon-cogs",Enabled:!0,Premium:!1},{Id:"@cog",LogoName:"cog",Name:"Cog",ClassName:"icon-cog",Enabled:!0,Premium:!0},{Id:"@wrench",LogoName:"wrench",Name:"Wrench",ClassName:"icon-wrench",Enabled:!0,Premium:!1},{Id:"@tools",LogoName:"tools",Name:"Tools",ClassName:"icon-tools",Enabled:!0,Premium:!0},{Id:"@params",LogoName:"params",Name:"Sliders",ClassName:"icon-params",Enabled:!0,Premium:!0},{Id:"@laptop",LogoName:"laptop",Name:"Laptop",ClassName:"icon-laptop",Enabled:!0,Premium:!1},{Id:"@desktop",LogoName:"desktop",Name:"Desktop",ClassName:"icon-desktop",Enabled:!0,Premium:!0},{Id:"@mouse",LogoName:"mouse",Name:"Computer mouse",ClassName:"icon-mouse",Enabled:!0,Premium:!0},{Id:"@mobile",LogoName:"mobile",Name:"Mobile phone",ClassName:"icon-mobile",Enabled:!0,Premium:!0},{Id:"@tv",LogoName:"tv",Name:"TV",ClassName:"icon-tv",Enabled:!0,Premium:!0},{Id:"@cd",LogoName:"cd",Name:"Compact disc",ClassName:"icon-cd",Enabled:!0,Premium:!0},{Id:"@suitcase",LogoName:"suitcase",Name:"Suitcase",ClassName:"icon-suitcase",Enabled:!0,Premium:!1},{Id:"@paper-clip",LogoName:"paper-clip",Name:"Paper clip",ClassName:"icon-paper-clip",Enabled:!0,Premium:!1},{Id:"@paper-clip-alt",LogoName:"paper-clip-alt",Name:"Paper clip 2",ClassName:"icon-paper-clip-alt",Enabled:!0,Premium:!0},{Id:"@moon",LogoName:"moon",Name:"Moon",ClassName:"icon-moon",Enabled:!0,Premium:!1},{Id:"@moon-alt",LogoName:"moon-alt",Name:"Moon 2",ClassName:"icon-moon-alt",Enabled:!0,Premium:!0},{Id:"@star",LogoName:"star",Name:"Star",ClassName:"icon-star",Enabled:!0,Premium:!1},{Id:"@star-empty",LogoName:"star-empty",Name:"Star 2",ClassName:"icon-star-empty",Enabled:!0,Premium:!0},{Id:"@star-empty-alt",LogoName:"star-empty-alt",Name:"Star 3",ClassName:"icon-star-empty-alt",Enabled:!0,Premium:!0},{Id:"@signal",LogoName:"signal",Name:"Signal",ClassName:"icon-signal",Enabled:!0,Premium:!1},{Id:"@screenshot",LogoName:"screenshot",Name:"Crosshair",ClassName:"icon-screenshot",Enabled:!0,Premium:!1},{Id:"@screenshot-alt",LogoName:"screenshot-alt",Name:"Crosshair 2",ClassName:"icon-screenshot-alt",Enabled:!0,Premium:!0},{Id:"@thumbs-up",LogoName:"thumbs-up",Name:"Thumbs up",ClassName:"icon-thumbs-up",Enabled:!0,Premium:!1},{Id:"@thumbs-up-alt",LogoName:"thumbs-up-alt",Name:"Thumbs up 2",ClassName:"icon-thumbs-up-alt",Enabled:!0,Premium:!0},{Id:"@thumbs-up-alt2",LogoName:"thumbs-up-alt2",Name:"Thumbs up 3",ClassName:"icon-thumbs-up-alt2",Enabled:!0,Premium:!0},{Id:"@thumbs-down",LogoName:"thumbs-down",Name:"Thumbs down",ClassName:"icon-thumbs-down",Enabled:!0,Premium:!0},{Id:"@bug",LogoName:"bug",Name:"Bug",ClassName:"icon-bug",Enabled:!0,Premium:!1},{Id:"@smile",LogoName:"smile",Name:"Smile",ClassName:"icon-smile",Enabled:!0,Premium:!1},{Id:"@shield",LogoName:"shield",Name:"Shield",ClassName:"icon-shield",Enabled:!0,Premium:!1},{Id:"@film",LogoName:"film",Name:"Film",ClassName:"icon-film",Enabled:!0,Premium:!1},{Id:"@cinema",LogoName:"cinema",Name:"Cinema",ClassName:"icon-cinema",Enabled:!0,Premium:!0},{Id:"@school",LogoName:"school",Name:"School",ClassName:"icon-school",Enabled:!0,Premium:!0},{Id:"@college",LogoName:"college",Name:"College 1",ClassName:"icon-college",Enabled:!0,Premium:!0},{Id:"@college-alt",LogoName:"college-alt",Name:"College 2",ClassName:"icon-college-alt",Enabled:!0,Premium:!0},{Id:"@college-alt2",LogoName:"college-alt2",Name:"College 3",ClassName:"icon-college-alt2",Enabled:!0,Premium:!0},{Id:"@town-hall",LogoName:"town-hall",Name:"Town hall",ClassName:"icon-town-hall",Enabled:!0,Premium:!0},{Id:"@fire-station",LogoName:"fire-station",Name:"Fire station",ClassName:"icon-fire-station",Enabled:!0,Premium:!0},{Id:"@hospital",LogoName:"hospital",Name:"Hospital",ClassName:"icon-hospital",Enabled:!0,Premium:!0},{Id:"@industrial-building",LogoName:"industrial-building",Name:"Industrial building",ClassName:"icon-industrial-building",Enabled:!0,Premium:!0},{Id:"@library",LogoName:"library",Name:"Library",ClassName:"icon-library",Enabled:!0,Premium:!0},{Id:"@fuel",LogoName:"fuel",Name:"Fuel",ClassName:"icon-fuel",Enabled:!0,Premium:!0},{Id:"@lodging",LogoName:"lodging",Name:"Lodging",ClassName:"icon-lodging",Enabled:!0,Premium:!0},{Id:"@theatre",LogoName:"theatre",Name:"Theatre",ClassName:"icon-theatre",Enabled:!0,Premium:!0},{Id:"@garden",LogoName:"garden",Name:"Garden",ClassName:"icon-garden",Enabled:!0,Premium:!0},{Id:"@giraffe",LogoName:"giraffe",Name:"Giraffe",ClassName:"icon-giraffe",Enabled:!0,Premium:!0},{Id:"@religious-christian",LogoName:"religious-christian",Name:"Religious (Christian)",ClassName:"icon-religious-christian",Enabled:!0,Premium:!0},{Id:"@religious-islam",LogoName:"religious-islam",Name:"Religious (Islam)",ClassName:"icon-religious-islam",Enabled:!0,Premium:!0},{Id:"@religious-jewish",LogoName:"religious-jewish",Name:"Religious (Jewish)",ClassName:"icon-religious-jewish",Enabled:!0,Premium:!0},{Id:"@search",LogoName:"search",Name:"Magnify glass",ClassName:"icon-search",Enabled:!0,Premium:!0},{Id:"@search-alt",LogoName:"search-alt",Name:"Magnify glass 2",ClassName:"icon-search-alt",Enabled:!0,Premium:!0},{Id:"@envelope-alt",LogoName:"envelope-alt",Name:"Envelope",ClassName:"icon-envelope-alt",Enabled:!0,Premium:!0},{Id:"@envelope-alt2",LogoName:"envelope-alt2",Name:"Envelope 2",ClassName:"icon-envelope-alt2",Enabled:!0,Premium:!0},{Id:"@vcard",LogoName:"vcard",Name:"V Card",ClassName:"icon-vcard",Enabled:!0,Premium:!0},{Id:"@address",LogoName:"address",Name:"Address",ClassName:"icon-address",Enabled:!0,Premium:!0},{Id:"@picture-alt",LogoName:"picture-alt",Name:"Picture",ClassName:"icon-picture-alt",Enabled:!0,Premium:!0},{Id:"@picture-alt2",LogoName:"picture-alt2",Name:"Picture 2",ClassName:"icon-picture-alt2",Enabled:!0,Premium:!0},{Id:"@tag",LogoName:"tag",Name:"Tag",ClassName:"icon-tag",Enabled:!0,Premium:!0},{Id:"@tag-alt",LogoName:"tag-alt",Name:"Tag 2",ClassName:"icon-tag-alt",Enabled:!0,Premium:!0},{Id:"@quote",LogoName:"quote",Name:"Quote",ClassName:"icon-quote",Enabled:!0,Premium:!0},{Id:"@comment-alt",LogoName:"comment-alt",Name:"Comment",ClassName:"icon-comment-alt",Enabled:!0,Premium:!0},{Id:"@comment-alt2",LogoName:"comment-alt2",Name:"Comment 2",ClassName:"icon-comment-alt2",Enabled:!0,Premium:!0},{Id:"@chat",LogoName:"chat",Name:"Chat",ClassName:"icon-chat",Enabled:!0,Premium:!0},{Id:"@location",LogoName:"location",Name:"Location",ClassName:"icon-location",Enabled:!0,Premium:!0},{Id:"@location-alt",LogoName:"location-alt",Name:"Location 2",ClassName:"icon-location-alt",Enabled:!0,Premium:!0},{Id:"@clock",LogoName:"clock",Name:"Clock",ClassName:"icon-clock",Enabled:!0,Premium:!0},{Id:"@clock-alt",LogoName:"clock-alt",Name:"Watch",ClassName:"icon-clock-alt",Enabled:!0,Premium:!0},{Id:"@infinity",LogoName:"infinity",Name:"Infinity",ClassName:"icon-infinity",Enabled:!0,Premium:!0},{Id:"@chart-line",LogoName:"chart-line",Name:"Chart line",ClassName:"icon-chart-line",Enabled:!0,Premium:!0},{Id:"@bucket",LogoName:"bucket",Name:"Bucket",ClassName:"icon-bucket",Enabled:!0,Premium:!0},{Id:"@trash",LogoName:"trash",Name:"Trash can",ClassName:"icon-trash",Enabled:!0,Premium:!0},{Id:"@ticket",LogoName:"ticket",Name:"Ticket",ClassName:"icon-ticket",Enabled:!0,Premium:!0},{Id:"@basketball",LogoName:"basketball",Name:"Basketball",ClassName:"icon-basketball",Enabled:!0,Premium:!0},{Id:"@baseball",LogoName:"baseball",Name:"Baseball",ClassName:"icon-baseball",Enabled:!0,Premium:!0},{Id:"@cricket",LogoName:"cricket",Name:"Cricket",ClassName:"icon-cricket",Enabled:!0,Premium:!0},{Id:"@football",LogoName:"football",Name:"Football",ClassName:"icon-football",Enabled:!0,Premium:!0},{Id:"@golf",LogoName:"golf",Name:"Golf",ClassName:"icon-golf",Enabled:!0,Premium:!0},{Id:"@pitch",LogoName:"pitch",Name:"Pitch",ClassName:"icon-pitch",Enabled:!0,Premium:!0},{Id:"@soccer",LogoName:"soccer",Name:"Soccer",ClassName:"icon-soccer",Enabled:!0,Premium:!0},{Id:"@swimming",LogoName:"swimming",Name:"Swimming",ClassName:"icon-swimming",Enabled:!0,Premium:!0},{Id:"@skiing",LogoName:"skiing",Name:"Skiing",ClassName:"icon-skiing",Enabled:!0,Premium:!0},{Id:"@tennis",LogoName:"tennis",Name:"Tennis",ClassName:"icon-tennis",Enabled:!0,Premium:!0},{Id:"@tree",LogoName:"tree",Name:"Tree",ClassName:"icon-tree",Enabled:!0,Premium:!0},{Id:"@tree-alt",LogoName:"tree-alt",Name:"Tree 2",ClassName:"icon-tree-alt",Enabled:!0,Premium:!0},{Id:"@newspaper",LogoName:"newspaper",Name:"Newspaper",ClassName:"icon-newspaper",Enabled:!0,Premium:!0},{Id:"@minefield",LogoName:"minefield",Name:"Minefield",ClassName:"icon-minefield",Enabled:!0,Premium:!0},{Id:"@t-shirt",LogoName:"t-shirt",Name:"T-shirt",ClassName:"icon-t-shirt",Enabled:!0,Premium:!0},{Id:"@diamond",LogoName:"diamond",Name:"Diamond",ClassName:"icon-diamond",Enabled:!0,Premium:!0},{Id:"@fire",LogoName:"fire",Name:"Fire",ClassName:"icon-fire",Enabled:!0,Premium:!0},{Id:"@beaker",LogoName:"beaker",Name:"Beaker",ClassName:"icon-beaker",Enabled:!0,Premium:!0},{Id:"@database",LogoName:"database",Name:"Database",ClassName:"icon-database",Enabled:!0,Premium:!0},{Id:"@money",LogoName:"money",Name:"Money",ClassName:"icon-money",Enabled:!0,Premium:!0},{Id:"@credit-card",LogoName:"credit-card",Name:"Credit card",ClassName:"icon-credit-card",Enabled:!0,Premium:!0},{Id:"@map",LogoName:"map",Name:"Map",ClassName:"icon-map",Enabled:!0,Premium:!0},{Id:"@sun",LogoName:"sun",Name:"Sun",ClassName:"icon-sun",Enabled:!0,Premium:!0},{Id:"@trophy",LogoName:"trophy",Name:"Trophy",ClassName:"icon-trophy",Enabled:!0,Premium:!0},{Id:"@flashlight",LogoName:"flashlight",Name:"Flashlight",ClassName:"icon-flashlight",Enabled:!0,Premium:!0},{Id:"@heliport",LogoName:"heliport",Name:"Heliport",ClassName:"icon-heliport",Enabled:!0,Premium:!0}]}return DesignereditorAssetsService.$inject=["$rootScope"],DesignereditorAssetsService}();Services.DesignereditorAssetsService=DesignereditorAssetsService}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("DesignereditorAssetsService",Common.Services.DesignereditorAssetsService);var Common;!function(Common){var Services;!function(Services){"use strict";var Dialog=function(){function Dialog($translate,$window,$q){this.$translate=$translate,this.$window=$window,this.$q=$q}return Dialog.prototype.showPrompt=function(placeholder,title,callback){var _this=this,promises=[];title&&promises.push(this.$translate(title)),placeholder&&promises.push(this.$translate(placeholder)),this.$q.all(promises).then(function(data){var newPageTitle=(_a=_this.$window).prompt.apply(_a,data);newPageTitle&&callback(newPageTitle);var _a})},Dialog.prototype.showConfirm=function(message,callback){var _this=this;this.$translate.apply(this,message).then(function(message_translated){callback(_this.$window.confirm(message_translated))})},Dialog.$inject=["$translate","$window","$q"],Dialog}();Services.Dialog=Dialog}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("Dialog",Common.Services.Dialog);var Common;!function(Common){var Services;!function(Services){"use strict";var DomainUserAPI=function(){function DomainUserAPI($http,$q){this.$http=$http,this.$q=$q}return DomainUserAPI.prototype.getDomainUser=function(customerId){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/domain/"+customerId}).success(function(domainUser){deferred.resolve(domainUser)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},DomainUserAPI.prototype.validateDomainForm=function(customerId,domainRegistrationData){var deferred=this.$q.defer();return this.$http({method:"POST",url:Common.Globals.API_PATH+"/domainformverification/",data:{customerId:customerId,domainRegistrationData:domainRegistrationData}}).success(function(domainVerificationResults){deferred.resolve(domainVerificationResults)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},DomainUserAPI.prototype.confirmDomainForm=function(customerId,domainRegistrationData,token){var deferred=this.$q.defer();return this.$http({method:"POST",url:Common.Globals.API_PATH+"/domainconfirm/",data:{customerId:customerId,domainRegistrationData:domainRegistrationData,token:token}}).success(function(orderSent){deferred.resolve(orderSent)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},DomainUserAPI.prototype.getDomainOptions=function(customerId,domainUrl,tldName,country,isPersonal,isFiBasedOnPersonalName){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/domainoptions/?customerId="+customerId+"&domainUrl="+domainUrl+"&tldName="+tldName+"&country="+country+"&isPersonal="+isPersonal+"&isFiBasedOnPersonalName="+isFiBasedOnPersonalName}).success(function(domainOptions){deferred.resolve(domainOptions)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},DomainUserAPI.prototype.checkDomain=function(customerId,domainUrl,tldName){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/domainname?customerId="+customerId+"&domainUrl="+domainUrl+"&tldName="+tldName}).success(function(isAvailable){deferred.resolve(isAvailable)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},DomainUserAPI.prototype.checkToken=function(token){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/domaintoken?token="+token}).success(function(domainInit){deferred.resolve(domainInit)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},DomainUserAPI.$inject=["$http","$q"],DomainUserAPI}();Services.DomainUserAPI=DomainUserAPI}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("DomainUserAPI",Common.Services.DomainUserAPI);var Common;!function(Common){var Services;!function(Services){"use strict";var DomainVerification=function(){function DomainVerification($q,DomainUserAPI){this.$q=$q,this.DomainUserAPI=DomainUserAPI}return DomainVerification.prototype.checkToken=function(token){var deferred=this.$q.defer();return this.DomainUserAPI.checkToken(token).then(function(domainInit){if(!domainInit)throw new Error("Domaininit failed: domain user is null");if(!domainInit.isValid)throw new Error("Domaininit failed: token invalid");deferred.resolve(domainInit)})["catch"](function(status){deferred.reject(status)}),deferred.promise},DomainVerification.prototype.getDomainUser=function(customerId){var deferred=this.$q.defer();return this.DomainUserAPI.getDomainUser(customerId).then(function(domainUser){if(!domainUser)throw new Error("User.getDomainUser(): domain user is null");deferred.resolve(domainUser)})["catch"](function(status){deferred.reject(status)}),deferred.promise},DomainVerification.prototype.ValidateDomainForm=function(customerId,domainVerificationData){var deferred=this.$q.defer();return this.DomainUserAPI.validateDomainForm(customerId,domainVerificationData).then(function(domainVerificationResult){if(!domainVerificationResult)throw new Error("domainVerificationResult(): domain verification is null");deferred.resolve(domainVerificationResult)})["catch"](function(status){deferred.reject(status)}),deferred.promise},DomainVerification.prototype.confirmDomainForm=function(customerId,domainVerificationData,token){
var deferred=this.$q.defer();return this.DomainUserAPI.confirmDomainForm(customerId,domainVerificationData,token).then(function(orderSent){deferred.resolve(orderSent)})["catch"](function(status){deferred.reject(status)}),deferred.promise},DomainVerification.prototype.getDomainOptions=function(customerId,domainUrl,tldName,country,isPersonal,isFiBasedOnPersonalName){var deferred=this.$q.defer();return this.DomainUserAPI.getDomainOptions(customerId,domainUrl,tldName,country,isPersonal,isFiBasedOnPersonalName).then(function(domainOptions){if(!domainOptions)throw new Error("User.getDomainOptions(): domainOptions is null");deferred.resolve(domainOptions)})["catch"](function(status){deferred.reject(status)}),deferred.promise},DomainVerification.prototype.checkDomain=function(customerId,domainUrl,tldName){var deferred=this.$q.defer();return this.DomainUserAPI.checkDomain(customerId,domainUrl,tldName).then(function(isAvailable){deferred.resolve(isAvailable)})["catch"](function(status){deferred.reject(status)}),deferred.promise},DomainVerification.$inject=["$q","DomainUserAPI"],DomainVerification}();Services.DomainVerification=DomainVerification}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("DomainVerification",Common.Services.DomainVerification);var Common;!function(Common){var Services;!function(Services){"use strict";var EnvironmentService=function(){function EnvironmentService(screenSize,$window){var _this=this;this.screenSize=screenSize,this.$window=$window,this.getPlatform=function(){return navigator.platform},this.getOsVersion=function(){var version,match=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),osVersion=null;return void 0!==match&&null!==match&&match.length>2&&(version=[parseInt(match[1],10),parseInt(match[2],10)],osVersion=parseFloat(version.join("."))),osVersion},this.iOs9Check=function(){return"iphone"==_this.platform.toLowerCase()&&_this.osVersion<10},this.isIE10=function(){return _this.userAgent.indexOf("MSIE ")>0},this.isIE11=function(){return _this.userAgent.indexOf("Trident/")>0},this.isEdge=function(){return _this.userAgent.indexOf("Edge/")>0},this.isIE=function(){return _this.isIE10()||_this.isIE11()||_this.isEdge()},this.isMobile=screenSize.is("xs, sm"),this.platform=this.getPlatform(),this.osVersion=this.getOsVersion(),this.iOs9OrSmaller=this.iOs9Check(),this.userAgent=window.navigator.userAgent,$window.onresize=function(){clearTimeout(_this.resizeTimer),_this.resizeTimer=setTimeout(_this.isMobile=screenSize.is("xs, sm"),1e3)}}return EnvironmentService.$inject=["screenSize","$window"],EnvironmentService}();Services.EnvironmentService=EnvironmentService,angular.module("Common.Services").service("EnvironmentService",Common.Services.EnvironmentService)}(Services=Common.Services||(Common.Services={}))}(Common||(Common={}));var Common;!function(Common){var Services;!function(Services){"use strict";var ErrorInterceptor=function(){function ErrorInterceptor($q,lodash){var _this=this;this.$q=$q,this.lodash=lodash,this.ignoreList=[{method:"POST",urlRegex:".*/pages_photoalbum/.*/images"},{method:"POST",urlRegex:".*/pages_standardpage/.*/sections_externalvideo"}],this.request=function(config){return config},this.response=function(config){return config},this.responseError=function(response){if(400===response.status){_this.lodash.find(_this.ignoreList,function(e){var methodMatches=e.method===response.config.method;if(e.urlContains){var urlContains=response.config.url.indexOf(e.urlContains)>-1;if(methodMatches&&urlContains)return!0}if(e.urlRegex){var regexMatches=response.config.url.match(e.urlRegex);if(methodMatches&&regexMatches)return!0}return!1})}return _this.$q.reject(response)}}return ErrorInterceptor.$inject=["$q","lodash"],ErrorInterceptor}();Services.ErrorInterceptor=ErrorInterceptor}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("ErrorInterceptor",Common.Services.ErrorInterceptor);var Common;!function(Common){var Services;!function(Services){"use strict";var ErrorsService=function(){function ErrorsService($http,$q,$timeout){this.$http=$http,this.$q=$q,this.$timeout=$timeout,this.API_PATH=Common.Globals.API_PATH,this.ignore=!1,this.waitTime=500,this.waitTimeFactor=3}return ErrorsService.prototype.sendThrottled=function(error,description){var _this=this;this.ignore||(this.ignore=!0,this.$timeout(function(){_this.ignore=!1},this.waitTime),this.waitTime=this.waitTime*this.waitTimeFactor,this.send(error,description))},ErrorsService.prototype.send=function(error,description){return this.$http({method:"POST",url:this.API_PATH+"/errors",data:{error:"FE:"+error,description:description}})},ErrorsService.$inject=["$http","$q","$timeout"],ErrorsService}();Services.ErrorsService=ErrorsService}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("ErrorsService",Common.Services.ErrorsService);var Common;!function(Common){var Services;!function(Services){"use strict";var ExperimentsApi=function(){function ExperimentsApi($http,User){this.$http=$http,this.User=User}return ExperimentsApi.prototype.getTrack=function(experimentId,customerId,experimentData){return this.$http({method:"POST",url:this.getUrl(customerId,experimentId)+"/track",data:experimentData||{}})},ExperimentsApi.prototype.getUrl=function(customerId,experimentId){return Common.Globals.API_PATH+"/customers/"+customerId+"/experiments/"+experimentId.toLowerCase()},ExperimentsApi.$inject=["$http","User"],ExperimentsApi}();Services.ExperimentsApi=ExperimentsApi}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("ExperimentsApi",Common.Services.ExperimentsApi);var Common;!function(Common){var Services;!function(Services){"use strict";Services.ExperimentId={HELPBOX:"v4helpbox",NEW_TEMPLATES:"v4templates",NEW_LAYOUTS:"v4additionallayouts",LAYOUT4:"newlayoutsexperiment",UPGRADE_TO_PAGELIST:"v4upgradeprotoppagelist",ADD_PAGE_REMOVE:"v4addpagemorevisiblev2",SALES_PITCH9:"v4salespitchbarv9",BOTTOM_BANNER:"bottomviralbanner",NEW_EDITOR:"hasseenneweditor45",TEMPLATES:"templatesexperiment",BETTER_DOMAIN_MOBILE:"v4betterdomainpitchsignupmobile",NOTIFICATIONS:"v4notifications",BEACONS:"v4beacononboarding",PHOTO_API_SEARCH:"v4photoapisearch"};var Experiments=function(){function Experiments($http,$q,$window,$location,User,ExperimentsApi,lodash){this.$http=$http,this.$q=$q,this.$window=$window,this.$location=$location,this.User=User,this.ExperimentsApi=ExperimentsApi,this.lodash=lodash,this.API_PATH=Common.Globals.API_PATH,this.experimentsNotTracked=[Services.ExperimentId.NEW_EDITOR]}return Experiments.prototype.getTrack=function(experimentId,experimentData,forceTrack){var _this=this,deferred=this.$q.defer();if(forceTrack)return deferred.resolve(forceTrack),deferred.promise;var customerId=this.User.user.customerId,track=this.getTrackFromCookie(experimentId,customerId);if(null!==track)deferred.resolve(track);else{var expData=this.getDefaultExperimentData();experimentData=experimentData||{},experimentData.customAttributes=experimentData.customAttributes||{},angular.extend(experimentData.customAttributes,expData),this.ExperimentsApi.getTrack(experimentId,customerId,experimentData).success(function(data){var track=data.track,trackExperimentInCookie=_this.experimentsNotTracked.indexOf(experimentId)==-1;trackExperimentInCookie&&_this.setTrackInCookie(experimentId,customerId,track),deferred.resolve(track)}).error(function(data,status,headers,config){deferred.reject(status)})}return deferred.promise},Experiments.prototype.getDefaultExperimentData=function(){var data={userAgent:this.$window.navigator&&this.$window.navigator.userAgent?this.$window.navigator.userAgent:"UNKNOWN",url:this.$location.absUrl()};return data},Experiments.prototype.getTrackFromCookie=function(experimentId,customerId){var cookieKey=this.getCookieKey(customerId),cookie=Cookies.getJSON(cookieKey);if(void 0===cookie)return null;var trackRecord=this.lodash.find(cookie,{experimentId:experimentId});return null===trackRecord||void 0===trackRecord?null:trackRecord.track},Experiments.prototype.setTrackInCookie=function(experimentId,customerId,track){var cookieKey=this.getCookieKey(customerId),cookie=Cookies.getJSON(cookieKey);void 0===cookie&&(cookie=[]);var trackRecord=this.lodash.find(cookie,{experimentId:experimentId});void 0===trackRecord?(trackRecord={experimentId:experimentId,track:track},cookie.push(trackRecord)):trackRecord.track=track,Cookies.set(cookieKey,JSON.stringify(cookie))},Experiments.prototype.getCookieKey=function(customerId){var cookieKey="experiments_"+customerId;return cookieKey},Experiments.$inject=["$http","$q","$window","$location","User","ExperimentsApi","lodash"],Experiments}();Services.Experiments=Experiments}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("Experiments",Common.Services.Experiments);var Common;!function(Common){var Services;!function(Services){"use strict";var FacebookPixelService=function(){function FacebookPixelService(){this._isInit=!1}return Object.defineProperty(FacebookPixelService.prototype,"isInit",{get:function(){return this._isInit},enumerable:!0,configurable:!0}),FacebookPixelService.prototype.init=function(facebookPixelId){if(!this.isInit){var script_tag=document.createElement("script");script_tag.type="text/javascript",script_tag.text="!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod? n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n; n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0; t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window, document,'script','https://connect.facebook.net/en_US/fbevents.js'); fbq('init', '"+facebookPixelId+"'); fbq('track', 'PageView');",document.getElementsByTagName("head")[0].appendChild(script_tag),this._isInit=!0}},FacebookPixelService.$inject=[],FacebookPixelService}();Services.FacebookPixelService=FacebookPixelService}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("FacebookPixelService",Common.Services.FacebookPixelService);var Common;!function(Common){var Services;!function(Services){"use strict";var GoogleMaps=function(){function GoogleMaps(Site,$q){this.Site=Site,this.$q=$q,this.isInit=!1}return GoogleMaps.prototype.init=function(){var _this=this,deferred=this.$q.defer();return this.isInit?(deferred.resolve(!0),deferred.promise):(this.Site.getGoogleMapScript().then(function(script){if(!_this.isInit){var script_tag=document.createElement("script");script_tag.type="text/javascript",script_tag.text=script;var body=document.getElementsByTagName("body")[0];body.appendChild(script_tag),_this.isInit=!0}deferred.resolve(!0)},function(err){$.getScript("//maps.googleapis.com/maps/api/js?libraries=places").done(function(script,textStatus){_this.isInit=!0,deferred.resolve(!0)})}),deferred.promise)},GoogleMaps.$inject=["Site","$q"],GoogleMaps}();Services.GoogleMaps=GoogleMaps}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("GoogleMaps",Common.Services.GoogleMaps);var Common;!function(Common){var Services;!function(Services){"use strict";var GTM=function(){function GTM(){this._isInit=!1}return Object.defineProperty(GTM.prototype,"isInit",{get:function(){return this._isInit},enumerable:!0,configurable:!0}),GTM.prototype.setDataLayer=function(dataLayer){window.dataLayer=dataLayer},GTM.prototype.init=function(GTM_container_ID){if(!this.isInit){var script_tag=document.createElement("script");script_tag.type="text/javascript",script_tag.text="(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','"+GTM_container_ID+"');";document.getElementsByTagName("body")[0];document.getElementsByTagName("body")[0].insertBefore(script_tag,document.getElementById("main-controller")),this._isInit=!0}},GTM.$inject=[],GTM}();Services.GTM=GTM}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("GTM",Common.Services.GTM);var Common;!function(Common){var Services;!function(Services){"use strict";var headersettings=function(){function headersettings(Site,User,lodash,$q){this.Site=Site,this.User=User,this.lodash=lodash,this.$q=$q,this.originalSettings={},"layout4"==Site.current.design&&this.loadHeader()}return headersettings.prototype.storeSetting=function(s){var arr=[];return this.User.user.site.header&&(arr=this.lodash.remove(this.User.user.site.header.settings,function(value){return value.key!=s.key})),s.value&&arr.push(s),this.User.user.site.header&&(this.User.user.site.header.settings=arr),this.storeSettings(arr)},headersettings.prototype.storeSettings=function(arr){return this.Site.update({header:{type:this.User.user.site.header?this.User.user.site.header.type:"None",settings:arr}})},headersettings.prototype.storeCurrentSetting=function(){var _this=this,deferred=this.$q.defer();if(this.currentsetting){var arr=[];Object.keys(this.currentsetting).forEach(function(key){var val=_this.currentsetting[key];arr.push({key:key,value:val})}),this.User.user.site.header={},this.layoutToType(this.currentsetting.headerLayoutId),this.storeSettings(arr).then(function(){deferred.resolve()})}return deferred.promise},headersettings.prototype.loadHeader=function(){this.User.user.site.header||(this.User.user.site.header={});var header=this.User.user.site.header;if(void 0!=header.type&&"None"!=header.type||(header.type="HeaderType1",header.settings=[{key:"logoVisible",value:"True"},{key:"titleVisible",value:"True"}]),"HeaderType1"==header.type){header.settings||this.setLayoutSetting(1);var logoVisible=header.settings.filter(function(setting){return"logoVisible"==setting.key}),titleVisible=header.settings.filter(function(setting){return"titleVisible"==setting.key});this.currentsetting={headerLayoutId:1,logoVisible:"True"==logoVisible[0].value,titleVisible:"True"==titleVisible[0].value}}if("HeaderType2"==header.type){header.settings||this.setLayoutSetting(2);var navigationAlignment=header.settings.filter(function(setting){return"navigationAlignment"==setting.key}),logoVisible=header.settings.filter(function(setting){return"logoVisible"==setting.key}),titleVisible=header.settings.filter(function(setting){return"titleVisible"==setting.key});this.currentsetting={headerLayoutId:2,navigationAlignment:navigationAlignment[0].value,logoVisible:"True"==logoVisible[0].value,titleVisible:"True"==titleVisible[0].value}}if("HeaderType3"==header.type){header.settings||this.setLayoutSetting(3);var logoNavigationSwap=header.settings.filter(function(setting){return"logoNavigationSwap"==setting.key}),titleAlignment=header.settings.filter(function(setting){return"titleAlignment"==setting.key});this.currentsetting={headerLayoutId:3,logoNavigationSwap:"True"==logoNavigationSwap[0].value,titleAlignment:titleAlignment[0].value}}if("HeaderType4"==header.type){header.settings||this.setLayoutSetting(4);var logoTitleSwap=header.settings.filter(function(setting){return"logoTitleSwap"==setting.key}),logoVisible=header.settings.filter(function(setting){return"logoVisible"==setting.key}),titleVisible=header.settings.filter(function(setting){return"titleVisible"==setting.key});this.currentsetting={headerLayoutId:4,logoTitleSwap:"True"==logoTitleSwap[0].value,logoVisible:"True"==logoVisible[0].value,titleVisible:"True"==titleVisible[0].value}}this.site=this.lodash.clone(this.Site.current),this.updateOriginal()},headersettings.prototype.setLayoutSetting=function(layoutId){switch(layoutId){case 1:this.currentsetting={headerLayoutId:1,logoVisible:!0,titleVisible:!0};break;case 2:this.currentsetting={headerLayoutId:2,navigationAlignment:"align-center",logoVisible:!0,titleVisible:!0};break;case 3:this.currentsetting={headerLayoutId:3,logoNavigationSwap:!1,titleAlignment:"align-center"};break;case 4:this.currentsetting={headerLayoutId:4,logoTitleSwap:!1,logoVisible:!0,titleVisible:!0};break;default:this.currentsetting=null}return this.currentsetting},headersettings.prototype.typeToLayout=function(headerType){switch(headerType){case"HeaderType1":return 1;case"HeaderType2":return 2;case"HeaderType3":return 3;case"HeaderType4":return 4;case"HeaderType5":return 5;default:return 0}},headersettings.prototype.revertToOriginal=function(){var areEquals=angular.equals(this.originalSettings,this.currentsetting);areEquals||angular.copy(this.originalSettings,this.currentsetting),this.site.logo=this.Site.current.logo,this.site.logoImage=this.Site.current.logoImage},headersettings.prototype.updateOriginal=function(){var areEquals=angular.equals(this.currentsetting,this.originalSettings);areEquals||angular.copy(this.currentsetting,this.originalSettings),this.Site.current.logo=this.site.logo,this.Site.current.logoImage=this.site.logoImage},headersettings.prototype.layoutToType=function(layoutId){switch(this.currentsetting.headerLayoutId){case 1:this.User.user.site.header.type="HeaderType1";break;case 2:this.User.user.site.header.type="HeaderType2";break;case 3:this.User.user.site.header.type="HeaderType3";break;case 4:this.User.user.site.header.type="HeaderType4";break;case 5:this.User.user.site.header.type="HeaderType5";break;default:this.User.user.site.header.type="None"}},headersettings.$inject=["Site","User","lodash","$q"],headersettings}();Services.headersettings=headersettings}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("headersettings",Common.Services.headersettings);var Common;!function(Common){var Services;!function(Services){"use strict";var HelpboxService=function(){function HelpboxService($q,lodash,User,Experiments){this.$q=$q,this.lodash=lodash,this.User=User,this.Experiments=Experiments,this.isTriggersEnabled=!1,this.tipsChangedListeners=[],this.activeTips=null,this.tips=[{title:"Help",img:"",text:"Here are some short guides to help you get started working with your stunning website",isActive:function(user,history){return!0}},{title:"Add new page",img:"/assets/img/helpbox/1.gif",text:"Click on the plus button in the right-hand sidebar of your website to add a new page. You can choose from different page types.",isActive:function(user,history){return user.pages.length<2&&!history.addedPage}},{title:"Add content to a page",img:"/assets/img/helpbox/2.gif",text:"Click on the “Add content”-button to add content to your page. You can choose from different types of content, e.g. Text or Image.",isActive:function(user,history){return history.addedPage&&!history.addedContent}},{title:"Change design",img:"/assets/img/helpbox/3.gif",text:"Click on “Design” to open the design options for your website. Here you can change the colors, fonts and background of your site.",isActive:function(user,history){return!history.openedDesignOptions}},{title:"Preview website",img:"/assets/img/helpbox/4.gif",text:"Click on the “Preview website”-button in the top-left corner to see a quick preview of your site. Click on this button again to return to the editor.",isActive:function(user,history){return history.addedContent&&!history.previewedWebsite}},{title:"Rename page",img:"/assets/img/helpbox/5.gif",text:"Rename a page by selecting the page under “Pages” in the right-hand sidebar. Then click “Page Options”. Finally click “Rename”",isActive:function(user,history){if(history.renamedPage)return!1;var addedPage=history.addedPage&&2===user.pages.length,clickedPageTitleWithOnePage=history.clickedPageTitleInMenu&&1===user.pages.length;return addedPage||clickedPageTitleWithOnePage}},{title:"Edit content",img:"/assets/img/helpbox/6.gif",text:"Click on content on your website to edit it. Editable elements are marked with a red border, so you can easily see which elements can be edited.",isActive:function(user,history){return history.addedContent}},{title:"Save content",img:"/assets/img/helpbox/7.gif",text:"All changes you make to your website (adding content, changing the design, making edits) needs to be saved.",isActive:function(user,history){return history.addedContent}}],this.history=this.getPersistedHistory()}return HelpboxService.prototype.isExperimentEnabled=function(){var deferred=this.$q.defer();return this.Experiments.getTrack(Common.Services.ExperimentId.HELPBOX).then(function(track){deferred.resolve("Show"===track)}),deferred.promise},HelpboxService.prototype.getTips=function(){return this.activeTips?this.activeTips:(this.activeTips=this.getTipsNoCache(),this.activeTips)},HelpboxService.prototype.addTipsChangedListener=function(action,listener){this.tipsChangedListeners.push({action:action,listener:listener})},HelpboxService.prototype.removeTipsChangedListener=function(listener){for(var i=0;i<this.tipsChangedListeners.length;i++)this.tipsChangedListeners[i].listener==listener&&(this.tipsChangedListeners.splice(i,1),i--)},HelpboxService.prototype.triggerTipsConditionChange=function(action){this.addActionToHistory(action);var newTips=this.getTipsNoCache();this.activeTips=newTips,this.tipsChangedListeners.forEach(function(e){e.action.call(e.listener)})},HelpboxService.prototype.getTipsNoCache=function(){var _this=this,tips=[];return this.isTriggersEnabled?this.tips.forEach(function(tip){tip.isActive(_this.User.user,_this.history)&&tips.push(tip)}):tips=this.tips,tips},HelpboxService.prototype.addActionToHistory=function(action){this.history[action]=!0,this.persistHistory(this.history)},HelpboxService.prototype.persistHistory=function(history){Cookies.set(Common.Services.CookieNames.HELPBOX_HISTORY,JSON.stringify(history),Common.Globals.DEFAULT_COOKIE_SETTINGS)},HelpboxService.prototype.getPersistedHistory=function(){var history=Cookies.getJSON(Common.Services.CookieNames.HELPBOX_HISTORY)||{};return history},HelpboxService.$inject=["$q","lodash","User","Experiments"],HelpboxService}();Services.HelpboxService=HelpboxService}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("HelpboxService",Common.Services.HelpboxService);var Common;!function(Common){var Services;!function(Services){"use strict";var ImageLibraryService=function(){function ImageLibraryService(){this.basepath="/assets/img/videobackgrounds/",this.baseid=2147483647,this.tags={nature:"nature",fun:"fun",work:"work",objects:"objects",scenery:"scenery",love:"love",fashion:"fashion",animals:"animals",kids:"kids",food:"food"},this.imageLibrary=[new Common.Models.LibraryImage("animals",this.baseid-29,[this.tags.animals]),new Common.Models.LibraryImage("beach",this.baseid-49,[this.tags.nature,this.tags.scenery]),new Common.Models.LibraryImage("business",this.baseid-17,[this.tags.work]),new Common.Models.LibraryImage("catwalk",this.baseid-34,[this.tags.fashion,this.tags.work]),new Common.Models.LibraryImage("chalk",this.baseid-28,[this.tags.fun,this.tags.kids]),new Common.Models.LibraryImage("cooking",this.baseid-26,[this.tags.fun]),new Common.Models.LibraryImage("cups",this.baseid-41,[this.tags.objects]),new Common.Models.LibraryImage("dog",this.baseid-61,[this.tags.animals]),new Common.Models.LibraryImage("flowers",this.baseid-64,[this.tags.nature]),new Common.Models.LibraryImage("gardening",this.baseid-47,[this.tags.nature,this.tags.work]),new Common.Models.LibraryImage("gas",this.baseid-40,[this.tags.objects]),new Common.Models.LibraryImage("gear",this.baseid-22,[this.tags.objects]),new Common.Models.LibraryImage("guitar",this.baseid-37,[this.tags.objects,this.tags.fun]),new Common.Models.LibraryImage("heaven",this.baseid-52,[this.tags.nature]),new Common.Models.LibraryImage("knitting",this.baseid-73,[this.tags.fun]),new Common.Models.LibraryImage("love",this.baseid-69,[this.tags.fun,this.tags.nature,this.tags.love]),new Common.Models.LibraryImage("make-up",this.baseid-33,[this.tags.fashion]),new Common.Models.LibraryImage("mountains",this.baseid-44,[this.tags.nature,this.tags.scenery]),new Common.Models.LibraryImage("nodes",this.baseid-36,[this.tags.fun,this.tags.objects]),new Common.Models.LibraryImage("nyhavn",this.baseid-35,[this.tags.scenery]),new Common.Models.LibraryImage("pacifiers",this.baseid-27,[this.tags.kids,this.tags.objects]),new Common.Models.LibraryImage("painter",this.baseid-23,[this.tags.fun]),new Common.Models.LibraryImage("party",this.baseid-38,[this.tags.fun]),new Common.Models.LibraryImage("spring",this.baseid-46,[this.tags.scenery]),new Common.Models.LibraryImage("sun",this.baseid-51,[this.tags.nature,this.tags.love]),new Common.Models.LibraryImage("tools",this.baseid-48,[this.tags.objects,this.tags.work]),new Common.Models.LibraryImage("walking",this.baseid-43,[this.tags.nature,this.tags.scenery]),new Common.Models.LibraryImage("wedding",this.baseid-32,[this.tags.work,this.tags.fun,this.tags.objects,this.tags.love]),new Common.Models.LibraryImage("wine",this.baseid-12,[this.tags.work,this.tags.fun]),new Common.Models.LibraryImage("earth_night",this.baseid-130,[this.tags.scenery,this.tags.nature]),new Common.Models.LibraryImage("snow_forest_road",this.baseid-131,[this.tags.scenery,this.tags.nature]),new Common.Models.LibraryImage("pine_closeup",this.baseid-132,[this.tags.nature]),new Common.Models.LibraryImage("moon_night",this.baseid-133,[this.tags.scenery,this.tags.nature]),new Common.Models.LibraryImage("color_pencil_set",this.baseid-134,[this.tags.work,this.tags.kids,this.tags.fun,this.tags.objects]),new Common.Models.LibraryImage("book_closeup_we_care",this.baseid-135,[this.tags.work,this.tags.objects]),new Common.Models.LibraryImage("candles_closeup",this.baseid-136,[this.tags.objects]),new Common.Models.LibraryImage("eyewear_beach",this.baseid-137,[this.tags.fun,this.tags.objects]),new Common.Models.LibraryImage("balloons_colorful",this.baseid-138,[this.tags.fun,this.tags.objects]),new Common.Models.LibraryImage("cookies_closeup",this.baseid-139,[this.tags.food,this.tags.objects]),new Common.Models.LibraryImage("girl_teddybear",this.baseid-140,[this.tags.fun,this.tags.kids]),new Common.Models.LibraryImage("restaurant_empty",this.baseid-141,[this.tags.food,this.tags.objects]),new Common.Models.LibraryImage("baby_knitted",this.baseid-142,[this.tags.kids,this.tags.objects]),new Common.Models.LibraryImage("eggs_in_basket",this.baseid-143,[this.tags.fun,this.tags.objects,this.tags.food]),new Common.Models.LibraryImage("bride_place",this.baseid-144,[this.tags.love,this.tags.objects,this.tags.food]),new Common.Models.LibraryImage("table_food_flowers",this.baseid-145,[this.tags.food,this.tags.objects]),new Common.Models.LibraryImage("baby_closeup",this.baseid-146,[this.tags.kids]),new Common.Models.LibraryImage("table_food_plates_top",this.baseid-147,[this.tags.food,this.tags.objects]),new Common.Models.LibraryImage("couple_sunset",this.baseid-148,[this.tags.love,this.tags.scenery]),new Common.Models.LibraryImage("love_seashells",this.baseid-149,[this.tags.love,this.tags.nature]),new Common.Models.LibraryImage("gaming_joystick",this.baseid-150,[this.tags.fun,this.tags.objects]),new Common.Models.LibraryImage("social_application_icons",this.baseid-151,[this.tags.fun,this.tags.work]),new Common.Models.LibraryImage("old_phone",this.baseid-152,[this.tags.objects]),new Common.Models.LibraryImage("worker_craftsman_tools",this.baseid-153,[this.tags.work,this.tags.objects]),new Common.Models.LibraryImage("suit_buttonhole_flower_closeup",this.baseid-154,[this.tags.fun,this.tags.objects,this.tags.love]),new Common.Models.LibraryImage("person_scenery",this.baseid-155,[this.tags.scenery,this.tags.nature]),new Common.Models.LibraryImage("parrot",this.baseid-156,[this.tags.nature]),new Common.Models.LibraryImage("puppy_in_cup",this.baseid-157,[this.tags.fun,this.tags.animals]),new Common.Models.LibraryImage("dog_closeup_flowerfield",this.baseid-158,[this.tags.fun,this.tags.animals]),new Common.Models.LibraryImage("puppy_in_grass",this.baseid-159,[this.tags.fun,this.tags.animals]),new Common.Models.LibraryImage("kittens_in_grass",this.baseid-160,[this.tags.fun,this.tags.animals]),new Common.Models.LibraryImage("hammer_screw_wrench_nail",this.baseid-161,[this.tags.work,this.tags.objects]),new Common.Models.LibraryImage("dirty_hammer_thong",this.baseid-162,[this.tags.work,this.tags.objects]),new Common.Models.LibraryImage("birthday_balloons_clean",this.baseid-163,[this.tags.fun,this.tags.objects]),new Common.Models.LibraryImage("black_bottles",this.baseid-164,[this.tags.objects]),new Common.Models.LibraryImage("beach_party",this.baseid-165,[this.tags.fun,this.tags.nature,this.tags.scenery]),new Common.Models.LibraryImage("piano_hands",this.baseid-166,[this.tags.fun,this.tags.objects]),new Common.Models.LibraryImage("woman_stretch",this.baseid-167,[this.tags.work]),new Common.Models.LibraryImage("woman_skinny_pants",this.baseid-168,[this.tags.fun,this.tags.fashion]),new Common.Models.LibraryImage("skipping_rope",this.baseid-169,[this.tags.work]),new Common.Models.LibraryImage("healthy_fruits",this.baseid-170,[this.tags.food]),new Common.Models.LibraryImage("berry_plate",this.baseid-171,[this.tags.food]),new Common.Models.LibraryImage("dark_headphones",this.baseid-172,[this.tags.objects]),new Common.Models.LibraryImage("concert_crowd",this.baseid-173,[this.tags.fun])]}return ImageLibraryService.$inject=["$translate"],ImageLibraryService}();Services.ImageLibraryService=ImageLibraryService}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("ImageLibraryService",Common.Services.ImageLibraryService);var Common;!function(Common){var Services;!function(Services){"use strict";var InternalMedia=function(){function InternalMedia($http,$q,User,Upload){this.$http=$http,this.$q=$q,this.User=User,this.Upload=Upload,this.API_PATH=Common.Globals.API_PATH}return InternalMedia.prototype.addMedia=function(pageId,sectionId,file){var deferred=this.$q.defer();return this.Upload.upload({url:this.API_PATH+"/customers/"+this.User.user.customerId+"/pages_standardpage/"+pageId+"/sections_internalmedia/"+sectionId+"/media/",file:file}).progress(function(evt){deferred.notify((100*parseInt(evt.loaded,10)/parseInt(evt.total,10)).toFixed(0))}).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject({status:status,data:data})}),deferred.promise},InternalMedia.$inject=["$http","$q","User","Upload"],InternalMedia}();Services.InternalMedia=InternalMedia}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("InternalMedia",Common.Services.InternalMedia);var Common;!function(Common){var Services;!function(Services){"use strict";var MdNotificationService=function(){function MdNotificationService(Experiments,$mdToast){this.Experiments=Experiments,this.$mdToast=$mdToast}return MdNotificationService.prototype.getToastPosition=function(){var last={bottom:!0,top:!1,left:!0,right:!1},toastPosition=angular.extend({},last);return Object.keys(toastPosition).filter(function(pos){return toastPosition[pos]}).join(" ")},MdNotificationService.prototype.showSimpleToast=function(textcontent){this.ShowToast(textcontent,"notification-simple-save.html")},MdNotificationService.prototype.showSpinnerToast=function(textcontent){this.ShowToast(textcontent,"notification-simple-spinner.html",{hideDelay:6e4})},MdNotificationService.prototype.showErrorToast=function(textcontent){this.ShowToast(textcontent,"notification-simple-error.html")},MdNotificationService.prototype.ShowToast=function(textcontent,templateHtml,options){var pinTo=this.getToastPosition(),defaults={position:pinTo,controller:"MdNotificationController",controllerAs:"vm",templateUrl:"partials/ss-mdNotification/notification-templates/"+templateHtml,
locals:{textcontent:textcontent}};this.$mdToast.show(angular.merge(defaults,options))},MdNotificationService.prototype.closeToast=function(){this.getToastPosition();this.$mdToast.cancel()},MdNotificationService.$inject=["Experiments","$mdToast"],MdNotificationService}();Services.MdNotificationService=MdNotificationService}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("MdNotificationService",Common.Services.MdNotificationService);var Common;!function(Common){var Services;!function(Services){"use strict";var PagesApi=function(){function PagesApi($q,$http,User,PagesMapper,UserEvents){this.$q=$q,this.$http=$http,this.User=User,this.PagesMapper=PagesMapper,this.UserEvents=UserEvents,this.API_PATH=Common.Globals.API_PATH}return PagesApi.prototype.getUrl=function(pageType,pageId,categoryId){return this.API_PATH+"/customers/"+this.User.user.customerId+"/"+(pageType?"pages_"+pageType.toLowerCase():"pages")+(pageId?"/"+pageId+(categoryId&&"webshop"==pageType.toLowerCase()?"/categories/"+categoryId:""):"")},PagesApi.prototype.getTemplateUrl=function(pageType,pageId,categoryId){return this.API_PATH+"/customers/"+this.User.user.customerId+"/pages_standardpage/template"},PagesApi.prototype.get=function(pageType,pageId,categoryId){var _this=this,deferred=this.$q.defer();return this.$http({method:"GET",url:this.getUrl(pageType,pageId,categoryId)}).then(function(response){var page=_this.PagesMapper.convertPageFromApi(response.data);deferred.resolve(page)},function(reason){deferred.reject(reason.status)}),deferred.promise},PagesApi.prototype.getAll=function(){var _this=this,deferred=this.$q.defer();return this.$http({method:"GET",url:this.getUrl()}).then(function(response){var pages=response.data;pages=_this.PagesMapper.convertPagesFromApi(pages),deferred.resolve(pages)},function(reason){deferred.reject(reason.status)}),deferred.promise},PagesApi.prototype.add=function(pageType,pageName,parentPageId){return this.$http({method:"POST",url:this.getUrl(pageType),data:{pageName:pageName,parentPageId:parentPageId?parseInt(parentPageId,10):null}})},PagesApi.prototype.addTemplate=function(templateName,pageName,parentPageId){return this.UserEvents.send("V4TemplateUsed"),this.$http({method:"POST",url:this.getTemplateUrl(templateName),data:{pageName:pageName,templateName:templateName,parentPageId:parentPageId?parseInt(parentPageId,10):null}})},PagesApi.prototype.order=function(pageId,pageOrder){return this.$http({method:"PUT",url:this.API_PATH+"/customers/"+this.User.user.customerId+"/pages/"+pageId+"/order",data:pageOrder})},PagesApi.prototype.changeCommentsState=function(pageId,enabled){return this.$http({method:"PUT",url:this.API_PATH+"/customers/"+this.User.user.customerId+"/pages/"+pageId+"/changeCommentsState",data:enabled})},PagesApi.prototype["delete"]=function(pageType,pageId){return this.$http({method:"DELETE",url:this.getUrl(pageType,pageId)})},PagesApi.prototype.update=function(pageType,pageId,data){return this.$http({method:"PUT",url:this.getUrl(pageType,pageId),data:data})},PagesApi.prototype.partialUpdate=function(pageType,pageId,data){return this.$http({method:"PATCH",url:this.getUrl(pageType,pageId),data:data})},PagesApi.$inject=["$q","$http","User","PagesMapper","UserEvents"],PagesApi}();Services.PagesApi=PagesApi}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("PagesApi",Common.Services.PagesApi);var Common;!function(Common){var Services;!function(Services){"use strict";var PagesMapper=function(){function PagesMapper(lodash){this.lodash=lodash}return PagesMapper.prototype.convertPagesFromApi=function(pages){var _this=this;return pages=this.lodash.each(pages,function(page){page=_this.convertPageFromApi(page),_this.lodash.each(page.subPages,function(subpage){subpage.categoryId&&subpage.pageId.indexOf("_")<0&&(subpage.pageId=subpage.pageId+"_"+subpage.categoryId.toString(),subpage.pageType="Webshop")})})},PagesMapper.prototype.convertPageFromApi=function(page){return page.pageId=page.pageId.toString(),page.subPages&&page.subPages.length>0&&page.subPages.forEach(function(sub){sub.pageId=sub.pageId.toString()}),void 0!==page.sections&&page.sections.forEach(function(section){if("News"==section.type){var currentSection={newsItems:section.newsItems,type:section.type,index:section.index};currentSection.newsItems.forEach(function(newsItem){null!==newsItem.date?newsItem.date=new Date(newsItem.date.toString()):newsItem.date=new Date}),section=currentSection}}),page.categoryId&&page.pageId.indexOf("_")<0&&(page.pageId=page.pageId+"_"+page.categoryId.toString()),page},PagesMapper.prototype.convertPageIdToApi=function(pageId){return pageId.indexOf("_")>0?pageId.split("_")[0]:pageId},PagesMapper.prototype.getWebshopCategoryFromPageId=function(pageId){return pageId.indexOf("_")>0?pageId.split("_")[1]:null},PagesMapper.$inject=["lodash"],PagesMapper}();Services.PagesMapper=PagesMapper}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("PagesMapper",Common.Services.PagesMapper);var Common;!function(Common){var Services;!function(Services){"use strict";var Pages=function(){function Pages($q,User,PagesApi,lodash,PagesMapper,Sections,SectionImagesApi,$state){this.$q=$q,this.User=User,this.PagesApi=PagesApi,this.lodash=lodash,this.PagesMapper=PagesMapper,this.Sections=Sections,this.SectionImagesApi=SectionImagesApi,this.$state=$state,this.DOMAIN_PATH=Common.Globals.DOMAIN_PATH}return Object.defineProperty(Pages.prototype,"list",{get:function(){return this._list},set:function(list){this._list=list},enumerable:!0,configurable:!0}),Object.defineProperty(Pages.prototype,"flatList",{get:function(){var lst=[];return this._list.forEach(function(el){lst.push({pageId:el.pageId,pageName:el.pageName,isSubPage:!1,pageType:el.pageType,parentPageId:null,hasChildren:el.subPages.length>0,childCount:el.subPages.length,commentsEnabled:el.commentsEnabled,commentsAvailableForPageType:el.commentsAvailableForPageType}),el.subPages.length>0&&el.subPages.forEach(function(subel){lst.push({pageId:subel.pageId,pageName:subel.pageName,isSubPage:!0,pageType:subel.pageType,parentPageId:el.pageId,hasChildren:!1,childCount:0,commentsEnabled:subel.commentsEnabled,commentsAvailableForPageType:subel.commentsAvailableForPageType})})}),lst},enumerable:!0,configurable:!0}),Object.defineProperty(Pages.prototype,"clonedList",{get:function(){return JSON.parse(JSON.stringify(this._list))},enumerable:!0,configurable:!0}),Object.defineProperty(Pages.prototype,"currentPage",{get:function(){return this._currentPage},set:function(page){this._currentPage=page},enumerable:!0,configurable:!0}),Object.defineProperty(Pages.prototype,"currentCmsPage",{get:function(){return this._currentCmsPage},set:function(page){this._currentCmsPage=page},enumerable:!0,configurable:!0}),Pages.prototype.prettyUrl=function(pageId){if(pageId.toString().indexOf("_")>-1){var justPageId=pageId.split("_")[0],categoryId=pageId.split("_")[1];return"http://"+this.User.user.url+"."+this.DOMAIN_PATH+"/"+justPageId+"/category/"+categoryId}return"http://"+this.User.user.url+"."+this.DOMAIN_PATH+"/"+pageId},Pages.prototype.localUrl=function(pageId,categoryId){var url="#/pages/"+pageId;return categoryId&&(url+="/category/"+categoryId),url},Pages.prototype.get=function(pageId,categoryId){var _this=this,deferred=this.$q.defer();if(!this._list)throw"No page list availble";var pageType=this.getPageType(pageId);return null===pageType?(deferred.reject("404"),deferred.promise):(pageId.indexOf("_")!=-1&&(categoryId=parseInt(pageId.substring(pageId.indexOf("_")+1),10)),pageId=this.PagesMapper.convertPageIdToApi(pageId),this.PagesApi.get(pageType,pageId,categoryId).then(function(page){page=_this.PagesMapper.convertPageFromApi(page),deferred.resolve(page)},function(statusCode){deferred.reject(statusCode)}),deferred.promise)},Pages.prototype.getAll=function(){var _this=this,deferred=this.$q.defer();return this._list?deferred.resolve(this._list):this.PagesApi.getAll().then(function(pages){_this._list=pages,deferred.resolve(pages)},function(statusCode){deferred.reject(statusCode)}),deferred.promise},Pages.prototype.add=function(template,pageName,parentPageId){var _this=this;void 0===template&&(template="Standardpage"),void 0===parentPageId&&(parentPageId=null);var deferred=this.$q.defer(),templates=["AboutUs","PeopleGallery","PhotoStory","MyProject","ServiceList"];return templates.indexOf(template)>-1?this.PagesApi.addTemplate(template,pageName,parentPageId).success(function(page){if(page=_this.PagesMapper.convertPageFromApi(page),parentPageId){var parent=_this.lodash.find(_this._list,{pageId:parentPageId});parent.subPages.push(page)}else _this._list.push(page);deferred.resolve(page)}).error(function(data,status,headers,config){deferred.reject(status)}):this.PagesApi.add(template,pageName,parentPageId).success(function(page){if(Cookies.set(Common.Services.CookieNames.NEWLY_CREATED_PAGE,page.pageId),page=_this.PagesMapper.convertPageFromApi(page),_this.User.user.commentSettings.enabled==Common.Services.User.COMMENTS_GLOBALLY_ENABLED&&(page.commentsEnabled=!0),parentPageId){var parent=_this.lodash.find(_this._list,{pageId:parentPageId});parent.subPages.push(page)}else _this._list.push(page);deferred.resolve(page)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},Pages.prototype.order=function(pageId,pageOrder){var _this=this,deferred=this.$q.defer();return pageId=this.PagesMapper.convertPageIdToApi(pageId),this.PagesApi.order(pageId,pageOrder).success(function(pages){var newPages=_this.PagesMapper.convertPagesFromApi(pages);_this.User.pages=newPages,_this.list=newPages,deferred.resolve(_this.list)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},Pages.prototype.changeCommentsState=function(pageId,enabled){var _this=this;pageId=this.PagesMapper.convertPageIdToApi(pageId),this.PagesApi.changeCommentsState(pageId,enabled).success(function(){var currentPage=_this.findPage(pageId);currentPage.commentsEnabled=enabled}).error(function(data,status,headers,config){})},Pages.prototype["delete"]=function(pageId){var _this=this,deferred=this.$q.defer(),pageType=this.getPageType(pageId);return pageId=this.PagesMapper.convertPageIdToApi(pageId),this.PagesApi["delete"](pageType,pageId).success(function(data){_this.removePage(pageId),deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},Pages.prototype.update=function(pageId,data){var deferred=this.$q.defer(),pageType=this.getPageType(pageId);return pageId=this.PagesMapper.convertPageIdToApi(pageId),this.PagesApi.update(pageType,pageId,data).success(function(data){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},Pages.prototype.partialUpdate=function(pageId,data){var deferred=this.$q.defer(),pageType=this.getPageType(pageId);return pageId=this.PagesMapper.convertPageIdToApi(pageId),this.PagesApi.partialUpdate(pageType,pageId,data).success(function(data){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},Pages.prototype.getFirstImageUrl=function(){var imageUrl="";if(this._currentPage&&this._currentPage.sections){var keepGoingImage=!0;this._currentPage.sections.forEach(function(section){if(keepGoingImage)if(section.hasOwnProperty("image")){section.image;section.image.url&&(imageUrl=section.image.url,keepGoingImage=!1)}else section.hasOwnProperty("images")&&section.images.length>0&&section.images[0].image.url&&(imageUrl=section.images[0].image.url,keepGoingImage=!1)})}return imageUrl},Pages.prototype.getFirstDescriptionText=function(){var descriptionText="";if(this._currentPage&&this._currentPage.sections){var keepGoingText=!0;this._currentPage.sections.forEach(function(section){keepGoingText&&section.hasOwnProperty("text")&&section.text&&(descriptionText=section.text,keepGoingText=!1)}),descriptionText=this.removeHtmlTags(descriptionText)}return descriptionText},Pages.prototype.getPreviusPageId=function(pageId){var indexCurrentPage=this.lodash.findIndex(this._list,{pageId:pageId}),prevPageId="-1";return this._list[indexCurrentPage-1]&&(prevPageId=this._list[indexCurrentPage-1].pageId),prevPageId.split("_")[0]},Pages.prototype.getSectionIndex=function(sectionId){return this.lodash.findIndex(this.currentPage.sections,{sectionId:sectionId})},Pages.prototype.removePage=function(pageId){var _this=this,removed=!1;this.lodash.remove(this._list,function(page){return removed=page.pageId===pageId}),removed||this._list.forEach(function(el){el.subPages.length>0&&_this.lodash.remove(el.subPages,function(page){return page.pageId===pageId})})},Pages.prototype.findPage=function(pageId){var _this=this,page=null;return this._list.forEach(function(el){if(el.pageId==pageId)page=el;else if(el.subPages.length>0){var subpage=_this.lodash.find(el.subPages,{pageId:pageId});subpage&&(page=subpage)}}),page},Pages.prototype.getPageIdToGoAfterDelete=function(pageId){var flat=this.flatList,idx=this.lodash.findIndex(flat,{pageId:pageId});return idx-1>=0?flat[idx-1].pageId:flat[0].pageId},Pages.prototype.isSubPage=function(pageId){var _this=this,res=!1;return this._list.forEach(function(el){if(el.subPages.length>0){var subpage=_this.lodash.find(el.subPages,{pageId:pageId});subpage&&(res=!0)}}),res},Pages.prototype.isSubPageOf=function(pageId,parentPageId){var parent=this.lodash.find(this._list,{pageId:parentPageId});return!(!parent||!this.lodash.find(parent.subPages,{pageId:pageId}))},Pages.prototype.findParentPage=function(pageId){var _this=this,page=null;return this._list.forEach(function(el){if(el.subPages.length>0){var subpage=_this.lodash.find(el.subPages,{pageId:pageId});subpage&&(page=el)}}),page},Pages.prototype.removeHtmlTags=function(textWithHtmlTags){var div=document.createElement("div");return div.innerHTML=textWithHtmlTags,div.textContent||div.innerText||""},Pages.prototype.getPageType=function(pageId){var _this=this,page=null;return this._list.forEach(function(el){if(el.pageId==pageId)page=el;else if(el.subPages.length>0){var subpage=_this.lodash.find(el.subPages,{pageId:pageId});subpage&&(page=subpage)}}),page?page.pageType:null},Pages.$inject=["$q","User","PagesApi","lodash","PagesMapper","Sections","SectionImagesApi","$state"],Pages}();Services.Pages=Pages}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("Pages",Common.Services.Pages);var Common;!function(Common){var Services;!function(Services){"use strict";var PhotoAlbumApi=function(_super){function PhotoAlbumApi($q,$http,User,PagesMapper,Upload,UserEvents){_super.call(this,$q,$http,User,PagesMapper,UserEvents),this.$q=$q,this.$http=$http,this.User=User,this.PagesMapper=PagesMapper,this.Upload=Upload,this.API_URL="https://pixabay.com/api/?key=",this.API_KEY="6741428-23e6a136b730c7e975f78d828",this.URL=this.API_URL+this.API_KEY+"&q=",this.page="&page=",this.perPage="&per_page="}return __extends(PhotoAlbumApi,_super),PhotoAlbumApi.prototype.uploadImage=function(pageId,file){var deferred=this.$q.defer();return this.Upload.upload({url:this.getImageUrl(pageId),file:file}).progress(function(evt){deferred.notify((100*parseInt(evt.loaded,10)/parseInt(evt.total,10)).toFixed(0))}).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject({status:status,data:data,headers:headers,config:config})}),deferred.promise},PhotoAlbumApi.prototype.updateImage=function(pageId,photo){return this.$http({method:"PUT",url:this.getImageUrl(pageId)+"/"+photo.imageContainerId,data:photo})},PhotoAlbumApi.prototype.replaceFile=function(pageId,imageId,file){var deferred=this.$q.defer();return this.Upload.upload({url:this.getImageUrl(pageId)+"/"+imageId+"/replacefile",file:file}).progress(function(evt){deferred.notify((100*parseInt(evt.loaded,10)/parseInt(evt.total,10)).toFixed(0))}).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject({status:status,data:data,headers:headers,config:config})}),deferred.promise},PhotoAlbumApi.prototype.deleteImage=function(pageId,imageId){return this.$http({method:"DELETE",url:this.getImageUrl(pageId)+"/"+imageId})},PhotoAlbumApi.prototype.moveImage=function(pageId,imageId,index){return this.$http({method:"PUT",url:this.getImageUrl(pageId)+"/"+imageId+"/order",data:{moveToIndex:index}})},PhotoAlbumApi.prototype.getImagesFromPixabay=function(query,pageNr,perPage){var deferred=this.$q.defer();return jQuery.ajax({type:"GET",url:this.URL+query+this.page+pageNr+this.perPage+perPage,dataType:"jsonp",success:function(results){deferred.resolve(results)},error:function(){deferred.reject()}}),deferred.promise},PhotoAlbumApi.prototype.getImageFromPixabay=function(url){var urlImageSize960=url.replace(new RegExp("_640","g"),"_960"),deferred=this.$q.defer(),xhr=new XMLHttpRequest;xhr.open("GET",urlImageSize960,!0),xhr.responseType="blob";return xhr.onreadystatechange=function(){4==xhr.readyState&&200==this.status&&deferred.resolve(xhr.response)},xhr.send(null),deferred.promise},PhotoAlbumApi.prototype.getImageUrl=function(pageId){var url=this.API_PATH+"/customers/"+this.User.user.customerId+"/pages_photoalbum/"+pageId+"/images";return url},PhotoAlbumApi.$inject=["$q","$http","User","PagesMapper","Upload","UserEvents"],PhotoAlbumApi}(Services.PagesApi);Services.PhotoAlbumApi=PhotoAlbumApi}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("PhotoAlbumApi",Common.Services.PhotoAlbumApi);var Common;!function(Common){var Services;!function(Services){"use strict";var PhotoAlbum=function(){function PhotoAlbum(PhotoAlbumApi){this.PhotoAlbumApi=PhotoAlbumApi}return PhotoAlbum.prototype.uploadImage=function(pageId,file){return this.PhotoAlbumApi.uploadImage(pageId,file)},PhotoAlbum.prototype.updateImage=function(pageId,image){return this.PhotoAlbumApi.updateImage(pageId,image)},PhotoAlbum.prototype.deleteImage=function(pageId,imageId){return this.PhotoAlbumApi.deleteImage(pageId,imageId)},PhotoAlbum.prototype.moveImage=function(pageId,imageId,index){return this.PhotoAlbumApi.moveImage(pageId,imageId,index)},PhotoAlbum.prototype.replaceFile=function(pageId,imageId,file){return this.PhotoAlbumApi.replaceFile(pageId,imageId,file)},PhotoAlbum.prototype.getImagesFromPixabay=function(query,pageNr,perPage){return this.PhotoAlbumApi.getImagesFromPixabay(query,pageNr,perPage)},PhotoAlbum.prototype.getImageFromPixabay=function(url){return this.PhotoAlbumApi.getImageFromPixabay(url)},PhotoAlbum.$inject=["PhotoAlbumApi"],PhotoAlbum}();Services.PhotoAlbum=PhotoAlbum}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("PhotoAlbum",Common.Services.PhotoAlbum);var Common;!function(Common){var Services;!function(Services){"use strict";var SectionImagesApi=function(){function SectionImagesApi($http,$q,User,Upload){var _this=this;this.$http=$http,this.$q=$q,this.User=User,this.Upload=Upload,this.API_PATH=Common.Globals.API_PATH,this.upload=function(pageType,pageId,sectionType,sectionId,image,file){var deferred=_this.$q.defer();return _this.Upload.upload({url:_this.getUrl(pageType,pageId,sectionType,sectionId,image.imageContainerId),file:file}).progress(function(evt){deferred.notify((100*parseInt(evt.loaded,10)/parseInt(evt.total,10)).toFixed(0))}).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject({status:status,data:data})}),deferred.promise},this.uploadBlobs=function(pageType,pageId,sectionType,sectionId,files){var deferred=_this.$q.defer();return _this.Upload.upload({url:_this.API_PATH+"/customers/"+_this.User.user.customerId+"/pages_"+pageType.toLowerCase()+"/"+pageId+"/sections_"+sectionType.toLowerCase()+"/"+sectionId+"/images_v1",file:files}).progress(function(evt){deferred.notify((100*parseInt(evt.loaded,10)/parseInt(evt.total,10)).toFixed(0))}).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject({status:status,data:data})}),deferred.promise},this["delete"]=function(pageType,pageId,sectionType,sectionId,imageId){return _this.$http({method:"DELETE",url:_this.getUrl(pageType,pageId,sectionType,sectionId,imageId)})}}return SectionImagesApi.prototype.getUrl=function(pageType,pageId,sectionType,sectionId,imageId){var url=this.API_PATH+"/customers/"+this.User.user.customerId+"/pages_"+pageType.toLowerCase()+"/"+pageId+"/sections_"+sectionType.toLowerCase()+"/"+sectionId+"/images/"+imageId;return url},SectionImagesApi.$inject=["$http","$q","User","Upload"],SectionImagesApi}();Services.SectionImagesApi=SectionImagesApi}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("SectionImagesApi",Common.Services.SectionImagesApi);var Common;!function(Common){var Services;!function(Services){"use strict";var SectionItemsApi=function(){function SectionItemsApi($http,User){this.$http=$http,this.User=User,this.API_PATH=Common.Globals.API_PATH}return SectionItemsApi.prototype.get=function(pageType,pageId,sectionType,sectionId,index){return this.$http({method:"GET",url:this.getUrl(pageType,pageId,sectionType,sectionId,index)})},SectionItemsApi.prototype.add=function(pageType,pageId,sectionType,sectionId,item){return this.$http({method:"POST",url:this.getUrl(pageType,pageId,sectionType,sectionId),data:item})},SectionItemsApi.prototype["delete"]=function(pageType,pageId,sectionType,sectionId,index){return this.$http({method:"DELETE",url:this.getUrl(pageType,pageId,sectionType,sectionId,index)})},SectionItemsApi.prototype.update=function(pageType,pageId,sectionType,sectionId,index,item){return this.$http({method:"PUT",url:this.getUrl(pageType,pageId,sectionType,sectionId,index),data:item})},SectionItemsApi.prototype.order=function(pageType,pageId,sectionType,sectionId,index,newIndex){return this.$http({method:"PUT",url:this.getUrl(pageType,pageId,sectionType,sectionId,index)+"/order",data:{moveToIndex:newIndex}})},SectionItemsApi.prototype.getUrl=function(pageType,pageId,sectionType,sectionId,index){var url=this.API_PATH+"/customers/"+this.User.user.customerId+"/pages_"+pageType.toLowerCase()+"/"+pageId+"/sections_"+sectionType.toLowerCase()+"/"+sectionId+"/items";return void 0!==index&&(url+="/"+index),url},SectionItemsApi.$inject=["$http","User"],SectionItemsApi}();Services.SectionItemsApi=SectionItemsApi}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("SectionItemsApi",Common.Services.SectionItemsApi);var Common;!function(Common){var Services;!function(Services){"use strict";var SectionsApi=function(){function SectionsApi($http,$q,User){this.$http=$http,this.$q=$q,this.User=User,this.API_PATH=Common.Globals.API_PATH}return SectionsApi.prototype.get=function(pageType,pageId,sectionType,sectionId){return this.$http({method:"GET",url:this.getUrl(pageType,pageId,sectionType,sectionId)})},SectionsApi.prototype.add=function(section,pageType,pageId){return this.$http({method:"POST",url:this.getUrl(pageType,pageId,section.type),data:section})},SectionsApi.prototype["delete"]=function(pageType,pageId,sectionType,sectionId){return this.$http({method:"DELETE",url:this.getUrl(pageType,pageId,sectionType,sectionId)})},SectionsApi.prototype.update=function(section,pageType,pageId){return this.$http({method:"PUT",url:this.getUrl(pageType,pageId,section.type,section.sectionId),data:section})},SectionsApi.prototype.patch=function(data,pageType,pageId,sectionType,sectionId){var url=this.getUrl(pageType,pageId,sectionType,sectionId),promise=this.doRequest(url,"PUT",data);return promise},SectionsApi.prototype.order=function(index,pageType,pageId,sectionType,sectionId){var url=this.getUrl(pageType,pageId,sectionType,sectionId)+"/order",data={index:index},promise=this.doRequest(url,"PUT",data);return promise},SectionsApi.prototype.doRequest=function(url,method,data){var deferred=this.$q.defer();return this.$http({method:method,url:url,data:data?data:null}).success(function(data){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},SectionsApi.prototype.getUrl=function(pageType,pageId,sectionType,sectionId){var url=this.API_PATH+"/customers/"+this.User.user.customerId+"/pages_"+pageType.toLowerCase()+"/"+pageId+"/sections_"+sectionType.toLowerCase();return sectionId&&(url+="/"+sectionId),url},SectionsApi.$inject=["$http","$q","User"],SectionsApi}();Services.SectionsApi=SectionsApi}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("SectionsApi",Common.Services.SectionsApi);var Common;!function(Common){var Services;!function(Services){"use strict";var Sections=function(){function Sections($http,$q,User,SectionsApi,SectionItemsApi,HomeComponentService){this.$http=$http,this.$q=$q,this.User=User,this.SectionsApi=SectionsApi,this.SectionItemsApi=SectionItemsApi,this.HomeComponentService=HomeComponentService,this.API_PATH=Common.Globals.API_PATH}return Sections.prototype.getBaseSectionTypes=function(){return[{index:0,type:"Text",headline:null,text:"<p></p>"},{index:0,type:"TextNoImage",headline:null,text:"<p></p>",image:{position:"Unknown"}},{index:0,type:"TextRight",headline:null,text:"<p></p>",image:{position:"TopRight"}},{index:0,type:"TextLeft",headline:null,text:"<p></p>",image:{position:"TopLeft"}},{index:0,type:"Photo",caption:""},{index:0,type:"News"},{index:0,type:"Columns",layout:"ThreeColumn",columns:[{link:{}},{link:{}},{link:{}}]},{index:0,type:"SlideShow"},{index:0,type:Document},{index:0,type:"InternalMedia"},{index:0,type:"Signature"},{index:0,type:"Hero"},{index:0,type:"Title"},{index:0,type:"Divider"},{index:0,type:"Map"}]},Sections.prototype.get=function(pageType,pageId,sectionType,sectionId){return this.SectionsApi.get(pageType,pageId,sectionType,sectionId)},Sections.prototype.add=function(pageType,pageId,section){return this.SectionsApi.add(section,pageType,pageId)},Sections.prototype.edit=function(pageType,pageId,section){return this.SectionsApi.update(section,pageType,pageId)},Sections.prototype["delete"]=function(pageType,pageId,sectionType,sectionId){return this.SectionsApi["delete"](pageType,pageId,sectionType,sectionId)},Sections.prototype.sort=function(pageType,pageId,sectionType,sectionId,newIndex){return this.SectionsApi.order(newIndex,pageType,pageId,sectionType,sectionId)},Sections.prototype.getItem=function(pageType,pageId,sectionType,sectionId,index){return this.SectionItemsApi.get(pageType,pageId,sectionType,sectionId,index)},Sections.prototype.addItem=function(pageType,pageId,sectionType,sectionId,sectionItem){return this.SectionItemsApi.add(pageType,pageId,sectionType,sectionId,sectionItem)},Sections.prototype.updateItem=function(pageType,pageId,sectionType,sectionId,index,sectionItem){return this.SectionItemsApi.update(pageType,pageId,sectionType,sectionId,index,sectionItem)},Sections.prototype.deleteItem=function(pageType,pageId,sectionType,sectionId,index){return this.SectionItemsApi["delete"](pageType,pageId,sectionType,sectionId,index)},Sections.prototype.getAddableSectionTypes=function(isMobile){var sectionTypes,showEmptyElements=Common.ConfStrings.ShowEmptyElementsExperiment.check.isBranch("ShowEmpty");return sectionTypes=showEmptyElements?{Text:"fa fa-font",Photo:"fa fa-image",News:"fa fa-newspaper-o",SlideShow:"fa fa-camera",Document:"fa fa-file-text-o",Video:"fa fa-video-camera",Signature:"fa fa-pencil-square-o",Hero:"fa fa-hero"}:{TextNoImage:"fa fa-font",Photo:"fa fa-image",TextRight:"fa fa-font",TextLeft:"fa fa-font",SlideShow:"fa fa-camera",Signature:"fa fa-pencil-square-o",Video:"fa fa-video-camera",Hero:"fa fa-hero",Title:"fa fa-hero",Divider:"fa fa-hero",Columns:"fa fa-columns",Map:"fa fa-map"}},Sections.$inject=["$http","$q","User","SectionsApi","SectionItemsApi","HomeComponentService"],Sections}();Services.Sections=Sections}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("Sections",Common.Services.Sections);var Common;!function(Common){var Services;!function(Services){"use strict";var Site=function(){function Site($http,$q,User,Upload){this.$http=$http,this.$q=$q,this.User=User,this.Upload=Upload,this.API_PATH=Common.Globals.API_PATH}return Object.defineProperty(Site.prototype,"current",{get:function(){return this.User.user?this.User.user.site:null},enumerable:!0,configurable:!0}),Site.prototype.get=function(){var _this=this,deferred=this.$q.defer();return this.User.siteIsInitialized()?deferred.resolve(this.User.user.site):this.$http({method:"GET",url:this.API_PATH+"/customers/"+this.User.user.customerId+"/site"}).success(function(data){_this.User.user.site=data,deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},Site.prototype.update=function(site){var _this=this,deferred=this.$q.defer();return this.$http({method:"PATCH",url:this.API_PATH+"/customers/"+this.User.user.customerId+"/site",data:site}).success(function(data){_this.User.user.site=data,deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject({status:status,data:data})}),deferred.promise},Site.prototype.uploadBackgroundImage=function(file){var deferred=this.$q.defer();return this.Upload.upload({url:this.API_PATH+"/customers/"+this.User.user.customerId+"/site/images_background",file:file}).progress(function(evt){deferred.notify((100*parseInt(evt.loaded,10)/parseInt(evt.total,10)).toFixed(0))}).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject({status:status,data:data})}),deferred.promise},Site.prototype.uploadLogoImage=function(file){var deferred=this.$q.defer();return this.Upload.upload({url:this.API_PATH+"/customers/"+this.User.user.customerId+"/site/images_logo",file:file}).progress(function(evt){deferred.notify((100*parseInt(evt.loaded,10)/parseInt(evt.total,10)).toFixed(0))}).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject({status:status,data:data})}),deferred.promise},Site.prototype.getImageLibraryUrl=function(imageId){var deferred=this.$q.defer();return this.$http({method:"GET",url:this.API_PATH+"/customers/"+this.User.user.customerId+"/site/image_library_url?imageId="+imageId}).success(function(data){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject({status:status,data:data})}),deferred.promise},Site.prototype.getGoogleMapScript=function(){var deferred=this.$q.defer();return this.$http({method:"GET",url:this.API_PATH+"/customers/"+this.User.user.customerId+"/site/get_google_map_script"}).success(function(data){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject({status:status,data:data})}),deferred.promise},Site.$inject=["$http","$q","User","Upload"],Site}();Services.Site=Site}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("Site",Common.Services.Site);var Common;!function(Common){var Services;!function(Services){"use strict";var SiteShareService=function(){function SiteShareService(EnvironmentService,$translate,$window,User,Pages,UrlService,UserEvents){var _this=this;this.EnvironmentService=EnvironmentService,this.$translate=$translate,this.$window=$window,this.User=User,this.Pages=Pages,this.UrlService=UrlService,this.UserEvents=UserEvents,this.initFbApi=function(){!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];d.getElementById(id)||(js=d.createElement(s),js.id=id,js.src="//connect.facebook.net/en_US/sdk.js",
fjs.parentNode.insertBefore(js,fjs))}(document,"script","facebook-jssdk"),window.fbAsyncInit=function(){FB.init({appId:Common.Globals.FACEBOOK_APP_ID,xfbml:!0,version:"v2.8"})}},this.shareToFacebook=function(){var webUrl=_this.getWebSiteUrl(),defImageUrl="https://dummyimage.com/400x400/C1150A/eee.png&text="+_this.User.user.url,pageName=_this.Pages.currentPage.pageName;_this.UserEvents.send("FbShareButtonClicked");var img=_this.Pages.getFirstImageUrl(),imageUrl=img?_this.UrlService.resolveProtocol(img,Common.Services.UrlService.HTTPS):defImageUrl,descriptionText=_this.Pages.getFirstDescriptionText();FB.ui({method:"share",picture:imageUrl,href:webUrl,title:pageName,description:descriptionText},function(response){null!=response&&0==Object.keys(response).length&&_this.UserEvents.send("FbSharePostShared")})},this.redirect=function(link,pageid){"SUBSCRIPTION_LINK"===link&&_this.UserEvents.send("SeenAccountArea");var redirurl;Common.V3Links[link]&&(redirurl=Common.V3Links[link],window.location.href=_this.UrlService.getV3Url(redirurl))},this.initFbApi()}return SiteShareService.prototype.getWebSiteUrl=function(){return"http://"+this.User.user.fullUrl},SiteShareService.prototype.shareToTwitter=function(){this.$window.open("http://twitter.com/share?url="+encodeURIComponent(this.getWebSiteUrl())+"&related=simplesite","","width=626,height=436,personalbar=0,toolbar=0,scrollbars=1,resizable=1")},SiteShareService.prototype.shareToGoogle=function(){this.$window.open("https://plus.google.com/share?url="+encodeURIComponent(this.getWebSiteUrl()),"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=626,width=436")},SiteShareService.prototype.shareToEmail=function(){var body=this.$translate.instant("HOME.PREVIEW.SHARE.MAIL_BODY");body=body.replace("[livewebsite]",this.getWebSiteUrl());var url="mailto:?subject="+this.$translate.instant("HOME.PREVIEW.SHARE.MAIL_SUBJECT")+"&body="+body;this.$window.location.href=url},SiteShareService.prototype.copyToClipboard=function(selector){var copyTextarea=angular.element(this.$window.document.querySelector(selector));copyTextarea.select();var res=document.execCommand("copy");return res},SiteShareService.$inject=["EnvironmentService","$translate","$window","User","Pages","UrlService","UserEvents"],SiteShareService}();Services.SiteShareService=SiteShareService,angular.module("Common.Services").service("SiteShareService",Common.Services.SiteShareService)}(Services=Common.Services||(Common.Services={}))}(Common||(Common={}));var Common;!function(Common){var Services;!function(Services){"use strict";var localStorage=function(){function localStorage(){}return localStorage.prototype.get=function(name){return JSON.parse(window.localStorage.getItem(name))},localStorage.prototype.set=function(name,value){window.localStorage.setItem(name,JSON.stringify(value))},localStorage}();Services.localStorage=localStorage}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("localStorage",Common.Services.localStorage);var Common;!function(Common){var Services;!function(Services){"use strict";var SurveyMonkey=function(){function SurveyMonkey(){}return SurveyMonkey.prototype.init=function(){var script_tag=document.createElement("script");script_tag.type="text/javascript",script_tag.text='(function(t,e,s,n){var o,c,r;t.SMCX=t.SMCX||[],e.getElementById(n)||(o=e.getElementsByTagName(s),c=o[o.length-1],r=e.createElement(s),r.type="text/javascript",r.async=!0,r.id=n,r.src=["https:"===location.protocol?"https://":"http://","widget.surveymonkey.com/collect/website/js/HYUpO9UwE8gNpXq6HuX_2FLbWs3mr1LClFDJlsJQuG0qyxqGJn4Wz89TFVWroZLwXu.js"].join(""),c.parentNode.insertBefore(r,c))})(window,document,"script","smcx-sdk");';document.getElementsByTagName("body")[0];document.getElementsByTagName("body")[0].insertBefore(script_tag,document.getElementById("main-controller"))},SurveyMonkey}();Services.SurveyMonkey=SurveyMonkey}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("SurveyMonkey",Common.Services.SurveyMonkey);var Common;!function(Common){var Tinymce;!function(Tinymce){Tinymce.OPTIONS={forced_root_block:"p",convert_fonts_to_spans:!0,invalid_elements:"#p",encoding:"xml",convert_urls:!1,trusted:!0,skin:!1,menubar:!1,statusbar:!1,format:"html",inline:!0,plugins:"directionality directionalityText link emoticons",toolbar:!1,theme:"modern",readonly:!1,directionality:"ltr"},Tinymce.EMOTICONS=[["biggrin","blink","blush","brokenheart","confused","cool","crying","heart"],["hehe","kiss","love","mad","sad","shocked","sick","smile"],["thumbsdown","thumbsup","tonqueout","unsure","whistle","wild","wink","wow"]],Tinymce.EMOTICONSMOBILE=[["biggrin","blink","blush","brokenheart"],["confused","cool","crying","heart"],["hehe","kiss","love","mad"],["sad","shocked","sick","smile"],["thumbsdown","thumbsup","tonqueout","unsure"],["whistle","wild","wink","wow"]],Tinymce.FONTS=[{name:"Arial",fontfamily:"Arial, Helvetica, sans-serif"},{name:"Times",fontfamily:'"Times New Roman", Times, serif'},{name:"Courier",fontfamily:'"Courier New", Courier, monospace'}],Tinymce.COLORS=[{name:"Black",value:"#000000"},{name:"White",value:"#ffffff",altvalue:"#cccccc"},{name:"Ocean",value:"#155EAB"},{name:"Red",value:"#E21E28"},{name:"Green",value:"#65B345"},{name:"Silver",value:"#D1D2D4"},{name:"Papaya",value:"#F5864F"},{name:"Navy",value:"#002E5B"},{name:"Burgundy",value:"#9C1B31"}];var TinymceUtil=function(){function TinymceUtil(lodash,$translate){var _this=this;this.lodash=lodash,this.$translate=$translate,Tinymce.COLORS.forEach(function(element){_this.$translate("HOME.WEBSITE.SECTIONS.TEXT.COLORS."+element.name.toUpperCase()).then(function(text){element.name=text})})}return TinymceUtil.prototype.merge=function(tinymceOptions){return this.lodash.mergeWith(tinymceOptions,Common.Tinymce.OPTIONS,function(objValue,srcValue){if(!this.lodash.isUndefined(objValue))return objValue})},TinymceUtil.$inject=["lodash","$translate"],TinymceUtil}();Tinymce.TinymceUtil=TinymceUtil}(Tinymce=Common.Tinymce||(Common.Tinymce={}))}(Common||(Common={})),angular.module("Common.Tinymce",[]).service("TinymceUtil",Common.Tinymce.TinymceUtil);var Common;!function(Common){var Services;!function(Services){"use strict";var TrackingHelperService=function(){function TrackingHelperService($http,User,$q){this.$http=$http,this.User=User,this.$q=$q,this._isInit=!1,this.API_PATH=Common.Globals.API_PATH}return Object.defineProperty(TrackingHelperService.prototype,"isInit",{get:function(){var res=this._isInit;return this._isInit=!0,res},enumerable:!0,configurable:!0}),TrackingHelperService.prototype.init=function(trackingPixel){if(trackingPixel){var pixel_tag=document.createElement("div");pixel_tag.className="hidden",pixel_tag.innerHTML=trackingPixel,$(pixel_tag).appendTo(document.body)}},TrackingHelperService.prototype.getTrackingToInject=function(){var deferred=this.$q.defer();return this.$http({method:"GET",url:this.API_PATH+"/customers/tracking/"+this.User.user.customerId}).then(function(response){deferred.resolve(response.data)})["catch"](function(err){deferred.reject(err)}),deferred.promise},TrackingHelperService.$inject=["$http","User","$q"],TrackingHelperService}();Services.TrackingHelperService=TrackingHelperService}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("TrackingHelperService",Common.Services.TrackingHelperService);var Common;!function(Common){var Services;!function(Services){"use strict";var UrlService=function(){function UrlService(lodash,User,PagesMapper,$location){this.lodash=lodash,this.User=User,this.PagesMapper=PagesMapper,this.$location=$location,this.token=Cookies.get(Common.Services.CookieNames.WEBAPI_TOKEN),this.logoutUrl=this.logoutUrl+Common.Globals.LOGOUT_PARTIAL_LINK,this.absUrl=this.$location.absUrl()}return UrlService.prototype.getV3Url=function(redirectUrl){var fullLogoutUrl=this.$location.protocol()+"://"+this.$location.host();return 80!=this.$location.port()&&(fullLogoutUrl=fullLogoutUrl+":"+this.$location.port()),fullLogoutUrl+=Common.Globals.LOGOUT_PARTIAL_LINK,Common.V3Links.V4BRIDGE_LINK+"?token="+encodeURIComponent(this.token)+"&href="+encodeURIComponent(redirectUrl)+"&returnurl="+encodeURIComponent(this.absUrl)+"&logouturl="+encodeURIComponent(fullLogoutUrl)},UrlService.prototype.getCheckoutUrl=function(){var pitch=this.lodash.find(this.User.user.salesPitches,{name:"TrialSalesPitch"}),link="//www."+Common.Globals.DOMAIN_PATH+pitch.texts.links[0].link;return this.getV3Url(link)},UrlService.prototype.getAddressLink2=function(pitch){var link="//www."+Common.Globals.DOMAIN_PATH+pitch.texts.links[0].link;return this.getV3Url(link)},UrlService.prototype.getAddressLink3=function(customDomain,pitch){var link=pitch.texts.links[1].link.replace("___USERDOMAIN___","www."+customDomain);return link="//www."+Common.Globals.DOMAIN_PATH+link,this.getV3Url(link)},UrlService.prototype.getUpgradeUrl=function(pitch){return this.getV3Url(pitch.texts.links[1].link)},UrlService.prototype.getAnotherDomainUrl=function(pitch){return this.getV3Url(pitch.texts.links[0].link)},UrlService.prototype.getDomainPitchCheckoutPageUrl=function(pitch){var link="//www."+Common.Globals.DOMAIN_PATH+pitch.texts.links[0].link;return this.getV3Url(link)},UrlService.prototype.getSalesPitchBarUrl=function(pitch){return this.getV3Url(pitch.link)},UrlService.prototype.getWebshopManageUrl=function(){var webshopManageUrl=Common.V3Links.WEBSHOPEDIT_PARTIAL_LINK;return this.getV3Url(webshopManageUrl)},UrlService.prototype.getWebshopLiveUrl=function(pageId,categoryId){pageId=this.PagesMapper.convertPageIdToApi(pageId);var userurl=this.getUserUrl(),webshopLiveUrl=userurl+"/"+pageId+"/category/"+categoryId+"/online-store";return webshopLiveUrl},UrlService.prototype.getUserUrl=function(){return"http://"+this.User.user.fullUrl},UrlService.prototype.resolveProtocol=function(url,protocol){var res=url;return protocol==UrlService.INTER_PROTOCOL?(res=res.replace("http://","//").replace("https://","//"),res.indexOf("//")<0&&(res="//"+res)):protocol==UrlService.HTTP?(res=res.replace("https://","http://"),0==res.indexOf("//")&&(res=res.replace("//","http://")),res.indexOf("//")<0&&(res="http://"+res)):protocol==UrlService.HTTPS&&(res=res.replace("http://","https://"),0==res.indexOf("//")&&(res=res.replace("//","https://")),res.indexOf("//")<0&&(res="https://"+res)),res},UrlService.$inject=["lodash","User","PagesMapper","$location"],UrlService.HTTP=0,UrlService.HTTPS=1,UrlService.INTER_PROTOCOL=2,UrlService}();Services.UrlService=UrlService,angular.module("Common.Services").service("UrlService",Common.Services.UrlService)}(Services=Common.Services||(Common.Services={}))}(Common||(Common={}));var Common;!function(Common){var Services;!function(Services){"use strict";var UserAPI=function(){function UserAPI($http,$q){this.$http=$http,this.$q=$q,this.callInProgress=!1,this.queue=[]}return UserAPI.prototype.get=function(){var _this=this,deferred=this.$q.defer();return this.callInProgress?this.queue.push(deferred):(this.callInProgress=!0,this.$http({method:"GET",url:Common.Globals.API_PATH+"/customer"}).success(function(userdata){var user=_this.getUserFromData(userdata);for(deferred.resolve(user);_this.queue.length>0;){var d=_this.queue.pop();d.resolve(user)}_this.callInProgress=!1}).error(function(data,status,headers,config){for(deferred.reject(status);_this.queue.length>0;){var d=_this.queue.pop();d.reject(status)}_this.callInProgress=!1})),deferred.promise},UserAPI.prototype.updateSettings=function(settings){var _this=this,deferred=this.$q.defer();return this.$http({method:"POST",url:Common.Globals.API_PATH+"/customer",data:settings}).success(function(userdata){deferred.resolve(_this.getUserFromData(userdata))}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},UserAPI.prototype.getStatesForCountry=function(countryKey){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/states?countryKey="+countryKey}).success(function(statesList){deferred.resolve(statesList)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},UserAPI.prototype.getCountsForStats=function(){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/social_counts"}).success(function(stats){deferred.resolve(stats)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},UserAPI.prototype.getCmsPage=function(cmsKey){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/cmspage?cmskey="+cmsKey}).success(function(page){page.key=cmsKey,deferred.resolve(page)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},UserAPI.prototype.getCommentsPage=function(pageNum){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/comments?page="+pageNum}).success(function(list){deferred.resolve(list)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},UserAPI.prototype.getBlockedComments=function(){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/comments/blocked"}).success(function(blocks){deferred.resolve(blocks)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},UserAPI.prototype.approveComment=function(commentId){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/comments/approve/"+commentId}).success(function(res){deferred.resolve("Succeeded"==res)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},UserAPI.prototype.deleteComment=function(commentId){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/comments/delete/"+commentId}).success(function(res){deferred.resolve("Succeeded"==res)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},UserAPI.prototype.deleteAndBlockComment=function(commentId){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/comments/deleteAndBlock/"+commentId}).success(function(res){deferred.resolve("Succeeded"==res)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},UserAPI.prototype.unblockComment=function(blockId){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/comments/unblock/"+blockId}).success(function(res){deferred.resolve("Succeeded"==res)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},UserAPI.prototype.updatePassword=function(oldPassword,newPassword){var deferred=this.$q.defer();return this.$http({method:"POST",url:Common.Globals.API_PATH+"/customer/update_password",data:{oldPassword:oldPassword,newPassword:newPassword}}).success(function(errors){deferred.resolve(errors)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},UserAPI.prototype.getPastOrders=function(){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/account/orders_list"}).success(function(orders){deferred.resolve(orders)}).error(function(data,status){deferred.reject(status)}),deferred.promise},UserAPI.prototype.subscibeNewCreditCard=function(){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/account/add_new_card"}).success(function(formText){deferred.resolve(formText)}).error(function(data,status){deferred.reject(status)}),deferred.promise},UserAPI.prototype.stopPaymentService=function(){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/account/stop_ps"}).success(function(res){deferred.resolve(res)}).error(function(data,status){deferred.reject(status)}),deferred.promise},UserAPI.prototype.getAlerts=function(){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/account/notifications"}).success(function(alerts){deferred.resolve(alerts)}).error(function(data,status){deferred.reject(status)}),deferred.promise},UserAPI.prototype.checkExternalDomainStatus=function(){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/account/extrnal_domain_status_check"}).success(function(resp){deferred.resolve(resp)}).error(function(data,status){deferred.reject(status)}),deferred.promise},UserAPI.prototype.checkPendingDomainStatus=function(){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/account/pending_domain_status_check"}).success(function(resp){deferred.resolve(resp)}).error(function(data,status){deferred.reject(status)}),deferred.promise},UserAPI.prototype.getSubscriptionDetails=function(){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/account/subscription"}).success(function(resp){deferred.resolve(resp)}).error(function(data,status){deferred.reject(status)}),deferred.promise},UserAPI.prototype.getPaymentsDetails=function(){var deferred=this.$q.defer();return this.$http({method:"GET",url:Common.Globals.API_PATH+"/account/payments"}).success(function(resp){deferred.resolve(resp)}).error(function(data,status){deferred.reject(status)}),deferred.promise},UserAPI.prototype.getUserFromData=function(userdata){var user={accountUrl:userdata.accountUrl,cdCreationDate:new Date(userdata.cdCreationDate),creationDate:new Date(userdata.creationDate),culture:userdata.culture,customerId:userdata.customerId,experiments:userdata.experiments,firstSalesType:userdata.firstSalesType,firstSalesTypeRefCode:userdata.firstSalesTypeRefCode,fullUrl:userdata.fullUrl,isFaceBookShareEnabled:userdata.isFaceBookShareEnabled,isPremiumCustomer:userdata.isPremiumCustomer,lifetimeInMinutes:userdata.lifetimeInMinutes,loginCount:userdata.loginCount,pages:userdata.pages,processTrial:userdata.processTrial,rxCompleted:userdata.rxCompleted,salesPitches:userdata.salesPitches,segment:userdata.segment,site:userdata.site,siteVer:userdata.siteVer,url:userdata.url,email:userdata.email,weeklyMailOptIn:userdata.weeklyMailOptIn,siteCounterEnabled:userdata.siteCounterEnabled,siteCounter:userdata.siteCounter,gtmValues:userdata.gtmValues,accountData:userdata.accountData,commentSettings:userdata.commentSettings,isPaymentServiceActive:userdata.isPaymentServiceActive,isSiteVisible:userdata.isSiteVisible,isCustomerHasHostedDomain:userdata.isCustomerHasHostedDomain,isCustomerHostedDomainPending:userdata.isCustomerHostedDomainPending,isCustomerHasExternalDomain:userdata.isCustomerHasExternalDomain,errors:userdata.errors};return user},UserAPI.$inject=["$http","$q"],UserAPI}();Services.UserAPI=UserAPI}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("UserAPI",Common.Services.UserAPI);var Common;!function(Common){var Services;!function(Services){"use strict";var User=function(){function User($q,UserAPI,PagesMapper,lodash){this.$q=$q,this.UserAPI=UserAPI,this.PagesMapper=PagesMapper,this.lodash=lodash,this._user=null}return Object.defineProperty(User.prototype,"user",{get:function(){return this._user},set:function(user){this._user=user},enumerable:!0,configurable:!0}),Object.defineProperty(User.prototype,"pages",{set:function(pages){this._user.pages=pages},enumerable:!0,configurable:!0}),User.prototype.get=function(){var _this=this,deferred=this.$q.defer();return null!==this._user?deferred.resolve(this._user):this.UserAPI.get().then(function(user){if(!user)throw new Error("User.get(): user is null");_this.user=user,_this.user.pages=_this.PagesMapper.convertPagesFromApi(user.pages),deferred.resolve(user)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.findPage=function(pageId){var _this=this,page=null;return this._user.pages.forEach(function(el){if(el.pageId==pageId)page=el;else if(el.subPages.length>0){var subpage=_this.lodash.find(el.subPages,{pageId:pageId});subpage&&(page=subpage)}}),page},User.prototype.isCommentsEnabledForPageId=function(id){if(null!=this._user){var page=this.findPage(id);if(page)return page.commentsEnabled}return!1},User.prototype.isCommentsEnabled=function(){return!(!this.user||!this.user.commentSettings)&&this.user.commentSettings.enabled!=User.COMMENTS_GLOBALLY_DISABLED},User.prototype.setComments=function(val){var settings={commentSettings:{enabled:val?User.COMMENTS_GLOBALLY_ENABLED:User.COMMENTS_GLOBALLY_DISABLED}};return this.updateSettings(settings)},User.prototype.setShareWidget=function(val){var settings={enableShareWidget:val};return this.updateSettings(settings)},User.prototype.setSiteCounter=function(val){var settings={enableSiteCounter:val};return this.updateSettings(settings)},User.prototype.setWeeklyMailOptIn=function(val){var settings={weeklyMailOptIn:val};return this.updateSettings(settings)},User.prototype.updateSettings=function(settings){var _this=this,deferred=this.$q.defer();return this.UserAPI.updateSettings(settings).then(function(user){if(!user)throw new Error("User.get(): user is null");_this.user=user,_this.user.pages=_this.PagesMapper.convertPagesFromApi(user.pages),deferred.resolve(user)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.getStatesForCountry=function(countryKey){var deferred=this.$q.defer();return this.UserAPI.getStatesForCountry(countryKey).then(function(statesList){if(!statesList)throw new Error("User.getStatesForCountry(): states is null");deferred.resolve(statesList)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.getCountsForStats=function(){var deferred=this.$q.defer();return this.UserAPI.getCountsForStats().then(function(stats){deferred.resolve(stats)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.getCmsPage=function(cmsKey){var deferred=this.$q.defer();return this.UserAPI.getCmsPage(cmsKey).then(function(page){deferred.resolve(page)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.getPastOrders=function(){var deferred=this.$q.defer();return this.UserAPI.getPastOrders().then(function(orders){deferred.resolve(orders)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.subscibeNewCreditCard=function(){var deferred=this.$q.defer();return this.UserAPI.subscibeNewCreditCard().then(function(form){deferred.resolve(form)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.stopPaymentService=function(){var deferred=this.$q.defer();return this.UserAPI.stopPaymentService().then(function(res){deferred.resolve(res)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.getAlerts=function(){var deferred=this.$q.defer();return this.UserAPI.getAlerts().then(function(alerts){deferred.resolve(alerts)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.checkExternalDomainStatus=function(){var deferred=this.$q.defer();return this.UserAPI.checkExternalDomainStatus().then(function(resp){deferred.resolve(resp)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.checkPendingDomainStatus=function(){var deferred=this.$q.defer();return this.UserAPI.checkPendingDomainStatus().then(function(resp){deferred.resolve(resp)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.getSubscriptionDetails=function(){var deferred=this.$q.defer();return this.UserAPI.getSubscriptionDetails().then(function(resp){deferred.resolve(resp)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.getPaymentsDetails=function(){var deferred=this.$q.defer();return this.UserAPI.getPaymentsDetails().then(function(resp){deferred.resolve(resp)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.getCommentsPage=function(pageNum){var deferred=this.$q.defer();return this.UserAPI.getCommentsPage(pageNum).then(function(list){deferred.resolve(list)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.getBlockedComments=function(){var deferred=this.$q.defer();return this.UserAPI.getBlockedComments().then(function(list){deferred.resolve(list)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.approveComment=function(commentId){var deferred=this.$q.defer();return this.UserAPI.approveComment(commentId).then(function(res){deferred.resolve(res)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.deleteComment=function(commentId){var deferred=this.$q.defer();return this.UserAPI.deleteComment(commentId).then(function(res){deferred.resolve(res)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.deleteAndBlockComment=function(commentId){var deferred=this.$q.defer();return this.UserAPI.deleteAndBlockComment(commentId).then(function(res){deferred.resolve(res)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.unblockComment=function(blockId){var deferred=this.$q.defer();return this.UserAPI.unblockComment(blockId).then(function(res){deferred.resolve(res)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.updatePassword=function(oldPassword,newPassword){var deferred=this.$q.defer();return this.UserAPI.updatePassword(oldPassword,newPassword).then(function(errors){deferred.resolve(errors)})["catch"](function(status){deferred.reject(status)}),deferred.promise},User.prototype.isInitialized=function(){return null!==this._user},User.prototype.siteIsInitialized=function(){return this.isInitialized()&&null!=this._user.site},User.prototype.clear=function(){this._user=null},User.COMMENTS_GLOBALLY_ENABLED="GloballyEnabled",User.COMMENTS_GLOBALLY_DISABLED="GloballyDisabled",User.$inject=["$q","UserAPI","PagesMapper","lodash"],User}();Services.User=User}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("User",Common.Services.User);var Common;!function(Common){var Services;!function(Services){"use strict";var UserEvents=function(){function UserEvents($http,User){this.$http=$http,this.User=User,this.API_PATH=Common.Globals.API_PATH,this.enable=!0}return UserEvents.prototype.send=function(eventName){this.enable&&this.$http({method:"POST",url:this.API_PATH+"/customers/"+this.User.user.customerId+"/userevents",data:{event:eventName}})},UserEvents.$inject=["$http","User"],UserEvents}();Services.UserEvents=UserEvents}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("UserEvents",Common.Services.UserEvents);var Common;!function(Common){var V3Links;!function(V3Links){V3Links.V4BRIDGE_LINK="//www."+Common.Globals.DOMAIN_PATH+"/pages/v4bridge.aspx",V3Links.ACCOUNT_PATH="//www."+Common.Globals.DOMAIN_PATH+"/builder/pages/",V3Links.BUILDER_PATH="//www."+Common.Globals.DOMAIN_PATH+"/builder/",V3Links.MORESPACE_LINK=Common.V3Links.ACCOUNT_PATH+"subsextras.aspx",V3Links.NAMEWEBSITE_LINK=Common.V3Links.ACCOUNT_PATH+"SubscriptionCheckout.aspx?cnvt=3&search=true",V3Links.EMAILSERVICE_LINK=Common.V3Links.ACCOUNT_PATH+"SubscriptionCheckout.aspx?cnvt=3&search=true",V3Links.UPGRADEACCOUNT_LINK=Common.V3Links.ACCOUNT_PATH+"SubscriptionCheckout.aspx?cnvt=1&OrderScreen=1",V3Links.LOGOUT=Common.V3Links.ACCOUNT_PATH+"confirmlogout.aspx",V3Links.WEBSHOPCREATE_LINK=Common.V3Links.ACCOUNT_PATH+"AddPage.aspx?pagepos=bottom&template=WebShop",V3Links.WEBSHOPEDIT_PARTIAL_LINK=Common.V3Links.BUILDER_PATH+"shop/Products.aspx?PageID=",V3Links.VIEW_CONTACT_ME_MESSAGES_LINK=Common.V3Links.BUILDER_PATH+"pages/ViewMessage.aspx?pageid=",V3Links.SUBSCRIPTION_LINK=Common.V3Links.ACCOUNT_PATH+"subsinfo.aspx",V3Links.STOP_SITE_LINK=Common.V3Links.ACCOUNT_PATH+"subsStopDeleteNew.aspx",V3Links.VISIT_MY_PAGE=Common.V3Links.ACCOUNT_PATH+"edit_visitmypage.aspx"}(V3Links=Common.V3Links||(Common.V3Links={}))}(Common||(Common={}));var Common;!function(Common){var Services;!function(Services){"use strict";var VideoBackgroundsService=function(){function VideoBackgroundsService($rootScope){this.$rootScope=$rootScope,this.basepath="/assets/img/videobackgrounds/",this.videoBackgrounds=[new Common.Models.VideoBackground(0,"cheerup"),new Common.Models.VideoBackground(1,"clothing"),new Common.Models.VideoBackground(2,"highlines"),new Common.Models.VideoBackground(3,"matkot"),new Common.Models.VideoBackground(4,"nightbbq"),new Common.Models.VideoBackground(5,"scooters"),new Common.Models.VideoBackground(6,"theking"),new Common.Models.VideoBackground(7,"up"),new Common.Models.VideoBackground(8,"bluehorizon"),new Common.Models.VideoBackground(9,"glitter"),new Common.Models.VideoBackground(10,"snowflakes"),new Common.Models.VideoBackground(11,"blurrycrowd"),new Common.Models.VideoBackground(12,"crashingwaves"),new Common.Models.VideoBackground(13,"flames"),new Common.Models.VideoBackground(14,"rollingclouds")]}return VideoBackgroundsService.prototype.setVideoBackground=function(videoBackgroundId){var videoBackground=this.videoBackgrounds.filter(function(videoBackground){return videoBackground.backgroundId==videoBackgroundId});this.currentVideoBackground=videoBackground[0],this.$rootScope.$broadcast("videoBackground set")},VideoBackgroundsService.$inject=["$rootScope"],VideoBackgroundsService}();Services.VideoBackgroundsService=VideoBackgroundsService}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("VideoBackgroundsService",Common.Services.VideoBackgroundsService);var Common;!function(Common){var Services;!function(Services){"use strict";var WebshopService=function(){function WebshopService(lodash){this.lodash=lodash}return WebshopService.prototype.hasWebshop=function(pages){var hasWebshop=this.lodash.some(pages,{pageType:"Webshop"});return hasWebshop},WebshopService.$inject=["lodash"],WebshopService}();Services.WebshopService=WebshopService}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("WebshopService",Common.Services.WebshopService);var Common;!function(Common){var Services;!function(Services){"use strict";var WebshopProducts=function(){function WebshopProducts($http,$q,User){var _this=this;this.$http=$http,this.$q=$q,this.User=User,this.API_PATH=Common.Globals.API_PATH,this.get=function(pageId,categoryId){var deferred=_this.$q.defer();return _this.$http({method:"GET",url:_this.API_PATH+"/customers/"+_this.User.user.customerId+"/pages_webshop/"+pageId+"/categories/"+categoryId+"/products"}).success(function(data){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject(status)}),deferred.promise},this.add=function(){},this.update=function(){},this["delete"]=function(){}}return WebshopProducts.$inject=["$http","$q","User"],WebshopProducts}();Services.WebshopProducts=WebshopProducts}(Services=Common.Services||(Common.Services={}))}(Common||(Common={})),angular.module("Common.Services").service("WebshopProducts",Common.Services.WebshopProducts);var Common;!function(Common){var Services;!function(Services){"use strict";var cookieKey="seen-welcome-primer",cookieValue="true",WelcomeMobileService=function(){function WelcomeMobileService(){this.videoPrimerEnable=!1}return WelcomeMobileService.prototype.markUserAsHavingSeenMobilePrimer=function(){Cookies.set(cookieKey,cookieValue,Common.Globals.DEFAULT_COOKIE_SETTINGS)},WelcomeMobileService.prototype.userHasSeenWelcomeMobilePrimer=function(){var cookie=Cookies.get(cookieKey);return cookie===cookieValue},WelcomeMobileService.$inject=[],WelcomeMobileService}();Services.WelcomeMobileService=WelcomeMobileService,angular.module("Common.Services").service("WelcomeMobileService",Common.Services.WelcomeMobileService);
}(Services=Common.Services||(Common.Services={}))}(Common||(Common={}));var directionalityTextPlugin=function(editor,url){function generateSelector(dir){var selector=[];return tinymce.each("bdo".split(" "),function(name){selector.push(name+"[dir="+dir+"]")}),selector.join(",")}function bdo(directionality){var markOpen='<bdo dir="'+directionality+'">',markClose="</bdo>",node=(markOpen+editor.selection.getContent()+markClose,editor.dom,editor.selection.getNode());if("BDO"===node.nodeName)if(directionality==node.dir){var content=angular.element(node).html();angular.element(node).replaceWith(content)}else node.dir=directionality;else""!==editor.selection.getContent()&&editor.selection.setContent(markOpen+editor.selection.getContent()+markClose);for(var bdoTags=angular.element(node).parent().find("bdo"),i=0;i<bdoTags.length;i++)""===angular.element(bdoTags[i]).html()&&angular.element(bdoTags[i]).remove();node.focus()}editor.addButton("bdoRTL",{title:"Selection right to left",cmd:"bdoRTL",image:url+"/RTL-selection.png",stateSelector:generateSelector("rtl")}),editor.addButton("bdoLTR",{title:"Selection left to right",cmd:"bdoLTR",image:url+"/LTR-selection.png",stateSelector:generateSelector("ltr")}),editor.addCommand("bdoRTL",function(){bdo("rtl")}),editor.addCommand("bdoLTR",function(){bdo("ltr")})};tinymce.PluginManager.add("directionalityText",directionalityTextPlugin),angular.module("Components",[]);var Resolve;!function(Resolve){function previewResolve(){return function($q,$stateParams,Pages,$state,User,Auth,$translate,$css,GTM,TrackingHelperService,EnvironmentService){return User.get().then(function(user){if(!user)throw new Error("previewResolve: user is null");0===user.pages.length&&$translate("HOME.DEFAULT_PAGE_NAME").then(function(text){Pages.add("StandardPage",text)}),$translate.use(user.culture.toLowerCase()),Pages.list=user.pages;var gtmValues=JSON.parse(user.gtmValues);if(!GTM.isInit){var dataLayer=[{Version:"V4",Language:gtmValues.Language,Instrumentation:"V4EditPreview",CustomerId:gtmValues.CustomerId,Email:gtmValues.Email,Segmentation:gtmValues.Segmentation,BlogUser:gtmValues.BlogUser,RecognizedCustomer:"True",Market:gtmValues.Market,ProcessSeenEntryAny:"True",RefCode:gtmValues.RefCode,SiteVer:gtmValues.SiteVer,SalesType:gtmValues.SalesType,ProcessTrial:gtmValues.ProcessTrial,NumberOfLogins:gtmValues.NumberOfLogins,MinutesSinceCreation:gtmValues.MinutesSinceCreation,MainOrUser:"MainSite",PreOrFre:gtmValues.PreOrFre,Culture:gtmValues.Culture,IsMobile:EnvironmentService.isMobile,ExpQS:gtmValues.ExpQS}];GTM.setDataLayer(dataLayer),GTM.init("GTM-2MMH")}return TrackingHelperService.isInit||TrackingHelperService.getTrackingToInject().then(function(data){TrackingHelperService.init(data.trackingPixelHtml)}),$css.removeAll(),$css.add("/css/sitepreview_theme_"+user.site.design+"_"+user.site.colorThemeName+".css"),null!==$stateParams.pageId?Pages.get($stateParams.pageId,Number($stateParams.categoryId)).then(function(page){return Pages.currentPage=page,{page:page,site:user.site}},function(status){parseInt(status,10)>500,401===parseInt(status,10),404===parseInt(status,10)&&$state.go("notfound",null,{location:"replace"})}):void($stateParams.categoryId?$state.go("home",{pageId:user.pages[0].pageId,editmode:$stateParams.editmode,categoryId:$stateParams.categoryId}):$state.go("home",{pageId:user.pages[0].pageId,editmode:$stateParams.editmode}))})["catch"](function(){return Auth.goToLogin(),$q.reject()})}}function translatePartial(parts){return function($translatePartialLoader,$translate){lodash.each(parts,function(part){$translatePartialLoader.addPart(part)}),$translate.refresh()}}function commentSettingsResolve(){return function($q,$stateParams,$state,User,Auth,$translate,$css,Pages,EnvironmentService){return User.get().then(function(user){if(!user)throw new Error("settingsResolve: user is null");$translate.use(user.culture.toLowerCase()),Pages.list=user.pages})["catch"](function(){return Auth.goToLogin(),$q.reject()})}}function cmsPageResolve(){return function($q,$stateParams,$state,User,Auth,$translate,$css,Pages,EnvironmentService){return User.get().then(function(user){if(!user)throw new Error("settingsResolve: user is null");return $translate.use(user.culture.toLowerCase()),Pages.list=user.pages,null!==$stateParams.cmsKey?User.getCmsPage($stateParams.cmsKey).then(function(page){return Pages.currentCmsPage=page,{page:page,site:user.site}},function(status){401===parseInt(status,10),404===parseInt(status,10)&&$state.go("notfound",null,{location:"replace"})}):void $state.go("siteCmsPage",{cmsKey:"Bservice"})})["catch"](function(){return Auth.goToLogin(),$q.reject()})}}Resolve.previewResolve=previewResolve,Resolve.translatePartial=translatePartial,Resolve.commentSettingsResolve=commentSettingsResolve,Resolve.cmsPageResolve=cmsPageResolve}(Resolve||(Resolve={})),angular.module("app").config(function($mdDateLocaleProvider){$mdDateLocaleProvider.formatDate=function(date){return moment(date).format("YYYY-MM-DD")}});var Components;!function(Components){var DomainVerificationController=function(){function DomainVerificationController($scope,Auth,DomainVerification,$translate,EnvironmentService,$location,$anchorScroll,$window){var _this=this;this.$scope=$scope,this.Auth=Auth,this.DomainVerification=DomainVerification,this.$translate=$translate,this.EnvironmentService=EnvironmentService,this.$location=$location,this.$anchorScroll=$anchorScroll,this.$window=$window,this.step=1,this.domainFormData={},this.domainFormValidationData={},this.isFiBasedOnPersonalName=!1,this.isDomainAvailable=!1,this.checkingDomain=!1,this.loading=!0,this.UKPdfLink="https://www.simplesite.com/pages/pdf/UK_TermsAndConditions_UK.pdf",this.LUPdfLink1="https://www.simplesite.com/pages/pdf/FR_Register_Rules1_LU.pdf",this.LUPdfLink2="https://www.simplesite.com/pages/pdf/FR_Register_Rules2_LU.pdf",this.ESPdfLink="https://www.simplesite.com/pages/pdf/ES_TelematicConsent_ES.pdf",this.fiBasedOnPersonalNameChecked=!1,this.isPersonal=!0,this.isVerified=!1,this.debug=!1,this.returnurl=this.getParameterByName("returnurl",null),this.token=this.getParameterByName("dvt",null),DomainVerification.checkToken(this.token).then(function(domainInit){domainInit.isValid?DomainVerification.getDomainUser(domainInit.customerId).then(function(domainData){$translate.use(domainData.culture.toLowerCase()).then(function(){_this.loading=!1,_this.domainData=domainData,_this.setName(),_this.getDomainOptions(_this.domainData.defaultTld,!0),_this.setTermsAndConditions(),$translate("DOMAIN.V3.DOMAIN_VERIFICATION_INTRO_C").then(function(text){_this.intro_c=text.replace("_domainurl_",domainData.fullUrl),_this.intro_c=_this.intro_c.replace("_domainurllink_",domainData.fullUrl),_this.intro_c=_this.decodeHtml(_this.intro_c)}),$translate("DOMAIN.V3.DOMAIN_VERIFICATION_ERROR_DOMAINNAME").then(function(text){_this.domain_error=_this.decodeHtml(text)})})}):window.location.href=_this.returnurl})["catch"](function(){window.location.href=_this.returnurl})}return DomainVerificationController.prototype.getParameterByName=function(name,url){url||(url=window.location.href),name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);return results?results[2]?decodeURIComponent(results[2].replace(/\+/g," ")):"":null},DomainVerificationController.prototype.getDomainOptions=function(tldName,init){var _this=this;tldName&&""!=tldName||(tldName=this.tldName),this.DomainVerification.getDomainOptions(this.domainData.customerId,this.domainData.url,tldName,this.domainData.domainCustomerData.country,this.isPersonal,this.isFiBasedOnPersonalName).then(function(domainOptions){_this.debug&&(domainOptions.showTradeMarkRegisteredAt=!0),_this.domainOptions=domainOptions,_this.setTlds(),_this.setCountries(),_this.setStates(),_this.setCountryAndState(),_this.setCompanyTypes(),init&&(_this.domainName="www."+_this.domainOptions.initialSelectedDomainLabel+"."+_this.domainOptions.initialSelectedTldKey,_this.domainData.url=_this.domainOptions.initialSelectedDomainLabel,_this.tldName=_this.domainOptions.initialSelectedTldKey,_this.tldName&&""!=_this.tldName||(_this.tldName=_this.domainOptions.tldList[0].tldKey))})},DomainVerificationController.prototype.checkCountry=function(domainForm){domainForm.$setDirty(),domainForm.$setValidity("validation",!0),this.getDomainOptions(this.tldName,!1)},DomainVerificationController.prototype.setCountryAndState=function(){var _this=this;if(this.country=this.countries.filter(function(country){return country.key==_this.domainData.domainCustomerData.country})[0].value,this.states.length>0)if(this.domainData.domainCustomerData.stateRegionId>0){var statesFound=this.states.filter(function(state){return state.key==_this.domainData.domainCustomerData.stateRegionId});statesFound.length>0?this.state=statesFound[0].value+", ":(this.state=this.states[0].value+", ",this.domainData.domainCustomerData.stateRegionId=this.states[0].key)}else this.state="";else this.state="",this.domainData.domainCustomerData.stateRegionId=-1},DomainVerificationController.prototype.setDomainName=function(domainForm){domainForm.$setDirty(),domainForm.$setValidity("taken",!0),this.domainName="www."+this.domainData.url+"."+this.tldName,this.isDomainAvailable=!1,this.getDomainOptions(this.tldName,!1),this.setTermsAndConditions()},DomainVerificationController.prototype.setDateOfBirth=function(domainForm){domainForm.$setDirty(),domainForm.$setValidity("validation",!0)},DomainVerificationController.prototype.checkDomain=function(domainForm){var _this=this;this.checkingDomain=!0,this.DomainVerification.checkDomain(this.domainData.customerId,this.domainData.url,this.tldName).then(function(result){_this.isDomainAvailable=1==result,domainForm.$setValidity("taken",_this.isDomainAvailable),_this.checkingDomain=!1})},DomainVerificationController.prototype.validateForm=function(domainForm){var _this=this;this.DomainVerification.checkDomain(this.domainData.customerId,this.domainData.url,this.tldName).then(function(result){if(_this.isDomainAvailable=1==result,domainForm.domain.$setValidity("taken",_this.isDomainAvailable),domainForm.$valid)_this.fillDataObject(),_this.DomainVerification.ValidateDomainForm(_this.domainData.customerId,_this.domainFormData).then(function(domainVerificationResults){_this.updateVerificationResult(domainForm,domainVerificationResults),domainForm.$valid&&(_this.step=2)});else{var firstInvalid=angular.element(".ng-invalid");firstInvalid[1]&&firstInvalid[1].focus()}})},DomainVerificationController.prototype.validateRegistration=function(domainConfirm){var _this=this;domainConfirm.$valid&&(this.fillDataObject(),this.DomainVerification.confirmDomainForm(this.domainData.customerId,this.domainFormData,this.token).then(function(result){1==result&&(window.location.href=_this.returnurl)}))},DomainVerificationController.prototype.setTermsAndConditions=function(){var _this=this;this.$translate("DOMAIN.V3.123_ACCEPT_TERMS").then(function(text){_this.termsAndConditions=_this.replaceTexts(text),_this.termsAndConditions=_this.decodeHtml(_this.termsAndConditions)}),this.$translate("DOMAIN.V3.123_ACCEPT_TERMS_INFO").then(function(text){_this.termsAndConditionsInfo=_this.replaceTexts(text),_this.termsAndConditionsInfo=_this.decodeHtml(_this.termsAndConditionsInfo)}),this.$translate("DOMAIN.V3.SE_ACCEPT_TERMS").then(function(text){_this.SETermsAndConditions=_this.replaceTexts(text),_this.SETermsAndConditions=_this.decodeHtml(_this.SETermsAndConditions)}),this.$translate("DOMAIN.V3.SE_ACCEPT_TERMS_INFO").then(function(text){_this.SETermsAndConditionsInfo=_this.replaceTexts(text),_this.SETermsAndConditionsInfo=_this.decodeHtml(_this.SETermsAndConditionsInfo)}),this.$translate("DOMAIN.V3.UK_ACCEPT_TERMS").then(function(text){_this.UKTermsAndConditions=_this.replaceTexts(text),_this.UKTermsAndConditions=_this.decodeHtml(_this.UKTermsAndConditions)}),this.$translate("DOMAIN.V3.UK_ACCEPT_TERMS_PDF").then(function(text){_this.UKPdf=_this.replaceTexts(text),_this.UKPdf=_this.decodeHtml(_this.UKPdf)}),this.$translate("DOMAIN.V3.ES_ACCEPT_TERMS").then(function(text){_this.ESTermsAndConditions=_this.replaceTexts(text),_this.ESTermsAndConditions=_this.decodeHtml(_this.ESTermsAndConditions)}),this.$translate("DOMAIN.V3.ES_ACCEPT_TERMS_INFO").then(function(text){_this.ESTermsAndConditionsInfo=_this.replaceTexts(text),_this.ESTermsAndConditionsInfo=_this.decodeHtml(_this.ESTermsAndConditionsInfo)}),this.$translate("DOMAIN.V3.ES_ACCEPT_TERMS_PDF").then(function(text){_this.ESPdf=_this.replaceTexts(text),_this.ESPdf=_this.decodeHtml(_this.ESPdf)}),this.$translate("DOMAIN.V3.LU_ACCEPT_TERMS").then(function(text){_this.LUTermsAndConditions=_this.replaceTexts(text),_this.LUTermsAndConditions=_this.decodeHtml(_this.LUTermsAndConditions)}),this.$translate("DOMAIN.V3.LU_ACCEPT_TERMS_PDF1").then(function(text){_this.LUPdf1=_this.replaceTexts(text),_this.LUPdf1=_this.decodeHtml(_this.LUPdf1)}),this.$translate("DOMAIN.V3.LU_ACCEPT_TERMS_PDF2").then(function(text){_this.LUPdf2=_this.replaceTexts(text),_this.LUPdf2=_this.decodeHtml(_this.LUPdf2)})},DomainVerificationController.prototype.replaceTexts=function(text){for(;text.indexOf("[123hjemmeside]")>-1;)text=text.replace("[123hjemmeside]","SimpleSite");for(;text.indexOf("[123hjemmeside.dk]")>-1;)text=text.replace("[123hjemmeside.dk]","SimpleSite.com");for(;text.indexOf("[123hjemmeside aps]")>-1;)text=text.replace("[123hjemmeside aps]",this.domainData.defaultCompanyName);for(;text.indexOf("[http://www.123hjemmeside.dk]")>-1;)text=text.replace("[http://www.123hjemmeside.dk]","https://www.simplesite.com/");for(;text.indexOf("[kundeservice@123hjemmeside.dk]")>-1;)text=text.replace("[kundeservice@123hjemmeside.dk]",this.domainData.customerSupportEmail);for(;text.indexOf("_domainname_")>-1;)text=text.replace("_domainname_",this.domainName);return text=text.replace("/cms/common/Terms and Conditions/ICANN Contract Clauses.pdf","https://www.simplesite.com/cms/common/Terms and Conditions/ICANN Contract Clauses.pdf")},DomainVerificationController.prototype.decodeHtml=function(html){var txt=document.createElement("textarea");return txt.innerHTML=html,txt.value},DomainVerificationController.prototype.updateVerificationResult=function(domainForm,domainVerificationResult){this.domainFormValidationData=domainVerificationResult,domainForm.city&&domainForm.city&&domainVerificationResult.city&&domainVerificationResult.city.length>0&&domainForm.city.$setValidity("validation",!1),domainForm.country&&domainVerificationResult.country&&domainVerificationResult.country.length>0&&domainForm.country.$setValidity("validation",!1),domainForm.dateOfBirth&&domainVerificationResult.dateOfBirth&&domainVerificationResult.dateOfBirth.length>0&&domainForm.dateOfBirth.$setValidity("validation",!1),domainForm.cpr&&domainVerificationResult.domainCpr&&domainVerificationResult.domainCpr.length>0&&domainForm.cpr.$setValidity("validation",!1),domainForm.cvr&&domainVerificationResult.domainCvr&&domainVerificationResult.domainCvr.length>0&&domainForm.cvr.$setValidity("validation",!1),domainForm.passport&&domainVerificationResult.domainPassport&&domainVerificationResult.domainPassport.length>0&&domainForm.passport.$setValidity("validation",!1),domainForm.firstname&&domainVerificationResult.firstName&&domainVerificationResult.firstName.length>0&&domainForm.firstname.$setValidity("validation",!1),domainForm.lastname&&domainVerificationResult.lastName&&domainVerificationResult.lastName.length>0&&domainForm.lastname.$setValidity("validation",!1),domainForm.companyName&&domainVerificationResult.organizationName&&domainVerificationResult.organizationName.length>0&&domainForm.companyName.$setValidity("validation",!1),domainForm.phone&&domainVerificationResult.phoneNo&&domainVerificationResult.phoneNo.length>0&&domainForm.phone.$setValidity("validation",!1),domainForm.addressLine1&&domainVerificationResult.streetAndNumber&&domainVerificationResult.streetAndNumber.length>0&&domainForm.addressLine1.$setValidity("validation",!1),domainForm.trademark&&domainVerificationResult.tradeMarkNumber&&domainVerificationResult.tradeMarkNumber.length>0&&domainForm.trademark.$setValidity("validation",!1),domainForm.zip&&domainVerificationResult.zip&&domainVerificationResult.zip.length>0&&domainForm.zip.$setValidity("validation",!1),domainForm.nationality&&domainVerificationResult.nationality&&domainVerificationResult.nationality.length>0&&domainForm.nationality.$setValidity("validation",!1),domainForm.fiBasedOnPersonalName&&domainVerificationResult.fiBasedOnPersonalName&&domainVerificationResult.fiBasedOnPersonalName.length>0&&domainForm.fiBasedOnPersonalName.$setValidity("validation",!1)},DomainVerificationController.prototype.setTlds=function(){var arr=[];this.domainOptions.tldList.forEach(function(element){arr.push(element.tldKey)}),this.toplevelDomains=arr},DomainVerificationController.prototype.setCountries=function(){var arr=[];this.domainOptions.showAllowedCountries.forEach(function(element){arr.push({key:element.key,value:element.value})}),this.countries=arr},DomainVerificationController.prototype.setStates=function(){var arr=[];this.domainOptions.showAllowedStates&&(this.domainOptions.showAllowedStates.forEach(function(element){arr.push({key:element.StateRegionId,value:element.StateRegionName})}),this.domainData.domainCustomerData.stateRegionId<0&&(this.domainData.domainCustomerData.stateRegionId=arr[0].key)),this.states=arr},DomainVerificationController.prototype.setCompanyTypes=function(){if(this.domainOptions.showCompanyTypeES&&this.domainOptions.getCompanyTypesES){var arr=[];this.domainOptions.getCompanyTypesES.forEach(function(element){arr.push({key:element.key,value:element.value})}),this.companyTypesES=arr,this.companyType=arr[0].value}if(this.domainOptions.showCompanyTypeGB&&this.domainOptions.getCompanyTypesGB){var arr=[];this.domainOptions.getCompanyTypesGB.forEach(function(element){arr.push({key:element.key,value:element.value})}),this.companyTypesGB=arr,this.companyType=arr[0].value}},DomainVerificationController.prototype.setCompanyTypeName=function(){var _this=this;this.companyTypesES&&(this.companyTypeName=this.companyTypesES.filter(function(companyType){return companyType.value==_this.companyType})[0].key),this.companyTypesGB&&(this.companyTypeName=this.companyTypesGB.filter(function(companyType){return companyType.value==_this.companyType})[0].key)},DomainVerificationController.prototype.setNationalityName=function(){var _this=this;this.domainOptions.showNationality&&(this.nationalityName=this.countries.filter(function(country){return country.key==_this.nationality})[0].value)},DomainVerificationController.prototype.setName=function(){this.firstname=this.domainData.domainCustomerData.name.split(/ (.+)/)[0],this.lastname=this.domainData.domainCustomerData.name.split(/ (.+)/)[1]},DomainVerificationController.prototype.fillDataObject=function(){this.domainFormData.city=this.domainData.domainCustomerData.city,this.domainFormData.cityOfBirth=this.cityOfBirth?this.cityOfBirth:"",this.domainFormData.cityOfBirthPostal=this.cityOfBirthPostal?this.cityOfBirthPostal:"",this.domainFormData.companyType=this.companyType?this.companyType:"",this.domainFormData.country=this.domainData.domainCustomerData.country,this.domainFormData.custAcceptTerms=this.termsAndConditionsChecked,this.domainFormData.custEsAcceptTerms=this.ESTermsAndConditionsChecked,this.domainFormData.dateOfBirth=this.dateOfBirth?moment(this.dateOfBirth).format("YYYY-MM-DD"):"",this.domainFormData.domainCpr=this.cpr?this.cpr:"",this.domainFormData.domainCvr=this.cvr?this.cvr:"",this.domainFormData.domainPassport=this.passport?this.passport:"",this.domainFormData.tldKey=this.tldName,this.domainFormData.domainLabel=this.domainData.url,this.domainFormData.email=this.domainData.email,this.domainFormData.fiBasedOnPersonalName=!!this.isFiBasedOnPersonalName&&this.isFiBasedOnPersonalName,this.domainFormData.firstName=this.firstname,this.domainFormData.personalOrBusiness=this.isPersonal,this.domainFormData.lastName=this.lastname,this.domainFormData.luAcceptTerms=this.LUTermsAndConditionsChecked,this.domainFormData.nationality=this.nationality?this.nationality:"",this.domainFormData.organizationName=this.companyName?this.companyName:"",this.domainFormData.phoneCountryCode=this.domainOptions.suggestedCountryCode,this.domainFormData.phoneNo=this.domainData.domainCustomerData.phone,this.domainFormData.seAcceptTerms=this.SETermsAndConditionsChecked,this.domainFormData.state=this.domainData.domainCustomerData.stateRegionId.toString(),this.domainFormData.streetAndNumber=this.domainData.domainCustomerData.addressLine1,this.domainFormData.streetAndNumber2=this.domainData.domainCustomerData.addressLine2,this.domainFormData.tradeMarkNumber=this.trademark,this.domainFormData.tradeMarkRegisteredAt=this.trademarkRegisteredAt,this.domainFormData.ukAcceptTerms=this.UKTermsAndConditionsChecked,this.domainFormData.zip=this.domainData.domainCustomerData.zip},DomainVerificationController.$inject=["$scope","Auth","DomainVerification","$translate","EnvironmentService","$location","$anchorScroll","$window"],DomainVerificationController}();Components.DomainVerificationController=DomainVerificationController}(Components||(Components={})),angular.module("Components").controller("DomainVerificationController",Components.DomainVerificationController);var Components;!function(Components){var HomeController=function(){function HomeController($scope,$state,Pages,User,$stateParams,HomeComponentService,Experiments,Site,screenSize){this.$scope=$scope,this.$state=$state,this.Pages=Pages,this.User=User,this.$stateParams=$stateParams,this.HomeComponentService=HomeComponentService,this.Experiments=Experiments,this.Site=Site,this.screenSize=screenSize,this.isMobile=this.screenSize.is("xs, sm"),this.HomeComponentService.editmode="true"===$stateParams.editmode,this.HomeComponentService.topmodal=!1,this.HomeComponentService.settingsmode=!1,this.HomeComponentService.subsDashboardMode=!1}return HomeController.$inject=["$scope","$state","Pages","User","$stateParams","HomeComponentService","Experiments","Site","screenSize"],HomeController}();Components.HomeController=HomeController}(Components||(Components={})),angular.module("Components").controller("HomeController",Components.HomeController);var Components;!function(Components){"use strict";var HomeComponentService=function(){function HomeComponentService(){var _this=this;this.topbar=!1,this.domainbar=!1,this.showVideoBackground=!0,this.scrolltotop=!0,this.previewMode=Components.PreviewMode.DESKTOP,this.mainMenuDisplayMode=Components.MainMenuDisplayMode.DASHBOARD,this.changeSidebarState=function(state){_this.sidebar=state}}return HomeComponentService}();Components.HomeComponentService=HomeComponentService,Components.PreviewMode={DESKTOP:1,MOBILE:2},Components.MainMenuDisplayMode={DASHBOARD:1,SUBSCRIPTION:2,PAYMENTS:3,PAYMENTS_LIST:4,SITENAME:5}}(Components||(Components={})),angular.module("Components").service("HomeComponentService",Components.HomeComponentService);var Components;!function(Components){var HomeAccountController=function(){function HomeAccountController($location,$element,$state,Auth,HomeComponentService,User,UrlService,EnvironmentService,$translate,ModalService){this.$location=$location,this.$element=$element,this.$state=$state,this.Auth=Auth,this.HomeComponentService=HomeComponentService,this.User=User,this.UrlService=UrlService,this.EnvironmentService=EnvironmentService,this.$translate=$translate,this.ModalService=ModalService,this.url=this.User.user.url,this.email=this.User.user.email,this.plan=this.User.user.isPremiumCustomer?"pro":"free",this.commentsEnabled=this.User.user.commentSettings.enabled!=Common.Services.User.COMMENTS_GLOBALLY_DISABLED,this.siteCounter=this.User.user.siteCounter,this.updateCommentButtonText()}return HomeAccountController.prototype.updateCommentButtonText=function(){var _this=this;this.$translate(this.commentsEnabled?"HOME.ACCOUNT.MANAGE":"HOME.ACCOUNT.ENABLE").then(function(txt){_this.commentsEnabledButtonText=txt})},HomeAccountController.prototype.logout=function(){var _this=this;this.Auth.logout().then(function(){_this.Auth.goToLogin()})},HomeAccountController.prototype.commentsChange=function(){this.User.setComments(this.commentsEnabled)},HomeAccountController.prototype.openAccountInfoModal=function(){this.ModalService.showModal({templateUrl:"partials/home.accountinformation/home.accountinformation.html",controller:"HomeAccountInformationController",controllerAs:"vm"})},HomeAccountController.prototype.openChangePasswordModal=function(){this.ModalService.showModal({templateUrl:"partials/home.changepassword/home.changepassword.html",controller:"HomeChangePasswordController",controllerAs:"vm"})},HomeAccountController.$inject=["$location","$element","$state","Auth","HomeComponentService","User","UrlService","EnvironmentService","$translate","ModalService"],HomeAccountController}();Components.HomeAccountController=HomeAccountController}(Components||(Components={})),angular.module("Components").controller("HomeAccountController",Components.HomeAccountController);var Components;!function(Components){var HomeAccountInformationController=function(){function HomeAccountInformationController($scope,User,$window,close,lodash,$translate,$q){var _this=this;this.$scope=$scope,this.User=User,this.$window=$window,this.close=close,this.lodash=lodash,this.$translate=$translate,this.$q=$q,this.username=this.User.user.url,this.name=this.User.user.accountData.name,this.phone=this.User.user.accountData.phone,this.addressLine1=this.User.user.accountData.addressLine1,this.addressLine2=this.User.user.accountData.addressLine2,this.zip=this.User.user.accountData.zip,this.city=this.User.user.accountData.city,this.country=this.User.user.accountData.country;var foundStates=this.User.user.accountData.states.filter(function(state){return state.key==_this.User.user.accountData.stateRegionId.toString()});foundStates&&foundStates.length>0&&(this.state=foundStates[0]);var data=this.getLang(this.User.user.accountData.cultureKey);data&&data.length>0?this.language=data[0]:this.language=this.getLang("en-US")[0],this.timeZone=this.User.user.accountData.timeZones.filter(function(zone){return zone.key==_this.User.user.accountData.timeZoneId})[0],this.email=this.User.user.accountData.email,this.states=this.User.user.accountData.states,this.countriesWithStates=this.User.user.accountData.countriesWithStates,this.countries=this.User.user.accountData.countries,this.languages=this.User.user.accountData.languages,this.timeZones=this.User.user.accountData.timeZones,this.shown=!0}return HomeAccountInformationController.prototype.getLang=function(id){return this.User.user.accountData.languages.filter(function(lang){return lang.key==id})},HomeAccountInformationController.prototype.showState=function(){return this.countriesWithStates.indexOf(this.country)>=0},HomeAccountInformationController.prototype.countryChanged=function(){var _this=this;this.showState()&&this.User.getStatesForCountry(this.country).then(function(data){_this.states=data,_this.state=_this.states[0]})},HomeAccountInformationController.prototype["continue"]=function(){var _this=this,deferred=this.$q.defer();if(this.username)if(this.email){var oldLang=this.User.user.accountData.cultureKey;""===this.language.key&&(this.language.key=oldLang);var settings={userUrl:this.username!=this.User.user.url?this.username:null,language:this.language.key,email:this.email,realName:this.name,timeZoneId:this.timeZone.key,address:{city:this.city,countryKey:this.country,phoneNumber:this.phone,streetAddressLine2:this.addressLine2,streetAndNo:this.addressLine1,zip:this.zip}};this.state&&(settings.address.stateRegionId=parseInt(this.state.key,10)),this.User.updateSettings(settings).then(function(user){user.errors&&!user.errors.success&&user.errors.errors.length>0?(_this.error=user.errors.errors[0].value,deferred.resolve(!1)):deferred.resolve(!0),oldLang!=user.accountData.cultureKey&&window.location.reload(!0)})["catch"](function(status){deferred.resolve(!1)})}else this.$translate("HOME.PERSONAL_INFO_MODAL.MISSING_EMAIL").then(function(text){_this.error=text}),deferred.resolve(!1);else this.$translate("HOME.PERSONAL_INFO_MODAL.MISSING_URL").then(function(text){_this.error=text}),deferred.resolve(!1);return deferred.promise},HomeAccountInformationController.$inject=["$scope","User","$window","close","lodash","$translate","$q"],HomeAccountInformationController}();Components.HomeAccountInformationController=HomeAccountInformationController}(Components||(Components={})),angular.module("Components").controller("HomeAccountInformationController",Components.HomeAccountInformationController);var Components;!function(Components){var AddImageModalController=function(){function AddImageModalController(HomeComponentService,close,ImageLibraryService,Sections,Pages,$stateParams,EnvironmentService,UserEvents,Site){this.HomeComponentService=HomeComponentService,this.close=close,this.ImageLibraryService=ImageLibraryService,this.Sections=Sections,this.Pages=Pages,this.$stateParams=$stateParams,this.EnvironmentService=EnvironmentService,this.UserEvents=UserEvents,this.Site=Site,this.tags=[],this.libraryImages=ImageLibraryService.imageLibrary;for(var property in ImageLibraryService.tags)this.tags.push(property);this.shown=!0}return AddImageModalController.prototype.cancel=function(){this.shown=!1,this.close({},500)},AddImageModalController.prototype.updateSection=function(image){var section=this.HomeComponentService.activeSection;if("Columns"==section.type){var colSection=section,col=colSection.columns[colSection.activeColumnIndex];col.image||(col.image={}),col.image.id=image.id,col.image.url=image.url,col.image.blob=null}else section.image.id=image.id,section.image.url=image.url,section.image.blob=null},AddImageModalController.prototype.addImage=function(id){var _this=this;this.cancel(),this.UserEvents.send("V4ImageLibraryImageClicked"),this.Site.getImageLibraryUrl(parseInt(id,10)).then(function(imageData){_this.updateSection(imageData)})},AddImageModalController.$inject=["HomeComponentService","close","ImageLibraryService","Sections","Pages","$stateParams","EnvironmentService","UserEvents","Site"],AddImageModalController}();Components.AddImageModalController=AddImageModalController}(Components||(Components={})),angular.module("Components").controller("AddImageModalController",Components.AddImageModalController);var Components;!function(Components){var AddPageModalController=function(){function AddPageModalController(Sections,HomePreviewComponentService,EnvironmentService,UserEvents,close,WebshopService,Pages,lodash,screenSize,Dialog,$state,UrlService,HomeComponentService,ModalService,$translate,Experiments,pageId){var _this=this;this.Sections=Sections,this.HomePreviewComponentService=HomePreviewComponentService,this.EnvironmentService=EnvironmentService,this.UserEvents=UserEvents,this.close=close,this.WebshopService=WebshopService,this.Pages=Pages,this.lodash=lodash,this.screenSize=screenSize,this.Dialog=Dialog,this.$state=$state,this.UrlService=UrlService,this.HomeComponentService=HomeComponentService,this.ModalService=ModalService,this.$translate=$translate,this.Experiments=Experiments,this.pageId=pageId,this.setupAddablePageTypes(),this.isMobile=this.screenSize.is("xs, sm"),this.$translate("HOME.TOO_LONG_INPUT").then(function(text){_this.pagenameTooLongErrorText=text}),this.$translate("HOME.ERROR").then(function(text){_this.errorText=text}),this.shown=!0}return AddPageModalController.prototype.setupAddablePageTypes=function(){var _this=this;this.addablePageTypes=[{id:"StandardPage",title:"STANDARD_PAGE",img:"standardpage.svg",text:"STANDARD_PAGE_TEXT"},{id:"ContactMe",title:"CONTACT_ME",img:"contactme.svg",text:"CONTACT_ME_TEXT"},{id:"Map",title:"ADDRESS_PAGE",img:"address.svg",text:"ADDRESS_PAGE_TEXT"},{id:"PhotoAlbum",title:"PHOTO_ALBUM",img:"photoalbum.svg",text:"PHOTO_ALBUM_TEXT"}],this.WebshopService.hasWebshop(this.Pages.list)||this.pageId||this.addablePageTypes.push({
id:"Webshop",title:"WEBSHOP",img:"webshop.svg",text:"WEBSHOP_TEXT"}),this.Experiments.getTrack(Common.Services.ExperimentId.NEW_TEMPLATES).then(function(track){_this.EnvironmentService.isMobile||track!=Common.Services.ExperimentId.NEW_TEMPLATES||(_this.addablePageTypes=[],_this.addablePageTypes.push({id:"ContactMe",title:"CONTACT_ME",img:"contactme.svg",text:"CONTACT_ME_TEXT"}),_this.addablePageTypes.push({id:"Map",title:"ADDRESS_PAGE",img:"address.svg",text:"ADDRESS_PAGE_TEXT"}),_this.addablePageTypes.push({id:"PhotoAlbum",title:"PHOTO_ALBUM",img:"photoalbum.svg",text:"PHOTO_ALBUM_TEXT"}),_this.WebshopService.hasWebshop(_this.Pages.list)||_this.pageId||_this.addablePageTypes.push({id:"Webshop",title:"WEBSHOP",img:"webshop.svg",text:"WEBSHOP_TEXT"}),_this.addablePageTypes.push({id:"AboutUs",title:"ABOUT_US",img:"aboutus.svg",text:"ABOUT_US_TEXT"}),_this.addablePageTypes.push({id:"PeopleGallery",title:"PEOPLE_GALLERY",img:"peoplegallery.svg",text:"PEOPLE_GALLERY_TEXT"}),_this.addablePageTypes.push({id:"ServiceList",title:"SERVICE_LIST",img:"servicelist.svg",text:"SERVICE_LIST_TEXT"}),_this.addablePageTypes.push({id:"StandardPage",title:"STANDARD_PAGE",img:"standardpage.svg",text:"STANDARD_PAGE_TEXT"}))});var showEmptyElements=Common.ConfStrings.ShowEmptyElementsExperiment.check.isBranch("ShowEmpty");showEmptyElements&&(this.addablePageTypes.push({id:"Guestbook",title:"GUESTBOOK_PAGE",img:"guestbook.svg",text:"GUESTBOOK_PAGE_TEXT"}),this.addablePageTypes.push({id:"Blog",title:"BLOG",img:"blog.svg",text:"BLOG_TEXT"}))},AddPageModalController.prototype.checkAddablePageTypes=function(){this.WebshopService.hasWebshop(this.Pages.list)&&this.lodash.remove(this.addablePageTypes,{id:"Webshop"})},AddPageModalController.prototype.cancel=function(){this.working||(this.working=!0,this.close({},500))},AddPageModalController.prototype.selectPage=function(pageTypeId){if(!this.working){switch(this.working=!0,this.HomeComponentService.newPageType=pageTypeId,pageTypeId){case"Webshop":this.handleAddWebshop();break;default:this.showAddPageModal(pageTypeId)}this.close({},0)}},AddPageModalController.prototype.showAddPageModal=function(pageTypeId){var _this=this;this.HomeComponentService.newPageType=pageTypeId,this.isMobile&&!this.EnvironmentService.iOs9OrSmaller?this.Dialog.showPrompt("HOME.PAGES_OVERVIEW.NEW_PAGE_MODAL.PLACEHOLDER","HOME.PAGES_OVERVIEW.NEW_PAGE_MODAL.TITLE",function(newPageTitle){newPageTitle.length>20||_this.Pages.add(_this.HomeComponentService.newPageType,newPageTitle,_this.pageId).then(function(page){_this.$state.go("home",{pageId:page.pageId})})["catch"](function(reason){})}):this.ModalService.showModal({templateUrl:"partials/home.newpagenamemodal/home.newpagenamemodal.html",controller:"NewPageNameModalController",controllerAs:"vm",inputs:{pageId:this.pageId}})},AddPageModalController.prototype.handleAddWebshop=function(){this.UserEvents.send("SeenWebshopEditor");var redirurl=Common.V3Links.WEBSHOPCREATE_LINK;window.location.href=this.UrlService.getV3Url(redirurl)},AddPageModalController.$inject=["Sections","HomePreviewComponentService","EnvironmentService","UserEvents","close","WebshopService","Pages","lodash","screenSize","Dialog","$state","UrlService","HomeComponentService","ModalService","$translate","Experiments","pageId"],AddPageModalController}();Components.AddPageModalController=AddPageModalController}(Components||(Components={})),angular.module("Components").controller("AddPageModalController",Components.AddPageModalController);var Components;!function(Components){var AddSectionModalController=function(){function AddSectionModalController(Sections,HomePreviewComponentService,HomeComponentService,EnvironmentService,UserEvents,HintService,close){this.Sections=Sections,this.HomePreviewComponentService=HomePreviewComponentService,this.HomeComponentService=HomeComponentService,this.EnvironmentService=EnvironmentService,this.UserEvents=UserEvents,this.HintService=HintService,this.close=close,this.sectionTypes=this.Sections.getAddableSectionTypes(EnvironmentService.isMobile),this.shown=!0}return AddSectionModalController.prototype.addSection=function(sectionType){var _this=this;this.UserEvents.send("AddElementToPage");var st=sectionType.toLowerCase();switch(st){case"text":case"textleft":case"textright":case"textnoimage":this.UserEvents.send("V4AddPageContentSectionText");break;case"photo":this.UserEvents.send("V4AddPageContentSectionPhoto");break;case"news":this.UserEvents.send("V4AddPageContentSectionNews");break;case"columns":this.UserEvents.send("V4AddPageContentSectionColumns");break;case"signature":this.UserEvents.send("V4AddPageContentSectionSignature");break;case"video":this.UserEvents.send("V4AddPageContentSectionVideo");break;case"slideshow":this.UserEvents.send("V4AddPageContentSectionSlideshow");break;case"hero":this.UserEvents.send("V4AddPageContentSectionHero");break;case"map":this.UserEvents.send("V4AddPageContentSectionMap");break;case"divider":this.UserEvents.send("V4AddPageContentSectionDivider");break;case"title":this.UserEvents.send("V4AddPageContentSectionTitle")}this.HomePreviewComponentService.addSection(sectionType).then(function(){_this.shown=!1})},AddSectionModalController.prototype.isBeaconActive=function(tour,hintId){return!(!this.shown&&this.HintService.isTourActive(tour))&&!!this.HintService.isTourActive(tour)},AddSectionModalController.$inject=["Sections","HomePreviewComponentService","HomeComponentService","EnvironmentService","UserEvents","HintService","close","$timeout"],AddSectionModalController}();Components.AddSectionModalController=AddSectionModalController}(Components||(Components={})),angular.module("Components").controller("AddSectionModalController",Components.AddSectionModalController);var Components;!function(Components){var HomeManageBlockedCommentsController=function(){function HomeManageBlockedCommentsController($scope,$state,User,Pages,lodash){var _this=this;this.$scope=$scope,this.$state=$state,this.User=User,this.Pages=Pages,this.lodash=lodash,this.User.getBlockedComments().then(function(res){_this.comments=res})}return HomeManageBlockedCommentsController.prototype.unblockComment=function(comment){var _this=this;this.User.unblockComment(comment.guestbookBlockId).then(function(res){res&&_this.lodash.remove(_this.comments,{guestbookBlockId:comment.guestbookBlockId})})},HomeManageBlockedCommentsController.prototype.menuVisible=function(){return!1},HomeManageBlockedCommentsController.$inject=["$scope","$state","User","Pages","lodash"],HomeManageBlockedCommentsController}();Components.HomeManageBlockedCommentsController=HomeManageBlockedCommentsController}(Components||(Components={})),angular.module("Components").controller("HomeManageBlockedCommentsController",Components.HomeManageBlockedCommentsController);var Components;!function(Components){var BottombarController=function(){function BottombarController($scope,EnvironmentService,ModalService,UserEvents){var _this=this;this.$scope=$scope,this.EnvironmentService=EnvironmentService,this.ModalService=ModalService,this.UserEvents=UserEvents,this.showRemoveAdSplash=function(){_this.UserEvents.send("V4BottomBarClicked"),_this.ModalService.showModal({templateUrl:"partials/home.removeadsplash/home.removeadsplash.html",controller:"HomeRemoveAdSplashController",controllerAs:"vm"})},this.isExposed2ViralBanner=!1}return BottombarController.$inject=["$scope","EnvironmentService","ModalService","UserEvents"],BottombarController}();Components.BottombarController=BottombarController,angular.module("Components").controller("BottombarController",Components.BottombarController)}(Components||(Components={}));var Components;!function(Components){var HomeChangePasswordController=function(){function HomeChangePasswordController($scope,User,close,$translate,$q){var _this=this;this.$scope=$scope,this.User=User,this.close=close,this.$translate=$translate,this.$q=$q,this.shown=!0,this.$translate("HOME.CHANGE_PASSWORD_MODAL.TITLE").then(function(text){_this.title=text})}return HomeChangePasswordController.prototype["continue"]=function(){var _this=this,deferred=this.$q.defer();return this.newPassword!=this.confirmNewPassword?(this.$translate("HOME.CHANGE_PASSWORD_MODAL.MUST_MATCH").then(function(text){_this.error=text}),deferred.resolve(!1)):!this.newPassword||this.newPassword.length<=0?(this.$translate("HOME.CHANGE_PASSWORD_MODAL.NOT_EMPTY").then(function(text){_this.error=text}),deferred.resolve(!1)):this.User.updatePassword(this.oldPassword,this.newPassword).then(function(errors){!errors.success&&errors.errors.length>0&&(_this.error=errors.errors[0].value,_this.oldPassword=""),deferred.resolve(errors.success)})["catch"](function(status){deferred.resolve(!1)}),deferred.promise},HomeChangePasswordController.$inject=["$scope","User","close","$translate","$q"],HomeChangePasswordController}();Components.HomeChangePasswordController=HomeChangePasswordController}(Components||(Components={})),angular.module("Components").controller("HomeChangePasswordController",Components.HomeChangePasswordController);var Components;!function(Components){var HomeChooseAddressController=function(){function HomeChooseAddressController($scope,User,$window,close,$location,UserEvents,lodash,UrlService,EnvironmentService,HomeComponentService,CustomerFlagsService,Experiments,HintService){var _this=this;this.$scope=$scope,this.User=User,this.$window=$window,this.close=close,this.$location=$location,this.UserEvents=UserEvents,this.lodash=lodash,this.UrlService=UrlService,this.EnvironmentService=EnvironmentService,this.HomeComponentService=HomeComponentService,this.CustomerFlagsService=CustomerFlagsService,this.Experiments=Experiments,this.HintService=HintService,this.customDomain="",this.addressChoice="",this.closeModal=function(){_this.HomeComponentService.addressChoice||(_this.HomeComponentService.addressChoice="1"),_this.shown=!1,_this.$scope.$broadcast("domainofferafterswclosed")},this.CustomerFlagsService.send("SignupDomainOfferShown"),this.shown=!0,this.pitch=this.lodash.find(this.User.user.salesPitches,{name:"TrialSalesPitch"})}return HomeChooseAddressController.prototype["continue"]=function(){this.HomeComponentService.addressChoice=this.addressChoice,"2"===this.addressChoice?(this.UserEvents.send("DomainOfferInEcoSysYes"),this.$window.location.href=this.UrlService.getAddressLink2(this.pitch)):"3"===this.addressChoice?(this.UserEvents.send("DomainOfferInEcoSysDomainSearch"),this.$window.location.href=this.UrlService.getAddressLink3(this.customDomain,this.pitch)):(this.UserEvents.send("DomainOfferInEcoSysNo"),this.closeModal(),this.HintService.startTour("AddContentTour"))},HomeChooseAddressController.prototype.showIntegrateDisclaimer=function(){return 0==this.User.user.firstSalesTypeRefCode.indexOf("Integrate_CPA_Coreg_NAM_US_EN_BuyNow1CB")||0==this.User.user.firstSalesTypeRefCode.indexOf("Integrate_CPA_Coreg_NAM_US_EN_BuyNow4CB")||0==this.User.user.firstSalesTypeRefCode.indexOf("Integrate_CPA_Coreg_NAM_US_EN_BuyNow5CB")||0==this.User.user.firstSalesTypeRefCode.indexOf("Integrate_CPA_Coreg_EUR_DE_DE_BuyNow4")||0==this.User.user.firstSalesTypeRefCode.indexOf("Integrate_CPA_Coreg_EUR_DE_DE_BuyNow1")||0==this.User.user.firstSalesTypeRefCode.indexOf("Integrate_CPA_Coreg_EUR_ES_ES_BuyNow4")||0==this.User.user.firstSalesTypeRefCode.indexOf("Integrate_CPA_Coreg_EUR_ES_ES_BuyNow1")},HomeChooseAddressController.$inject=["$scope","User","$window","close","$location","UserEvents","lodash","UrlService","EnvironmentService","HomeComponentService","CustomerFlagsService","Experiments","HintService"],HomeChooseAddressController}();Components.HomeChooseAddressController=HomeChooseAddressController}(Components||(Components={})),angular.module("Components").controller("HomeChooseAddressController",Components.HomeChooseAddressController);var Components;!function(Components){var HomeCmsPageController=function(){function HomeCmsPageController($scope,$state,User,Pages,$timeout,$window){this.$scope=$scope,this.$state=$state,this.User=User,this.Pages=Pages,this.$timeout=$timeout,this.$window=$window,$state.params.ascroll}return HomeCmsPageController.prototype.menuVisible=function(){return!1},HomeCmsPageController.$inject=["$scope","$state","User","Pages","$timeout","$window"],HomeCmsPageController}();Components.HomeCmsPageController=HomeCmsPageController}(Components||(Components={})),angular.module("Components").controller("HomeCmsPageController",Components.HomeCmsPageController);var Components;!function(Components){var HomeCommentSettingsController=function(){function HomeCommentSettingsController($scope,$state,User,Pages,HomeComponentService,$window){this.$scope=$scope,this.$state=$state,this.User=User,this.Pages=Pages,this.HomeComponentService=HomeComponentService,this.$window=$window,this.moderationLevel=this.User.user.commentSettings.moderationLevel,this.notify=this.User.user.commentSettings.notifyPosts,this.enabledState=this.User.user.commentSettings.enabled,this.pages=Pages.flatList}return HomeCommentSettingsController.prototype.save=function(){var _this=this,settings={commentSettings:{moderationLevel:this.moderationLevel,notifyPosts:this.notify,enabled:this.enabledState}};this.User.updateSettings(settings).then(function(user){_this.$window.history.back()})["catch"](function(status){})},HomeCommentSettingsController.prototype.viewPageClicked=function(page){var url=this.$state.href("home",{pageId:page.pageId});window.open(url,"_blank")},HomeCommentSettingsController.prototype.pageCommentsStatusChange=function(page){this.Pages.changeCommentsState(page.pageId,page.commentsEnabled)},HomeCommentSettingsController.prototype.menuVisible=function(){return!1},HomeCommentSettingsController.$inject=["$scope","$state","User","Pages","HomeComponentService","$window"],HomeCommentSettingsController}();Components.HomeCommentSettingsController=HomeCommentSettingsController}(Components||(Components={})),angular.module("Components").controller("HomeCommentSettingsController",Components.HomeCommentSettingsController);var Common;!function(Common){var Directives;!function(Directives){var DeletePageModalController=function(){function DeletePageModalController(close,$q,page){this.close=close,this.$q=$q,this.page=page,this.shown=!0}return DeletePageModalController.prototype.deletePage=function(){var deferred=this.$q.defer();return deferred.resolve({pageId:this.page.pageId}),deferred.promise},DeletePageModalController.$inject=["close","$q","page"],DeletePageModalController}();Directives.DeletePageModalController=DeletePageModalController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("DeletePageModalController",Common.Directives.DeletePageModalController);var Components;!function(Components){var DeleteSectionModalController=function(){function DeleteSectionModalController(lodash,Pages,Sections,section,close,$rootScope,$scope,isempty,$translate,ActiveSection,HomeComponentService,$q){var _this=this;this.lodash=lodash,this.Pages=Pages,this.Sections=Sections,this.section=section,this.close=close,this.$rootScope=$rootScope,this.$scope=$scope,this.isempty=isempty,this.$translate=$translate,this.ActiveSection=ActiveSection,this.HomeComponentService=HomeComponentService,this.$q=$q,this.deleteSection=function(){var def=_this.$q.defer();return _this.section.sectionId?_this.Sections["delete"](_this.Pages.currentPage.pageType,_this.Pages.currentPage.pageId,_this.section.type,_this.section.sectionId).then(function(){_this.lodash.remove(_this.Pages.currentPage.sections,{sectionId:_this.section.sectionId}),_this.HomeComponentService.activeSection=null,_this.ActiveSection.activeSectionId=null,_this.HomeComponentService.editmode=!0,def.resolve(!0)}):_this.Pages.currentPage.sections.splice(_this.section.index,1),def.promise},this.$translate(this.isempty?"HOME.PREVIEW.DELETE_MODAL.IS_EMPTY":"HOME.PREVIEW.DELETE_MODAL.REALLY").then(function(txt){_this.message=txt}),this.shown=!0}return DeleteSectionModalController.prototype.cancel=function(){this.shown=!1,this.close({},500)},DeleteSectionModalController.$inject=["lodash","Pages","Sections","section","close","$rootScope","$scope","isempty","$translate","ActiveSection","HomeComponentService","$q"],DeleteSectionModalController}();Components.DeleteSectionModalController=DeleteSectionModalController}(Components||(Components={})),angular.module("Components").controller("DeleteSectionModalController",Components.DeleteSectionModalController);var Components;!function(Components){var HomeDesigneditorController=function(){function HomeDesigneditorController($scope,$state,Site,$document,$timeout,HomeComponentService,EnvironmentService,$translate,Backgrounds,screenSize,UserEvents,lodash,User,Experiments,UrlService,VideoBackgroundsService,DesignereditorAssetsService,ModalService,$location,$anchorScroll,$css,$window,headersettings){var _this=this;this.$scope=$scope,this.$state=$state,this.Site=Site,this.$document=$document,this.$timeout=$timeout,this.HomeComponentService=HomeComponentService,this.EnvironmentService=EnvironmentService,this.$translate=$translate,this.Backgrounds=Backgrounds,this.screenSize=screenSize,this.UserEvents=UserEvents,this.lodash=lodash,this.User=User,this.Experiments=Experiments,this.UrlService=UrlService,this.VideoBackgroundsService=VideoBackgroundsService,this.DesignereditorAssetsService=DesignereditorAssetsService,this.ModalService=ModalService,this.$location=$location,this.$anchorScroll=$anchorScroll,this.$css=$css,this.$window=$window,this.headersettings=headersettings,this.fontPacksArrayFull=[],this.fontPacksArray=[],this.fontPacksArrayFree=[],this.fontPacksArrayPro=[],this.logosArray=[],this.logosArrayFree=[],this.logosArrayPro=[],this.more="none",this.colorSchemaArrayFull=this.lodash.range(1,49),this.debounceDelay=500,this.colorSchemaArray=[],this.uploadBackgroundProgress=0,this.colorSchemeToShow=4,this.fontPacksToShow=this.fontPacksArray.length,this.showing="none",this.designs=["stefan-asafti","webline","photographer_v4"],this.designTitles=[],this.layoutsShown=!0,this.Experiments.getTrack(Common.Services.ExperimentId.NEW_LAYOUTS,{createMode:!0}).then(function(track){"additionallayouts"===track.toLowerCase()&&(_this.layoutsShown=!0)}),this.Experiments.getTrack(Common.Services.ExperimentId.LAYOUT4,{createMode:!0}).then(function(track){"NewLayouts"==track&&_this.designs.indexOf("layout4")===-1&&_this.designs.push("layout4")}),this.hasPitchBox=!User.user.isPremiumCustomer,this.logosArrayFree=this.lodash.filter(DesignereditorAssetsService.logosArray,{Premium:!1}),this.logosArrayPro=this.lodash.filter(DesignereditorAssetsService.logosArray,{Premium:!0}),this.fontPacksArrayFull=DesignereditorAssetsService.fontPacksArrayFull,this.fontPacksArray=DesignereditorAssetsService.fontPacksArray,this.fontPacksArrayFree=DesignereditorAssetsService.fontPacksArrayFree,this.fontPacksArrayPro=DesignereditorAssetsService.fontPacksArrayPro;var cs=parseInt(Site.current.colorThemeName.split("sch")[1],10);this.colorSchemaArray=[],this.colorSchemaArray.unshift(cs);for(var i=0;this.colorSchemaArray.length<4;i++){var r=this.lodash.random(1,48);r===cs||this.lodash.includes(this.colorSchemaArray,r)||this.colorSchemaArray.push(r)}var fp=Site.current.fontPack;this.fontPacksArray=[],this.fontPacksArray.unshift(fp);for(var i=0;this.fontPacksArray.length<4;i++){var q=this.lodash.sample(this.fontPacksArrayFree);this.lodash.includes(this.fontPacksArray,q)||this.fontPacksArray.push(q)}this.isMobile=this.screenSize.is("xs, sm"),$timeout(function(){document.getElementsByTagName("body")[0]&&(document.getElementsByTagName("body")[0].className="",document.getElementsByTagName("body")[0].classList.add(_this.Site.current.colorThemeName),document.getElementsByTagName("body")[0].classList.add("layout_"+_this.Site.current.design))}),this.nonProBackgroundElements=this.buildBackgroundsList(!1),this.proBackgroundElements=this.buildBackgroundsList(!0),this.videoBackgrounds=[];for(var _i=9;_i<VideoBackgroundsService.videoBackgrounds.length;_i++)this.videoBackgrounds.push(VideoBackgroundsService.videoBackgrounds[_i]);this.hasBackground=!1,this.hasVideoBackground=!1,this.Site.get().then(function(){null!==_this.Site.current.backgroundImage?(_this.hasBackground=!0,_this.backgroundImageUrl=_this.Site.current.backgroundImage.url):(VideoBackgroundsService.setVideoBackground(_this.Site.current.videoBackgroundId),VideoBackgroundsService.currentVideoBackground&&(_this.hasVideoBackground=!0,_this.videoBackgroundId=VideoBackgroundsService.currentVideoBackground.backgroundId,_this.backgroundImageUrl=VideoBackgroundsService.currentVideoBackground.gifUrl)),_this.updateDesignTitles()}),this.updateDebounced=this.lodash.debounce(function(design){return _this.update(design)},this.debounceDelay),$scope.$watch("vm.HomeComponentService.sidebar",function(newValue,oldValue){newValue&&newValue.toString().indexOf("-")>-1&&(_this.scrollToLink=newValue.toString(),_this.scrollTo())})}return HomeDesigneditorController.prototype.update=function(design){var _this=this;this.Site.update(design)["finally"](function(){_this.working=!1})},HomeDesigneditorController.prototype.showProModal=function(){this.ModalService.showModal({templateUrl:"partials/home.offer/home.offer.html",controller:"HomeOfferController",controllerAs:"vm"}).then(function(modal){})["catch"](function(err){throw err})},HomeDesigneditorController.prototype.setColorScheme=function(colorThemeName,reorder){if(colorThemeName!==this.User.user.site.colorThemeName){if(this.UserEvents.send("V4ColorSchemeChanged"),reorder){var n=parseInt(colorThemeName.split("sch")[1],10);this.colorSchemaArray=[],this.colorSchemaArray.unshift(n);for(var i=0;this.colorSchemaArray.length<4;i++){var r=this.lodash.random(1,48);r===n||this.lodash.includes(this.colorSchemaArray,r)||this.colorSchemaArray.push(r)}}this.Site.current.colorThemeName=colorThemeName,document.getElementsByTagName("body")[0]&&(document.getElementsByTagName("body")[0].className="",document.getElementsByTagName("body")[0].classList.add(colorThemeName),document.getElementsByTagName("body")[0].classList.add("layout_"+this.Site.current.design)),this.$css.removeAll(),this.$css.add("/css/sitepreview_theme_"+this.Site.current.design+"_"+this.Site.current.colorThemeName+".css"),this.updateDebounced({colorThemeName:colorThemeName})}},HomeDesigneditorController.prototype.setBackground=function(backgroundElement){var _this=this;if(this.VideoBackgroundsService.setVideoBackground(-1),this.hasVideoBackground=!1,this.videoBackgroundId=-1,!(null!==backgroundElement&&this.User.user.site.backgroundImage&&backgroundElement.element.id===this.User.user.site.backgroundImage.id||this.working)){this.working=!0,this.UserEvents.send("V4BackgroundChanged");var backgroundType={picture:"PredefinedImage",pattern:"PredefinedPattern"};null===backgroundElement?(this.Site.update({videoBackgroundId:null,backgroundImage:null}),this.hasBackground=!1,this.working=!1,this.backgroundImageUrl=""):(this.hasBackground=!0,this.Site.update({videoBackgroundId:null,backgroundImage:{type:backgroundType[backgroundElement.type],id:backgroundElement.element.id}}).then(function(site){_this.Site.current.backgroundImage.url=site.backgroundImage.url,_this.backgroundImageUrl=site.backgroundImage.url})["finally"](function(){_this.working=!1}))}},HomeDesigneditorController.prototype.setVideoBackground=function(videoBackgroundId){this.VideoBackgroundsService.setVideoBackground(videoBackgroundId),this.Site.current.videoBackgroundId=videoBackgroundId,this.Site.update({backgroundImage:null,videoBackgroundId:videoBackgroundId}),this.hasBackground=!1,this.working=!1,this.videoBackgroundId=videoBackgroundId,this.UserEvents.send("V4BackgroundChanged"),this.VideoBackgroundsService.currentVideoBackground?(this.hasVideoBackground=!0,this.backgroundImageUrl=this.VideoBackgroundsService.currentVideoBackground.gifUrl):this.hasVideoBackground=!1},HomeDesigneditorController.prototype.setLogo=function(selectedLogo,removeImage){var _this=this;this.scrollToHeader(),this.UserEvents.send("V4LogoChanged");var LogoNameOrNull=selectedLogo?selectedLogo.LogoName:null,delta={logo:LogoNameOrNull};"image"==this.Site.current.logo&&removeImage&&(delta.logoImageId=0),this.Site.update(delta).then(function(site){_this.Site.current.logo=LogoNameOrNull})["finally"](function(){_this.working=!1})},HomeDesigneditorController.prototype.uploadBackgroundImage=function(file){var _this=this;this.working||(this.working=!0,file&&file.size>0?this.Site.uploadBackgroundImage(file).then(function(backgroundImage){_this.Site.current.backgroundImage=backgroundImage,_this.VideoBackgroundsService.setVideoBackground(-1),_this.backgroundImageUrl=_this.Site.current.backgroundImage.url},function(error){},function(progress){_this.uploadBackgroundProgress=progress})["finally"](function(){_this.uploadBackgroundProgress=0,_this.working=!1,_this.UserEvents.send("V4BackgroundChanged")}):this.working=!1)},HomeDesigneditorController.prototype.uploadLogoImage=function(file){var _this=this;this.scrollToHeader(),this.working||(this.working=!0,file&&file.size>0?this.Site.uploadLogoImage(file).then(function(logoImage){_this.Site.current.logoImage=logoImage,_this.Site.current.logo="image"},function(error){},function(progress){_this.uploadBackgroundProgress=progress})["finally"](function(){_this.uploadBackgroundProgress=0,_this.working=!1}):this.working=!1)},HomeDesigneditorController.prototype.setFonts=function(fontPack,reorder){if(!this.working){if(this.working=!0,this.UserEvents.send("V4FontChanged"),reorder){this.fontPacksArray=[],this.fontPacksArray.unshift(fontPack);for(var i=0;this.fontPacksArray.length<this.fontPacksToShow;i++){var q=this.lodash.sample(this.fontPacksArrayFree);this.lodash.includes(this.fontPacksArray,q)||this.fontPacksArray.push(q)}}this.Site.current.fontPack=fontPack,this.updateDebounced({fontPack:fontPack})}},HomeDesigneditorController.prototype.showMore=function(design_section){this.showing=design_section,this.more=design_section},HomeDesigneditorController.prototype.gotoCheckout=function(){window.location.href=this.UrlService.getCheckoutUrl()},HomeDesigneditorController.prototype.setDesign=function(design){var _this=this;this.working||(this.working=!0,"stefan-asafti"===design&&this.UserEvents.send("V4Layout1"),"webline"===design&&this.UserEvents.send("V4Layout2"),"photographer_v4"===design&&this.UserEvents.send("V4Layout3"),document.getElementsByTagName("body")[0].classList.remove("layout_"+this.Site.current.design),this.Site.current.design=design,this.HomeComponentService.design=design,document.getElementsByTagName("body")[0].classList.add("layout_"+this.Site.current.design),"layout4"==design?(this.headersettings.loadHeader(),this.headersettings.storeCurrentSetting().then(function(){_this.updateDebounced({design:design})})):this.updateDebounced({design:design}),this.$css.removeAll(),this.$css.add("/css/sitepreview_theme_"+design+"_"+this.Site.current.colorThemeName+".css?v=2132"))},HomeDesigneditorController.prototype.scrollToHeader=function(){this.$location.hash("site-preview"),this.$anchorScroll()},HomeDesigneditorController.prototype.scrollTo=function(){var parts=this.scrollToLink.split("-"),locationHash=this.scrollToLink;3===parts.length?(this.showing=parts[1],this.more=parts[1]):(this.showing="none",this.more="none"),this.$location.hash(locationHash),this.$anchorScroll(),this.HomeComponentService.sidebar="design"},HomeDesigneditorController.prototype.buildBackgroundsList=function(pro){var patterns=[],pictures=this.lodash.filter(this.Backgrounds.backgrounds,{pro:pro}),zipped=this.lodash.zip(pictures,patterns),elements=[];return this.lodash.each(zipped,function(zip){pro?(void 0!==zip[0]&&elements.push({type:"picture",pro:zip[0].pro,element:zip[0]}),void 0!==zip[1]&&elements.push({type:"pattern",pro:zip[1].pro,element:zip[1]})):(void 0!==zip[1]&&elements.push({type:"pattern",pro:zip[1].pro,element:zip[1]}),void 0!==zip[0]&&elements.push({type:"picture",pro:zip[0].pro,element:zip[0]}))}),elements},HomeDesigneditorController.prototype.backgroundSelected=function(currentBackgroundUrl,backgroundId){if(currentBackgroundUrl)return currentBackgroundUrl.indexOf(backgroundId)!==-1},HomeDesigneditorController.prototype.updateDesignTitles=function(){var _this=this;this.designTitles=[],this.$translate("HOME.DESIGN_EDITOR.DESIGN").then(function(designText){_this.designs.forEach(function(design,index,designs){var title=designText+"_"+(index+1).toString();_this.designTitles.push(title)}),_this.currentDesignTitle=_this.designTitles[_this.designs.indexOf(_this.Site.current.design)]})},HomeDesigneditorController.$inject=["$scope","$state","Site","$document","$timeout","HomeComponentService","EnvironmentService","$translate","Backgrounds","screenSize","UserEvents","lodash","User","Experiments","UrlService","VideoBackgroundsService","DesignereditorAssetsService","ModalService","$location","$anchorScroll","$css","$window","headersettings"],HomeDesigneditorController}();Components.HomeDesigneditorController=HomeDesigneditorController}(Components||(Components={})),angular.module("Components").controller("HomeDesigneditorController",Components.HomeDesigneditorController);var Components;!function(Components){var HomeDomainNotificationSplashController=function(){function HomeDomainNotificationSplashController($scope,User,close,HomeComponentService,CustomerFlagsService){var _this=this;this.$scope=$scope,this.User=User,this.close=close,this.HomeComponentService=HomeComponentService,this.CustomerFlagsService=CustomerFlagsService,this.closeModal=function(){_this.HomeComponentService.addressChoice||(_this.HomeComponentService.addressChoice="1"),_this.shown=!1},this.CustomerFlagsService.send("SignupDomainOfferShown"),this.shown=!0,this.title=this.User.user.salesPitches[4].texts.lines[0].text,this.bodyText=this.User.user.salesPitches[4].texts.lines[1].text,this.buttonText=this.User.user.salesPitches[4].texts.lines[2].text}return HomeDomainNotificationSplashController.$inject=["$scope","User","close","HomeComponentService","CustomerFlagsService"],HomeDomainNotificationSplashController}();Components.HomeDomainNotificationSplashController=HomeDomainNotificationSplashController}(Components||(Components={})),angular.module("Components").controller("HomeDomainNotificationSplashController",Components.HomeDomainNotificationSplashController);var Components;!function(Components){var HomeLayout4MobileMenuModal=function(){function HomeLayout4MobileMenuModal($scope,close,$state,Pages,Site){this.$scope=$scope,this.close=close,this.$state=$state,this.Pages=Pages,this.Site=Site,this.shown=!0,this.flatList=this.Pages.flatList}return HomeLayout4MobileMenuModal.prototype.gotoPage=function(pageId,categoryId,$event){this.cancel(),this.$state.go("home",{pageId:pageId,categoryId:categoryId}),$event.stopPropagation()},HomeLayout4MobileMenuModal.prototype.cancel=function(){this.shown=!1,this.close({})},HomeLayout4MobileMenuModal.$inject=["$scope","close","$state","Pages","Site"],HomeLayout4MobileMenuModal}();Components.HomeLayout4MobileMenuModal=HomeLayout4MobileMenuModal}(Components||(Components={})),angular.module("Components").controller("HomeLayout4MobileMenuModal",Components.HomeLayout4MobileMenuModal);var Components;!function(Components){var HomeMainmenuController=function(){function HomeMainmenuController($scope,Auth,$state,User,Pages,$location,HomeComponentService,EnvironmentService,HintService,UserEvents,ModalService,lodash,Experiments,UrlService,HelpboxService,$rootScope,ActiveSection,$anchorScroll,$window,$translate,SiteShareService,$timeout){var _this=this;this.$scope=$scope,this.Auth=Auth,this.$state=$state,this.User=User,this.Pages=Pages,this.$location=$location,this.HomeComponentService=HomeComponentService,this.EnvironmentService=EnvironmentService,this.HintService=HintService,this.UserEvents=UserEvents,this.ModalService=ModalService,this.lodash=lodash,this.Experiments=Experiments,this.UrlService=UrlService,this.HelpboxService=HelpboxService,this.$rootScope=$rootScope,this.ActiveSection=ActiveSection,
this.$anchorScroll=$anchorScroll,this.$window=$window,this.$translate=$translate,this.SiteShareService=SiteShareService,this.$timeout=$timeout,this.toggleEditmode=function(){_this.HomeComponentService.editmode?(_this.UserEvents.send("SeenPreview"),_this.HelpboxService.triggerTipsConditionChange("previewedWebsite"),_this.HomeComponentService.sidebar="none"):(null!=_this.HomeComponentService.activeSection&&(_this.$location.hash("section_"+_this.HomeComponentService.activeSection.sectionId),_this.$anchorScroll()),_this.HintService.isTourActive("PreviewTour")&&_this.$timeout(function(){_this.HintService.endTour("")},0)),_this.HomeComponentService.settingsmode||_this.HomeComponentService.subsDashboardMode?_this.HomeComponentService.subsDashboardMode?(_this.HomeComponentService.editmode=!0,_this.$state.go("home",{editmode:_this.HomeComponentService.editmode})):_this.UserEvents.send("ClickedEditYourWebsiteInSettingsMode"):(_this.HomeComponentService.editmode=!_this.HomeComponentService.editmode,_this.$state.go("home",{editmode:_this.HomeComponentService.editmode,pageId:_this.Pages.currentPage.pageId}))},this.setSidebar=function(sidebar_state){_this.HomeComponentService.sidebar==sidebar_state?_this.HomeComponentService.changeSidebarState("none"):("pages"===sidebar_state&&_this.UserEvents.send("SeenPageList"),"design"===sidebar_state&&(_this.UserEvents.send("SeenDesignEditor"),_this.HelpboxService.triggerTipsConditionChange("openedDesignOptions")),"account"==sidebar_state&&_this.HomeComponentService.settingsmode&&_this.UserEvents.send("ClickedAccountInSettingsMode"),_this.HomeComponentService.changeSidebarState(sidebar_state))},this.clickListener=function($event){angular.element(".share-box__popup").find($event.target).length<=0&&!angular.element($event.target).hasClass("share-box__popup")&&_this.closeShareBox()},this.redirect=function(link,pageid){"SUBSCRIPTION_LINK"===link&&_this.UserEvents.send("SeenAccountArea");var redirurl;Common.V3Links[link]&&(redirurl=Common.V3Links[link],window.location.href=_this.UrlService.getV3Url(redirurl))},this.clickedLiveSite=function(){_this.UserEvents.send("ClickedLiveSite")},this.ExamplesClicked=function(){_this.UserEvents.send("V4E69Clicks")},this.user=User.user,this.domainPath=Common.Globals.DOMAIN_PATH,this.websiteUrl="http://"+this.user.fullUrl,this.websiteUrlDisplay=this.user.fullUrl,this.isMobile=EnvironmentService.isMobile}return HomeMainmenuController.prototype.isBeaconActive=function(tour,hintId){return!(!this.HintService.isTourActive(tour)||!this.HintService.isHintActive(hintId))},HomeMainmenuController.prototype.runEditModeChangeWithAnimations=function(){var _this=this,allListItems=angular.element(document.getElementById("main-menu-bar")).find(".menu-group-right li");this.runAnimationOnListItems(allListItems,function(el){return _this.$timeout(function(){angular.element(el).addClass("animate-leave animate-leave-active")},200)},function(){_this.$timeout(function(){_this.HomeComponentService.editmode=!_this.HomeComponentService.editmode,_this.$state.go("home",{editmode:_this.HomeComponentService.editmode,pageId:_this.Pages.currentPage.pageId}),_this.$timeout(function(){var allListItems1=angular.element(document.getElementById("main-menu-bar")).find(".menu-group-right li");allListItems1.addClass("animate-enter animate-enter-active animate-leave animate-leave-active"),_this.runAnimationOnListItems(allListItems1,function(el1){return _this.$timeout(function(){angular.element(el1).removeClass("animate-leave animate-leave-active")},200)},null)})},350)})},HomeMainmenuController.prototype.runAnimationOnListItems=function(objects,doSomething,onFinish){function next(){cntr<objects.length?doSomething(objects[cntr++]).then(next):onFinish&&onFinish()}var cntr=0;next()},HomeMainmenuController.prototype.setPreviewMode=function(mode){this.HomeComponentService.previewMode=mode,mode==Components.PreviewMode.MOBILE&&(this.HintService.isTourActive("PreviewTour")&&this.HintService.deactiveStep("PreviewHint2"),this.UserEvents.send("SeenMobilePreview"))},HomeMainmenuController.prototype.showCentralLabel=function(){return this.HomeComponentService.subsDashboardMode},HomeMainmenuController.prototype.getCentralLabelKey=function(){var dmode=this.HomeComponentService.mainMenuDisplayMode;return dmode==Components.MainMenuDisplayMode.DASHBOARD?"SUBSCRIPTION.SUBSAREA.DASHBOARD_TITLE":dmode==Components.MainMenuDisplayMode.SUBSCRIPTION?"SUBSCRIPTION.SUBSAREA.SUBSCRIPTION_TITLE":dmode==Components.MainMenuDisplayMode.PAYMENTS?"SUBSCRIPTION.SUBSAREA.PAYMENTS_TITLE":dmode==Components.MainMenuDisplayMode.PAYMENTS_LIST?"SUBSCRIPTION.SUBSAREA.INVOICES_TITLE":dmode==Components.MainMenuDisplayMode.SITENAME?"SUBSCRIPTION.SUBSAREA.WEBSITE_TITLE":""},HomeMainmenuController.prototype.goBack=function(){var dmode=this.HomeComponentService.mainMenuDisplayMode;dmode==Components.MainMenuDisplayMode.DASHBOARD?this.$state.go("home",{editmode:!0}):dmode==Components.MainMenuDisplayMode.SUBSCRIPTION?this.$state.go("subscriptionDashboard"):dmode==Components.MainMenuDisplayMode.PAYMENTS?this.$state.go("subscriptionDashboard"):dmode==Components.MainMenuDisplayMode.PAYMENTS_LIST?this.$state.go("paymentsDashboard"):dmode==Components.MainMenuDisplayMode.SITENAME?this.$state.go("subscriptionDashboard"):alert("Missing state")},HomeMainmenuController.prototype.closeShareBox=function(){this.showShareBox&&(this.showShareBox=!1,this.$window.removeEventListener("click",this.clickListener),angular.element(".share-input-wrapper").removeClass("share-input-wrapper-show"))},HomeMainmenuController.prototype.openShareBox=function(event){if(event&&event.stopImmediatePropagation(),this.EnvironmentService.isMobile)this.ModalService.showModal({templateUrl:"partials/home.mainmenu/home.sharebox.modal.html",controller:"ShareBoxModalController",controllerAs:"vm"});else{if(this.showShareBox)return void this.closeShareBox();angular.element(document.getElementsByClassName("share-box__popup")).css("left",event.pageX-event.offsetX),this.HomeComponentService.changeSidebarState("none"),this.showShareBox=!0,this.$window.addEventListener("click",this.clickListener)}},HomeMainmenuController.prototype.shareToFacebook=function(){this.SiteShareService.shareToFacebook(),this.closeShareBox()},HomeMainmenuController.prototype.shareToTwitter=function(){this.SiteShareService.shareToTwitter(),this.closeShareBox()},HomeMainmenuController.prototype.shareToGoogle=function(){this.SiteShareService.shareToGoogle(),this.closeShareBox()},HomeMainmenuController.prototype.shareToEmail=function(){this.SiteShareService.shareToEmail(),this.closeShareBox()},HomeMainmenuController.prototype.copyToClipboard=function($event,selector){return $event.preventDefault(),this.SiteShareService.copyToClipboard(selector),angular.element(selector).parent().addClass("share-input-wrapper-show"),!1},HomeMainmenuController.prototype.showPremiumOffer=function(){this.UserEvents.send("MobilePremiumOfferIconClicked"),this.ModalService.showModal({templateUrl:"partials/home.premiumoffermobilemodal/home.premiumoffermobilemodal.html",controller:"PremiumOfferMobileController",controllerAs:"vm"})},HomeMainmenuController.prototype.removeHtmlTags=function(textWithHtmlTags){var div=document.createElement("div");return div.innerHTML=textWithHtmlTags,div.textContent||div.innerText||""},HomeMainmenuController.prototype.retrieveFirstElementInSections=function(objProp){var returnVal,keepGoing=!0;this.Pages.currentPage.sections.forEach(function(section,ind){keepGoing&&section.hasOwnProperty(objProp)&&section[objProp].url&&(returnVal=section[objProp].url,keepGoing=!1)})},HomeMainmenuController.$inject=["$scope","Auth","$state","User","Pages","$location","HomeComponentService","EnvironmentService","HintService","UserEvents","ModalService","lodash","Experiments","UrlService","HelpboxService","$rootScope","ActiveSection","$anchorScroll","$window","$translate","SiteShareService","$timeout"],HomeMainmenuController}();Components.HomeMainmenuController=HomeMainmenuController}(Components||(Components={})),angular.module("Components").controller("HomeMainmenuController",Components.HomeMainmenuController);var Common;!function(Common){var Directives;!function(Directives){var ShareBoxModalController=function(){function ShareBoxModalController(close,SiteShareService){this.close=close,this.SiteShareService=SiteShareService,this.shown=!0}return ShareBoxModalController.prototype.closeModal=function(){this.shown=!1,this.close({},0)},ShareBoxModalController.prototype.shareToFacebook=function(){this.SiteShareService.shareToFacebook(),this.closeModal()},ShareBoxModalController.prototype.shareToTwitter=function(){this.SiteShareService.shareToTwitter(),this.closeModal()},ShareBoxModalController.prototype.shareToGoogle=function(){this.SiteShareService.shareToGoogle(),this.closeModal()},ShareBoxModalController.prototype.shareToEmail=function(){this.SiteShareService.shareToEmail(),this.closeModal()},ShareBoxModalController.prototype.copyToClipboard=function(selector){this.SiteShareService.copyToClipboard(selector),angular.element(selector).parent().addClass("share-input-wrapper-show")},ShareBoxModalController.prototype.redirect=function(link){this.SiteShareService.redirect(link)},ShareBoxModalController.$inject=["close","SiteShareService"],ShareBoxModalController}();Directives.ShareBoxModalController=ShareBoxModalController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("ShareBoxModalController",Common.Directives.ShareBoxModalController);var Components;!function(Components){var HomeManageCommentsController=function(){function HomeManageCommentsController($scope,$state,User,Pages,lodash){var _this=this;this.$scope=$scope,this.$state=$state,this.User=User,this.Pages=Pages,this.lodash=lodash,this.User.getCommentsPage(0).then(function(res){_this.comments=res})}return HomeManageCommentsController.prototype.approveComment=function(comment){var _this=this;this.User.approveComment(comment.commentId).then(function(res){res&&(_this.lodash.filter(_this.comments.commentsList,{commentId:comment.commentId})[0].approved=2)})},HomeManageCommentsController.prototype.deleteComment=function(comment){var _this=this;this.User.deleteComment(comment.commentId).then(function(res){res&&_this.lodash.remove(_this.comments.commentsList,{commentId:comment.commentId})})},HomeManageCommentsController.prototype.deleteAndBlockComment=function(comment){var _this=this;this.User.deleteAndBlockComment(comment.commentId).then(function(res){res&&_this.lodash.remove(_this.comments.commentsList,{commentId:comment.commentId})})},HomeManageCommentsController.prototype.menuVisible=function(){return!1},HomeManageCommentsController.$inject=["$scope","$state","User","Pages","lodash"],HomeManageCommentsController}();Components.HomeManageCommentsController=HomeManageCommentsController}(Components||(Components={})),angular.module("Components").controller("HomeManageCommentsController",Components.HomeManageCommentsController);var Common;!function(Common){var Directives;!function(Directives){var MaximumPagesModalController=function(){function MaximumPagesModalController($q,lodash,UrlService,User,$window,close){this.$q=$q,this.lodash=lodash,this.UrlService=UrlService,this.User=User,this.$window=$window,this.close=close,this.shown=!0}return MaximumPagesModalController.prototype.closeModal=function(){this.shown=!1,this.close({},0)},MaximumPagesModalController.prototype.redirectToUpgrade=function(){var deferred=this.$q.defer(),pitch=this.lodash.find(this.User.user.salesPitches,{name:"MoreInfoOnPROModal"});return this.$window.location.href=this.UrlService.getUpgradeUrl(pitch),deferred.promise},MaximumPagesModalController.$inject=["$q","lodash","UrlService","User","$window","close"],MaximumPagesModalController}();Directives.MaximumPagesModalController=MaximumPagesModalController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("MaximumPagesModalController",Common.Directives.MaximumPagesModalController);var Common;!function(Common){var Directives;!function(Directives){var NewPageNameModalController=function(){function NewPageNameModalController(UserEvents,$q,Pages,HomeComponentService,HelpboxService,$state,ModalService,headersettings,MdNotificationService,close,pageId){this.UserEvents=UserEvents,this.$q=$q,this.Pages=Pages,this.HomeComponentService=HomeComponentService,this.HelpboxService=HelpboxService,this.$state=$state,this.ModalService=ModalService,this.headersettings=headersettings,this.MdNotificationService=MdNotificationService,this.close=close,this.pageId=pageId,this.shown=!0}return NewPageNameModalController.prototype.closeModal=function(){this.shown=!1,this.close({},0)},NewPageNameModalController.prototype.addPage=function(){var _this=this,deferred=this.$q.defer();return this.UserEvents.send("AddPage"),this.Pages.add(this.HomeComponentService.newPageType,this.newPageTitle,this.pageId).then(function(page){_this.$state.go("home",{pageId:page.pageId}),_this.HelpboxService.triggerTipsConditionChange("addedPage"),deferred.resolve(!0)})["catch"](function(reason){deferred.resolve(!0),_this.Pages.flatList.length>=15&&deferred.promise.then(function(){_this.ModalService.showModal({templateUrl:"partials/home.maximumpagenumbermodal/home.maximumpagenumbermodal.html",controller:"MaximumPagesModalController",controllerAs:"vm"})})}),deferred.promise},NewPageNameModalController.$inject=["UserEvents","$q","Pages","HomeComponentService","HelpboxService","$state","ModalService","headersettings","MdNotificationService","close","pageId"],NewPageNameModalController}();Directives.NewPageNameModalController=NewPageNameModalController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("NewPageNameModalController",Common.Directives.NewPageNameModalController);var Components;!function(Components){var HomeOfferController=function(){function HomeOfferController($scope,User,$window,close,$location,lodash,UrlService,UserEvents,EnvironmentService){this.$scope=$scope,this.User=User,this.$window=$window,this.close=close,this.$location=$location,this.lodash=lodash,this.UrlService=UrlService,this.UserEvents=UserEvents,this.EnvironmentService=EnvironmentService,this.pitch=this.lodash.find(this.User.user.salesPitches,{name:"MoreInfoOnPROModal"}),this.shown=!0}return HomeOfferController.prototype["continue"]=function(){this.UserEvents.send("V4ClosePROTeaser"),this.shown=!1,this.close({},800)},HomeOfferController.prototype.upgrade=function(){this.UserEvents.send("V4TeaserToCheckout"),this.$window.location.href=this.UrlService.getUpgradeUrl(this.pitch),this["continue"]()},HomeOfferController.prototype.anotherDomain=function(){this.UserEvents.send("V4TeaserToSearchDomain"),this.$window.location.href=this.UrlService.getAnotherDomainUrl(this.pitch),this["continue"]()},HomeOfferController.$inject=["$scope","User","$window","close","$location","lodash","UrlService","UserEvents","EnvironmentService"],HomeOfferController}();Components.HomeOfferController=HomeOfferController}(Components||(Components={})),angular.module("Components").controller("HomeOfferController",Components.HomeOfferController);var Components;!function(Components){"use strict";var HomePagesOverviewComponentService=function(){function HomePagesOverviewComponentService(){var _this=this;this.openPageOptions=function(event){_this.controller.openPageOptions(event)}}return HomePagesOverviewComponentService}();Components.HomePagesOverviewComponentService=HomePagesOverviewComponentService}(Components||(Components={})),angular.module("Components").service("HomePagesOverviewComponentService",Components.HomePagesOverviewComponentService);var Components;!function(Components){var HomePagesoverviewController=function(){function HomePagesoverviewController($scope,$state,Pages,User,EnvironmentService,HomeComponentService,ActiveSection,HomePagesOverviewComponentService,$window,screenSize,Dialog,UserEvents,lodash,WebshopService,UrlService,Experiments,ModalService,HelpboxService,$translate,$element,$location,$anchorScroll,$q){var _this=this;this.$scope=$scope,this.$state=$state,this.Pages=Pages,this.User=User,this.EnvironmentService=EnvironmentService,this.HomeComponentService=HomeComponentService,this.ActiveSection=ActiveSection,this.HomePagesOverviewComponentService=HomePagesOverviewComponentService,this.$window=$window,this.screenSize=screenSize,this.Dialog=Dialog,this.UserEvents=UserEvents,this.lodash=lodash,this.WebshopService=WebshopService,this.UrlService=UrlService,this.Experiments=Experiments,this.ModalService=ModalService,this.HelpboxService=HelpboxService,this.$translate=$translate,this.$element=$element,this.$location=$location,this.$anchorScroll=$anchorScroll,this.$q=$q,this.showPageOptionsFlag=!1,this.clickListener=function(){_this.closePageOptions()},this.hasPitchBox=!User.user.isPremiumCustomer,this.HomePagesOverviewComponentService.controller=this,this.dragDisable=!1,this.currentPage=Pages.currentPage,this.isMobile=this.screenSize.is("xs, sm"),this.user=User,this.domainPath=Common.Globals.DOMAIN_PATH,this.title="HomePagesoverviewControllerTitle",this.initPageList(),$scope.$watch("vm.Pages.list",function(){_this.initPageList()},!0),$scope.$watch("vm.HomeComponentService.sidebar",function(newValue,oldValue){newValue!==oldValue&&_this.closePageOptions()}),this.Experiments.getTrack(Common.Services.ExperimentId.UPGRADE_TO_PAGELIST).then(function(track){_this.pitchBoxType=track}),this.Experiments.getTrack(Common.Services.ExperimentId.ADD_PAGE_REMOVE).then(function(track){_this.experimentAddButton=track}),this.$translate("HOME.TOO_LONG_INPUT").then(function(text){_this.pagenameTooLongErrorText=text}),this.$translate("HOME.ERROR").then(function(text){_this.errorText=text}),this.scrollToPage(this.currentPage.pageId),this.treeOptions={defaultCollapsed:!1,appendChildOnHover:!0,accept:function(sourceNodeScope,destNodesScope,destIndex){return!(sourceNodeScope.$modelValue.subPages.length>0&&destNodesScope.depth()>0)&&(!(sourceNodeScope.$parentNodeScope&&destNodesScope.depth()>0&&0==destIndex)&&(!(sourceNodeScope.$modelValue.isMainShopPage&&destNodesScope.depth()>0)&&!(destNodesScope.$parent&&destNodesScope.$parent.$modelValue&&destNodesScope.$parent.$modelValue.isMainShopPage)))},dropped:function(event){var page=event.source.index>=0?event.source.nodesScope.$modelValue[event.source.index]:null,previous=event.dest.index-1>=0?event.dest.nodesScope.$modelValue[event.dest.index-1]:null,parent=event.dest.nodesScope.$nodeScope?event.dest.nodesScope.$nodeScope.$modelValue:null;Pages.order(page.pageId,{newParentPageId:parent?parseInt(parent.pageId):-1,newPreviousPageId:previous?parseInt(previous.pageId):-1})}}}return HomePagesoverviewController.prototype.initPageList=function(){this.pageList=this.Pages.clonedList;var shopPage=this.lodash.find(this.pageList,{isMainShopPage:!0});shopPage&&(shopPage.subPages=[])},HomePagesoverviewController.prototype.scrollToPage=function(pageId){var currentEnvironment=this.EnvironmentService.isIE()?"ie":this.EnvironmentService.isMobile?"mobile":"something else";switch(currentEnvironment){case"ie":break;default:this.$location.hash("anchor"+pageId)}this.$anchorScroll()},HomePagesoverviewController.prototype.doneReordering=function(){this.reordering=!1},HomePagesoverviewController.prototype.showDeletePage=function(){var _this=this;this.closePageOptions(),this.isMobile&&!this.EnvironmentService.iOs9OrSmaller?this.Dialog.showConfirm(["HOME.PAGES_OVERVIEW.DELETE_MODAL.REALLY",this.currentPage],function(yes){yes&&_this.deletePage(_this.currentPage.pageId)}):this.ModalService.showModal({templateUrl:"partials/home.deletepagemodal/home.deletepagemodal.html",controller:"DeletePageModalController",controllerAs:"vm",inputs:{page:this.currentPage}}).then(function(modal){modal.close.then(function(pageId){pageId&&_this.deletePage(pageId)})})},HomePagesoverviewController.prototype.showRenamePage=function(){var _this=this;this.closePageOptions(),this.isMobile&&!this.EnvironmentService.iOs9OrSmaller?this.Dialog.showPrompt("","HOME.PAGES_OVERVIEW.UPDATE_MODAL.CHANGE_TITLE",function(newPageTitle){newPageTitle&&(newPageTitle.length>20||_this.updatePage(newPageTitle))}):this.ModalService.showModal({templateUrl:"partials/home.updatepagenamemodal/home.updatepagenamemodal.html",controller:"UpdatePageNameModalController",controllerAs:"vm",inputs:{newPageTitle:this.currentPage.pageName}}).then(function(modal){modal.close.then(function(title){title&&(title.length>20||_this.updatePage(title))})})},HomePagesoverviewController.prototype.showReorderPage=function(){this.closePageOptions(),this.reordering=!0},HomePagesoverviewController.prototype.closePageOptions=function(){this.showPageOptionsFlag&&(this.showPageOptionsFlag=!1,this.tether&&this.tether.disable(),this.$window.removeEventListener("click",this.clickListener))},HomePagesoverviewController.prototype.openPageOptions=function(event){return event.stopImmediatePropagation(),this.showPageOptionsFlag?void this.closePageOptions():(this.showPageOptionsFlag=!0,this.tether&&(this.tether.position(),this.tether.enable()),void this.$window.addEventListener("click",this.clickListener))},HomePagesoverviewController.prototype.gotoWebshopManager=function(){this.$window.location.href=this.UrlService.getWebshopManageUrl()},HomePagesoverviewController.prototype.showAddPageSelector=function(pageId){this.ModalService.showModal({templateUrl:"partials/home.addpagemodal/addpagemodal.html",controller:"AddPageModalController",controllerAs:"vm",inputs:{pageId:pageId}})},HomePagesoverviewController.prototype.deletePage=function(pageId){var _this=this,def=this.$q.defer(),goToPageId=this.Pages.getPageIdToGoAfterDelete(pageId);return this.Pages["delete"](pageId).then(function(data){def.resolve(!0),_this.$state.go("home",{pageId:goToPageId})}),def.promise},HomePagesoverviewController.prototype.updatePage=function(newTitle){var _this=this,deferred=this.$q.defer();return this.currentPage.pageName=newTitle,this.HelpboxService.triggerTipsConditionChange("renamedPage"),this.Pages.update(this.currentPage.pageId,this.currentPage).then(function(page){_this.Pages.findPage(_this.currentPage.pageId).pageName=newTitle,deferred.resolve(!0)}),deferred.promise},HomePagesoverviewController.prototype.deactivateSections=function(){this.HomeComponentService.activeSection=null,this.ActiveSection.activeSectionId=null},HomePagesoverviewController.$inject=["$scope","$state","Pages","User","EnvironmentService","HomeComponentService","ActiveSection","HomePagesOverviewComponentService","$window","screenSize","Dialog","UserEvents","lodash","WebshopService","UrlService","Experiments","ModalService","HelpboxService","$translate","$element","$location","$anchorScroll","$q"],HomePagesoverviewController}();Components.HomePagesoverviewController=HomePagesoverviewController}(Components||(Components={})),angular.module("Components").controller("HomePagesoverviewController",Components.HomePagesoverviewController);var Components;!function(Components){var HomePaymentsController=function(){function HomePaymentsController($scope,$state,User,Pages,HomeComponentService){var _this=this;this.$scope=$scope,this.$state=$state,this.User=User,this.Pages=Pages,this.HomeComponentService=HomeComponentService,this.HomeComponentService.subsDashboardMode=!0,this.HomeComponentService.mainMenuDisplayMode=Components.MainMenuDisplayMode.PAYMENTS,this.User.getPaymentsDetails().then(function(resp){_this.model=resp})}return HomePaymentsController.prototype.subscibeNewCreditCard=function(){this.User.subscibeNewCreditCard().then(function(form){angular.element(document.body).append(form)})},HomePaymentsController.prototype.stopPaymentService=function(){var _this=this;this.User.stopPaymentService().then(function(res){_this.User.user.isPaymentServiceActive=!res,_this.User.getPaymentsDetails().then(function(resp){_this.model=resp})})},HomePaymentsController.$inject=["$scope","$state","User","Pages","HomeComponentService"],HomePaymentsController}();Components.HomePaymentsController=HomePaymentsController}(Components||(Components={})),angular.module("Components").controller("HomePaymentsController",Components.HomePaymentsController);var Components;!function(Components){var HomePaymentsListController=function(){function HomePaymentsListController($scope,$state,User,HomeComponentService){var _this=this;this.$scope=$scope,this.$state=$state,this.User=User,this.HomeComponentService=HomeComponentService,this.orders=[],this.HomeComponentService.subsDashboardMode=!0,this.HomeComponentService.mainMenuDisplayMode=Components.MainMenuDisplayMode.PAYMENTS_LIST,this.User.getPastOrders().then(function(ord){_this.orders=ord})}return HomePaymentsListController.$inject=["$scope","$state","User","HomeComponentService"],HomePaymentsListController}();Components.HomePaymentsListController=HomePaymentsListController}(Components||(Components={})),angular.module("Components").controller("HomePaymentsListController",Components.HomePaymentsListController);var Common;!function(Common){var Directives;!function(Directives){var PremiumOfferMobileController=function(){function PremiumOfferMobileController(close,$window,User,lodash,UrlService,UserEvents){this.close=close,this.$window=$window,this.User=User,this.lodash=lodash,this.UrlService=UrlService,this.UserEvents=UserEvents,this.pitch=this.lodash.find(this.User.user.salesPitches,{name:"PremiumOfferMobile"}),this.shown=!0,this.showSpinny=!1}return PremiumOfferMobileController.prototype.redirectToUpgradePage=function($event){$event.preventDefault(),this.showSpinny=!0,this.UserEvents.send("MobilePremiumOfferUpgradeClicked"),this.$window.location.href=this.UrlService.getV3Url(this.pitch.texts.links[0].link)},PremiumOfferMobileController.$inject=["close","$window","User","lodash","UrlService","UserEvents"],PremiumOfferMobileController}();Directives.PremiumOfferMobileController=PremiumOfferMobileController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("PremiumOfferMobileController",Common.Directives.PremiumOfferMobileController);var Components;!function(Components){var HomePreviewController=function(){function HomePreviewController($scope,$state,Pages,Sections,$anchorScroll,$location,previewResolve,$document,Site,$q,nl2brFilter,ModalService,screenSize,Images,HomeComponentService,HomePreviewComponentService,EnvironmentService,Backgrounds,Dialog,HintService,User,UserEvents,Experiments,lodash,UrlService,CustomerFlagsService,tmhDynamicLocale,$filter,HelpboxService,$window,ActiveSection,$compile,WebshopService,$sce,$timeout){var _this=this;this.$scope=$scope,this.$state=$state,this.Pages=Pages,this.Sections=Sections,this.$anchorScroll=$anchorScroll,this.$location=$location,this.previewResolve=previewResolve,this.$document=$document,this.Site=Site,this.$q=$q,this.nl2brFilter=nl2brFilter,this.ModalService=ModalService,this.screenSize=screenSize,this.Images=Images,this.HomeComponentService=HomeComponentService,this.HomePreviewComponentService=HomePreviewComponentService,this.EnvironmentService=EnvironmentService,this.Backgrounds=Backgrounds,this.Dialog=Dialog,this.HintService=HintService,this.User=User,this.UserEvents=UserEvents,this.Experiments=Experiments,this.lodash=lodash,this.UrlService=UrlService,this.CustomerFlagsService=CustomerFlagsService,this.tmhDynamicLocale=tmhDynamicLocale,this.$filter=$filter,this.HelpboxService=HelpboxService,this.$window=$window,this.ActiveSection=ActiveSection,this.$compile=$compile,this.WebshopService=WebshopService,this.$sce=$sce,this.$timeout=$timeout,this.isCommentsInfoBoxCollapsed=!0,this.isHeadlineSectionActive=!1,this.htmlString="",this.showTitleTetherBox=!1,this.showTetherBox="",this.mobileFrameLoaded=!1,this.checkWelcomeScreen=function(){!Cookies.get(Common.Services.CookieNames.OFFERMODAL)||"en-US"!=_this.User.user.culture&&"en-GB"!=_this.User.user.culture||_this.CustomerFlagsService.hasFlag("V4SeenWelcomeScreenBTP").then(function(hasFlag){!hasFlag&&_this.HomeComponentService.editmode&&(_this.CustomerFlagsService.send("V4SeenWelcomeScreenBTP"),_this.ModalService.showModal({templateUrl:"partials/home.welcome/home.welcome.html",controller:"HomeWelcomeController",controllerAs:"vm"}).then(function(modal){modal.close.then(function(){})}))})},this.checkNewEditorSeenVersion45=function(){_this.Experiments.getTrack(Common.Services.ExperimentId.NEW_EDITOR).then(function(track){"NewEditorNotSeen"==track&&_this.ModalService.showModal({templateUrl:"partials/home.seenneweditor45/home.seenneweditor45.html",controller:"HomeSeenNewEditor45Controller",controllerAs:"vm"})})},this.checkDomainSplash=function(){var isPremiumCustomer=_this.User.user.isPremiumCustomer;if(isPremiumCustomer){var dRegistered=_this.User.user.cdCreationDate,dFeatureImplemented=new Date(2016,8,15,15,1,1,0),isRegisteredAfterFeature=dRegistered>dFeatureImplemented;isRegisteredAfterFeature&&_this.CustomerFlagsService.hasFlag("V3DomainNotificationSplashSeen").then(function(hasFlag){hasFlag||_this.CustomerFlagsService.send("V3DomainNotificationSplashSeen").then(function(_response){_this.showDomainSplash()})["catch"](function(_err){})})}},this.checkBottomViralBanner=function(){var isPremiumCustomer=_this.User.user.isPremiumCustomer;_this.Experiments.getTrack(Common.Services.ExperimentId.BOTTOM_BANNER,{createMode:!0}).then(function(track){"BottomViralBanner"!=track||isPremiumCustomer||(_this.hasBottomViralBannerTrack=!0)})},this.showDomainSplash=function(){_this.ModalService.showModal({templateUrl:"partials/home.domainnotificationsplash/home.domainnotificationsplash.html",controller:"HomeDomainNotificationSplashController",controllerAs:"vm"})},this.addSection=function(type,index){void 0===type&&(type="Text"),void 0===index&&(index=0);var def=_this.$q.defer(),section=null;return 1==index&&0==_this.Pages.currentPage.sections.length&&(index=0),"Video"===type&&(type="InternalMedia"),section=_this.lodash.find(_this.Sections.getBaseSectionTypes(),function(st){return st.type===type}),section.index=index,"TextLeft"!==type&&"TextRight"!==type&&"TextNoImage"!==type||(section.type="Text"),_this.Sections.add(_this.Pages.currentPage.pageType,_this.Pages.currentPage.pageId,section).then(function(data){section.initSection=!0,angular.extend(section,data.data),_this.Pages.currentPage.sections.splice(index,0,section),_this.HomePreviewComponentService.sectionIdJustAdded=section.sectionId,_this.ActiveSection.activeSectionId=section.sectionId,_this.HomeComponentService.activeSection=section,_this.HomeComponentService.editmode=!1,_this.HomeComponentService.sidebar="none";var sectionId="section_"+_this.ActiveSection.activeSectionId;_this.$location.hash(sectionId),_this.$anchorScroll(),def.resolve(section)},function(){def.reject()}),def.promise},this.openDeleteModal=function(section,isEmpty){if(_this.deleteIndexSection=section,_this.EnvironmentService.isMobile&&!_this.EnvironmentService.iOs9OrSmaller){var message=["HOME.PREVIEW.DELETE_MODAL.REALLY"];isEmpty&&(message=["HOME.PREVIEW.DELETE_MODAL.IS_EMPTY"]),_this.Dialog.showConfirm(message,function(yes){yes&&_this.deleteSection(_this.deleteIndexSection)})}else _this.ModalService.showModal({templateUrl:"partials/home.deletesectionmodal/home.deletesectionmodal.html",controller:"DeleteSectionModalController",controllerAs:"vm",inputs:{section:section,isempty:isEmpty}})},this.deleteSection=function(section){section.sectionId?_this.Sections["delete"](_this.Pages.currentPage.pageType,_this.Pages.currentPage.pageId,section.type,section.sectionId).then(function(){_this.lodash.remove(_this.Pages.currentPage.sections,{sectionId:section.sectionId}),_this.HomeComponentService.activeSection=null,_this.ActiveSection.activeSectionId=null,_this.HomeComponentService.editmode=!0}):_this.Pages.currentPage.sections.splice(section.index,1)},this.gotoCheckout=function(){window.location.href=_this.UrlService.getCheckoutUrl();
},this.HomePreviewComponentService.controller=this,this.Pages.currentPage=previewResolve.page||{},this.site=previewResolve.site||{},this.pages=Pages.list,this.hasBottomViralBannerTrack=!1,this.checkBottomViralBanner(),this.isCommentsInfoBoxCollapsed=!0,this.hasWebshop=WebshopService.hasWebshop(this.pages);var signUpToken=Cookies.get(Common.Services.CookieNames.SIGNEDUP_TOKEN);signUpToken?this.includeRemarketingScript=!1:(Cookies.set(Common.Services.CookieNames.SIGNEDUP_TOKEN,"signedup"),this.includeRemarketingScript=this.User.user.loginCount<2);var loggedInToken=Cookies.get(Common.Services.CookieNames.LOGGEDIN_TOKEN);loggedInToken||this.includeRemarketingScript?this.includeRemarketingScript2=!1:(Cookies.set(Common.Services.CookieNames.LOGGEDIN_TOKEN,"loggedin",{expires:1}),this.includeRemarketingScript2=!0),this.paymentStatus=this.User.user.isPremiumCustomer?"subscription":"freemium",this.includeRemarketingScript?this.adFormSignupTracking():this.includeRemarketingScript2&&this.adFormLoginTracking(this.paymentStatus);var currentCulture=this.User.user.culture,currentLocale=currentCulture.substr(0,currentCulture.indexOf("-"));moment.locale(currentLocale),tmhDynamicLocale.set(currentLocale).then(function(data){}),angular.element("#site-preview").on("click",function(event){"none"!==_this.HomeComponentService.sidebar&&EnvironmentService.isMobile&&(_this.HomeComponentService.sidebar="none")}),this.checkDomainSplash(),Cookies.get(Common.Services.CookieNames.OFFERMODAL)||this.User.user.loginCount>0||this.Experiments.getTrack(Common.Services.ExperimentId.BETTER_DOMAIN_MOBILE).then(function(track){_this.EnvironmentService.isMobile&&"BetterDomainPitch"!=track?_this.EnvironmentService.isMobile&&(Cookies.set(Common.Services.CookieNames.OFFERMODAL,!0,Common.Globals.DEFAULT_COOKIE_SETTINGS),_this.HintService.startTour("AddContentTour")):_this.ModalService.showModal({templateUrl:"partials/home.chooseaddress/home.chooseaddress.simple.html",controller:"HomeChooseAddressController",controllerAs:"vm"}).then(function(modal){Cookies.set(Common.Services.CookieNames.OFFERMODAL,!0,Common.Globals.DEFAULT_COOKIE_SETTINGS),modal.close.then(function(result){_this.HintService.startTour("AddContentTour"),_this.UserEvents.send("DomainOfferInEcoSysNo")})})}),this.checkNewEditorSeenVersion45(),this.isHelpboxExperimentEnabled=!1,EnvironmentService.isMobile||this.HelpboxService.isExperimentEnabled().then(function(enabled){_this.isHelpboxExperimentEnabled=enabled}),HomeComponentService.design=Site.current.design;var eventName=this.EnvironmentService.isMobile?"PreviewLoadedMobile":"PreviewLoadedDesktop";this.UserEvents.send(eventName),$scope.$watch("vm.HomeComponentService.previewMode",function(newValue,oldValue){newValue!=oldValue&&newValue==Components.PreviewMode.MOBILE&&(_this.mobileFrameLoaded=!1)})}return HomePreviewController.prototype.fullWidthEditing=function(){if(this.User.user)return this.User.user.isPremiumCustomer&&!this.User.user.isFaceBookShareEnabled},HomePreviewController.prototype.openOfferModal=function(){this.UserEvents.send("V4E80Clicks"),this.ModalService.showModal({templateUrl:"partials/home.offer/home.offer.html",controller:"HomeOfferController",controllerAs:"vm"})},HomePreviewController.prototype.getMobilePreviewUrl=function(){var url=this.UrlService.getV3Url(Common.V3Links.BUILDER_PATH+"version3/view/"+this.Pages.currentPage.pageId);return this.$sce.trustAsResourceUrl(url)},HomePreviewController.prototype.frameLoaded=function(){var _this=this;this.$timeout(function(){_this.mobileFrameLoaded=!0})},HomePreviewController.prototype.adFormLoginTracking=function(paymentStatus){this.$window._adftrack={pm:694479,divider:encodeURIComponent("|"),pagename:encodeURIComponent("Simplesite.com|Successful login|"+paymentStatus)};var s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src="https://track.adform.net/serving/scripts/trackpoint/async/";var x=document.getElementsByTagName("script")[0];x.parentNode.insertBefore(s,x)},HomePreviewController.prototype.adFormSignupTracking=function(){this.$window._adftrack={pm:694479,divider:encodeURIComponent("|"),pagename:encodeURIComponent("Step 8 Confirmation")};var s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src="https://track.adform.net/serving/scripts/trackpoint/async/";var x=document.getElementsByTagName("script")[0];x.parentNode.insertBefore(s,x)},HomePreviewController.prototype.getCounter=function(){for(var number=this.User.user.siteCounter,output=[],sNumber=number.toString(),i=0,len=sNumber.length;i<len;i+=1)output.push(+sNumber.charAt(i));for(;output.length<=5;)output.unshift("0");return output},HomePreviewController.prototype.activateEditHeadline=function(){this.isHeadlineSectionActive=!0},HomePreviewController.prototype.deActivateEditHeadline=function(){this.isHeadlineSectionActive=!1},HomePreviewController.$inject=["$scope","$state","Pages","Sections","$anchorScroll","$location","previewResolve","$document","Site","$q","nl2brFilter","ModalService","screenSize","SectionImagesApi","HomeComponentService","HomePreviewComponentService","EnvironmentService","Backgrounds","Dialog","HintService","User","UserEvents","Experiments","lodash","UrlService","CustomerFlagsService","tmhDynamicLocale","$filter","HelpboxService","$window","ActiveSection","$compile","WebshopService","$sce","$timeout"],HomePreviewController}();Components.HomePreviewController=HomePreviewController}(Components||(Components={})),angular.module("Components").controller("HomePreviewController",Components.HomePreviewController);var Components;!function(Components){"use strict";var HomePreviewComponentService=function(){function HomePreviewComponentService(){var _this=this;this.addSection=function(type){return _this.controller.addSection(type,_this.sectionIndex)},this.openDeleteModal=function(section,isEmpty){return _this.controller.openDeleteModal(section,isEmpty)}}return HomePreviewComponentService}();Components.HomePreviewComponentService=HomePreviewComponentService}(Components||(Components={})),angular.module("Components").service("HomePreviewComponentService",Components.HomePreviewComponentService);var Components;!function(Components){var PageController=function(){function PageController($scope,Pages,$rootScope){this.$scope=$scope,this.Pages=Pages,this.$rootScope=$rootScope,this.page=this.Pages.currentPage}return PageController.prototype.save=function(){this.Pages.update(this.page.pageId,this.page)},PageController}();Components.PageController=PageController}(Components||(Components={}));var Components;!function(Components){var AddressPageController=function(){function AddressPageController($scope,Pages,HomeComponentService,HomePreviewComponentService,EnvironmentService,$translate,lodash,GoogleMaps,$rootScope,ActiveSection,NgMap){var _this=this;this.$scope=$scope,this.Pages=Pages,this.HomeComponentService=HomeComponentService,this.HomePreviewComponentService=HomePreviewComponentService,this.EnvironmentService=EnvironmentService,this.$translate=$translate,this.lodash=lodash,this.GoogleMaps=GoogleMaps,this.$rootScope=$rootScope,this.ActiveSection=ActiveSection,this.NgMap=NgMap,this.map={},this.justClosedInfo=!1,this.mapLoaded=!1,this.saveMap=function(){_this.save({}),_this.googleMapWrapper.centerMap()},this.addressPage=this.Pages.currentPage,this.addressPage.googleMap.latitude=+this.addressPage.googleMap.latitude,this.addressPage.googleMap.longitude=+this.addressPage.googleMap.longitude,this.$translate("HOME.ADDRESS.PHONE_INVALID").then(function(text){_this.phoneErrorTitle=text}),this.$translate("HOME.ADDRESS.PHONE_INVALID_MESSAGE").then(function(text){_this.phoneErrorMessage=text}),this.$translate("HOME.ADDRESS.EMAIL_INVALID").then(function(text){_this.emailErrorTitle=text}),this.$translate("HOME.ADDRESS.EMAIL_INVALID_MESSAGE").then(function(text){_this.emailErrorMessage=text}),this.addressPage.googleMap.mapType||(this.addressPage.googleMap.mapType="roadmap"),GoogleMaps.init().then(function(){_this.mapLoaded=!0;var suffix="2";_this.NgMap.getMap({id:"gmap"+suffix}).then(function(m){_this.map=m,_this.googleMapWrapper=new Common.Models.GoogleMapsWrapper(m,"infoWindow"+suffix,"gmapMarker"+suffix)}).then(function(){_this.googleMapWrapper.setMapScroll(!1),_this.googleMapWrapper.setMapDrag(!1),_this.googleMapWrapper.setMapScroll(!1),_this.googleMapWrapper.centerMap(),_this.addressPage.googleMap.visible&&_this.addressPage.googleMap.showBubble&&_this.openInfoWindow()})}),this.save=this.lodash.debounce(function(formObject){return _this.savefast(formObject)},1e3),this.originalPage={},this.addressId="address"}return AddressPageController.prototype.activate=function(){if(null==this.HomeComponentService.activeSection){if(this.isActive())return;this.HomeComponentService.editmode&&(angular.copy(this.addressPage,this.originalPage),this.EnvironmentService.isMobile||(this.googleMapWrapper.setMapScroll(!0),this.googleMapWrapper.setMapDrag(!0)),this.HomeComponentService.activeSection=this.addressId,this.ActiveSection.activeSectionId=this.addressId,this.HomeComponentService.editmode=!1,this.HomeComponentService.sidebar="none")}},AddressPageController.prototype.deactivate=function(){this.HomeComponentService.activeSection=null,this.ActiveSection.activeSectionId=null,this.HomeComponentService.editmode=!0},AddressPageController.prototype.save_v2=function($event){var _this=this;if($event.stopPropagation(),this.map.getZoom&&this.map.markers&&this.map.markers.gmapMarker2){var zoomLevel=this.map.getZoom(),lat=this.map.markers.gmapMarker2.position.lat(),lng=this.map.markers.gmapMarker2.position.lng(),mapType=this.map.mapTypeId;this.addressPage.googleMap.zoomLevel=zoomLevel,this.addressPage.googleMap.latitude=lat,this.addressPage.googleMap.longitude=lng,this.addressPage.googleMap.mapType=mapType,this.Pages.update(this.addressPage.pageId,this.addressPage).then(function(){_this.googleMapWrapper.setMapDrag(!1),_this.googleMapWrapper.setMapScroll(!1),_this.googleMapWrapper.centerMap(),_this.isEmailInvalid=!1,_this.deactivate()})["catch"](function(error){_this.invalidEmail()})}},AddressPageController.prototype.isActive=function(){return this.ActiveSection.isActive(this.addressId)},AddressPageController.prototype.cancel=function($event){$event.stopPropagation(),this.addressPage=angular.copy(this.originalPage),this.isEmailInvalid=!1,this.googleMapWrapper.setMapDrag(!1),this.googleMapWrapper.setMapScroll(!1),this.googleMapWrapper.centerMap(),this.googleMapWrapper.setZoom(this.addressPage.googleMap.zoomLevel),this.deactivate()},AddressPageController.prototype.savefast=function(formObject){if(formObject){var isValid=!0;if(formObject.contactEmail&&formObject.contactEmail.$invalid&&""!==this.addressPage.contact.email&&(this.invalidEmail(),isValid=!1),isValid&&this.map.getZoom&&this.map.markers&&this.map.markers.gmapMarker){var zoomLevel=this.map.getZoom(),lat=this.map.markers.gmapMarker.position.lat(),lng=this.map.markers.gmapMarker.position.lng(),mapType=this.map.mapTypeId;this.addressPage.googleMap.zoomLevel=zoomLevel,this.addressPage.googleMap.latitude=lat,this.addressPage.googleMap.longitude=lng,this.addressPage.googleMap.mapType=mapType,this.Pages.update(this.addressPage.pageId,this.addressPage)}}},AddressPageController.prototype.invalidPhone=function(){},AddressPageController.prototype.invalidEmail=function(){this.isEmailInvalid=!0},AddressPageController.prototype.checkBubble=function(){this.addressPage.googleMap.showBubble?this.openInfoWindow():this.closeInfoWindow()},AddressPageController.prototype.checkBubbleText=function(){if(this.addressPage.googleMap.showBubble){var currentBubbleText=this.addressPage.googleMap.bubbleText;""===currentBubbleText?this.closeInfoWindow():this.justClosedInfo&&this.openInfoWindow()}},AddressPageController.prototype.openInfoWindow=function(){this.justClosedInfo=!1,this.googleMapWrapper.openInfoWindow()},AddressPageController.prototype.closeInfoWindow=function(){this.googleMapWrapper.closeInfoWindow(),this.justClosedInfo=!0},AddressPageController.$inject=["$scope","Pages","HomeComponentService","HomePreviewComponentService","EnvironmentService","$translate","lodash","GoogleMaps","$rootScope","ActiveSection","NgMap"],AddressPageController}();Components.AddressPageController=AddressPageController}(Components||(Components={})),angular.module("Components").controller("AddressPageController",Components.AddressPageController);var Components;!function(Components){var ContactMePageController=function(_super){function ContactMePageController($scope,Pages,HomeComponentService,EnvironmentService,UrlService,$rootScope,Site,ActiveSection,$translate){_super.call(this,$scope,Pages,$rootScope),this.$scope=$scope,this.Pages=Pages,this.HomeComponentService=HomeComponentService,this.EnvironmentService=EnvironmentService,this.UrlService=UrlService,this.$rootScope=$rootScope,this.Site=Site,this.ActiveSection=ActiveSection,this.$translate=$translate,this.isCollapsed=!1,Cookies.get(Common.Services.CookieNames.CONTACTME_INFOBOX)&&(this.isCollapsed=!0),this.contactMePage=this.Pages.currentPage,this.originalPage={},this.contactId="contact",Cookies.get(Common.Services.CookieNames.NEWLY_CREATED_PAGE)===this.contactMePage.pageId&&(this.contactMePage.title=this.$translate.instant("HOME.PREVIEW.CONTACT_ME.TITLE_DEFAULT"),this.contactMePage.text=this.$translate.instant("HOME.PREVIEW.CONTACT_ME.TEXT_DEFAULT"),this.save_v2(),Cookies.remove(Common.Services.CookieNames.NEWLY_CREATED_PAGE))}return __extends(ContactMePageController,_super),ContactMePageController.prototype.activate=function(){if(null==this.HomeComponentService.activeSection){if(this.isActive())return;this.HomeComponentService.editmode&&(this.HomeComponentService.editmode=!1,this.HomeComponentService.sidebar="none",angular.copy(this.contactMePage,this.originalPage),this.HomeComponentService.activeSection=this.contactId,this.ActiveSection.activeSectionId=this.contactId)}},ContactMePageController.prototype.save_v2=function($event){var _this=this;null!=$event&&$event.stopPropagation(),this.Pages.update(this.contactMePage.pageId,this.contactMePage).then(function(){_this.deactivate()})},ContactMePageController.prototype.isActive=function(){return this.ActiveSection.isActive(this.contactId)},ContactMePageController.prototype.cancel=function($event){null!=$event&&$event.stopPropagation(),this.contactMePage=angular.copy(this.originalPage),this.deactivate()},ContactMePageController.prototype.deactivate=function(){this.HomeComponentService.activeSection=null,this.ActiveSection.activeSectionId=null,this.HomeComponentService.editmode=!0},ContactMePageController.prototype.collapseInfoBox=function(){Cookies.set(Common.Services.CookieNames.CONTACTME_INFOBOX,!1,Common.Globals.DEFAULT_COOKIE_SETTINGS)},ContactMePageController.$inject=["$scope","Pages","HomeComponentService","EnvironmentService","UrlService","$rootScope","Site","ActiveSection","$translate"],ContactMePageController}(Components.PageController);Components.ContactMePageController=ContactMePageController}(Components||(Components={})),angular.module("Components").controller("ContactMePageController",Components.ContactMePageController);var Components;!function(Components){var PhotoalbumModalController=function(){function PhotoalbumModalController(close,page){this.close=close,this.page=page,this.beforeSettingsOpenState={},this.shown=!0,this.beforeSettingsOpenState.currentTransition=this.page.currentTransition,this.beforeSettingsOpenState.showSlideshow=this.page.showSlideshow}return PhotoalbumModalController.prototype.closeModal=function(){this.shown=!1,this.close({},0)},PhotoalbumModalController.prototype.cancel=function(){this.page.currentTransition=this.beforeSettingsOpenState.currentTransition,this.page.showSlideshow=this.beforeSettingsOpenState.showSlideshow,this.closeModal()},PhotoalbumModalController.prototype.apply=function(){this.closeModal()},PhotoalbumModalController.$inject=["close","page"],PhotoalbumModalController}();Components.PhotoalbumModalController=PhotoalbumModalController}(Components||(Components={})),angular.module("Components").controller("PhotoalbumModalController",Components.PhotoalbumModalController);var Components;!function(Components){var PhotoalbumPageController=function(_super){function PhotoalbumPageController($scope,$state,$translate,Pages,PhotoAlbum,HomeComponentService,lodash,UserEvents,$rootScope,ActiveSection,EnvironmentService,ModalService){var _this=this;_super.call(this,$scope,Pages,$rootScope),this.$scope=$scope,this.$state=$state,this.$translate=$translate,this.Pages=Pages,this.PhotoAlbum=PhotoAlbum,this.HomeComponentService=HomeComponentService,this.lodash=lodash,this.UserEvents=UserEvents,this.$rootScope=$rootScope,this.ActiveSection=ActiveSection,this.EnvironmentService=EnvironmentService,this.ModalService=ModalService,this.uploads=[],this.uploadProgress=null,this.beforeSettingsOpenState={},this.slideshowActivated=!0,angular.copy(this.page,this.beforeSettingsOpenState),this.setupTransitionTypes(),this.initializeSlideshow(),this.originalPage={},this.photoAlbumId="photoalbum",Cookies.get(Common.Services.CookieNames.NEWLY_CREATED_PAGE)===this.page.pageId&&(this.page.title=this.$translate.instant("HOME.PREVIEW.PHOTO_ALBUM.TITLE_DEFAULT"),this.page.text=this.$translate.instant("HOME.PREVIEW.PHOTO_ALBUM.TEXT_DEFAULT"),this.save_v2(),Cookies.remove(Common.Services.CookieNames.NEWLY_CREATED_PAGE)),this.dragControlListeners={accept:function(parameter){return!0},dragStart:function(parameter){},dragEnd:function(parameter){},itemMoved:function(event){},orderChanged:function(event){var img=event.dest.sortableScope.modelValue[event.dest.index];_this.PhotoAlbum.moveImage(_this.Pages.currentPage.pageId,img.imageContainerId,event.dest.index)}}}return __extends(PhotoalbumPageController,_super),PhotoalbumPageController.prototype.initializeSlideshow=function(){this.slideshowActivated=!0,this.page.currentTransition=this.mapTransitionType(this.page.slideshowTransitionType).id},PhotoalbumPageController.prototype.toggleSettings=function(){this.EnvironmentService.isMobile?this.ModalService.showModal({templateUrl:"partials/home.preview.photoalbum/home.preview.photoalbum.modal.html",controller:"PhotoalbumModalController",controllerAs:"vm",inputs:{page:this.page}}).then(function(modal){modal.close.then(function(){})}):(this.beforeSettingsOpenState.currentTransition=this.page.currentTransition,this.beforeSettingsOpenState.showSlideshow=this.page.showSlideshow,this.showSettings=!this.showSettings)},PhotoalbumPageController.prototype.cancelSettingsChange=function(){this.page.currentTransition=this.beforeSettingsOpenState.currentTransition,this.page.showSlideshow=this.beforeSettingsOpenState.showSlideshow,this.toggleSettings()},PhotoalbumPageController.prototype.setupTransitionTypes=function(){this.transitionTypes=[{id:"Fade",translationKey:"FADE",v3Type:"Normal"},{id:"Cubic",translationKey:"CUBIC",v3Type:"Black"},{id:"Stripe",translationKey:"STRIPE",v3Type:"White"},{id:"Slide",translationKey:"SLIDE",v3Type:"Zoom"},{id:"UpDown",translationKey:"UPDOWN",v3Type:"Slide"},{id:"Random",translationKey:"RANDOM",v3Type:"Text"}]},PhotoalbumPageController.prototype.mapTransitionType=function(v3Type){if(!v3Type)return this.transitionTypes[0];var transition=this.lodash.find(this.transitionTypes,{v3Type:v3Type});if(!transition)throw new Error("unkown transition type: "+v3Type);return transition},PhotoalbumPageController.prototype.handleTransitionTypeChanged=function(transition){this.page.currentTransition=transition,this.page.slideshowTransitionType=this.lodash.find(this.transitionTypes,{id:this.page.currentTransition}).v3Type,this.save()},PhotoalbumPageController.prototype.upload=function(files){var errors=[];if(files&&files.length){this.UserEvents.send("PhotoalbumUploadV4"),this.uploads=files,this.uploadProgress=0;var uploadCount=files.length;this.uploadSingleFile(this.uploads[this.uploadProgress],uploadCount,errors)}},PhotoalbumPageController.prototype.uploadSingleFile=function(file,uploadCount,errors){var _this=this;this.slideshowActivated=!1,this.PhotoAlbum.uploadImage(this.page.pageId,file).then(function(data){},function(error){errors.push(error)},function(progress){})["finally"](function(){_this.uploadProgress++,_this.uploadProgress<uploadCount?_this.uploadSingleFile(_this.uploads[_this.uploadProgress],uploadCount,errors):_this.uploadProgress==uploadCount&&(_this.uploadProgress=null,_this.Pages.get(_this.page.pageId).then(function(page){_this.page=page,_this.initializeSlideshow()}),errors.length>0&&_this.lodash.each(errors,function(error){_this.$translate("HOME.PREVIEW.PHOTO_ALBUM.FILE_NOT_UPLOADED").then(function(title){})}))})},PhotoalbumPageController.prototype.saveImage=function(image){this.PhotoAlbum.updateImage(this.Pages.currentPage.pageId,image)},PhotoalbumPageController.prototype.handleImageDeleted=function(imageId){this.lodash.remove(this.page.photos,function(p){return p.imageContainerId===imageId})},PhotoalbumPageController.prototype.handleImageClicked=function(image){this.HomeComponentService.editmode||(this.fullscreenImageId=image.id)},PhotoalbumPageController.prototype.activate=function(){if(null==this.HomeComponentService.activeSection){if(this.isActive())return;this.HomeComponentService.editmode&&(this.HomeComponentService.editmode=!1,this.HomeComponentService.sidebar="none",angular.copy(this.page,this.originalPage),this.HomeComponentService.activeSection=this.photoAlbumId,this.ActiveSection.activeSectionId=this.photoAlbumId)}},PhotoalbumPageController.prototype.save_v2=function($event){var _this=this;null!=$event&&$event.stopPropagation(),this.handleTransitionTypeChanged(this.page.currentTransition),this.Pages.update(this.page.pageId,this.page).then(function(){_this.deactivate()})},PhotoalbumPageController.prototype.isActive=function(){return this.ActiveSection.isActive(this.photoAlbumId)},PhotoalbumPageController.prototype.cancel=function($event){$event.stopPropagation(),this.page=angular.copy(this.originalPage),this.deactivate()},PhotoalbumPageController.prototype.deactivate=function(){this.HomeComponentService.activeSection=null,this.ActiveSection.activeSectionId=null,this.HomeComponentService.editmode=!0},PhotoalbumPageController.$inject=["$scope","$state","$translate","Pages","PhotoAlbum","HomeComponentService","lodash","UserEvents","$rootScope","ActiveSection","EnvironmentService","ModalService"],PhotoalbumPageController}(Components.PageController);Components.PhotoalbumPageController=PhotoalbumPageController}(Components||(Components={})),angular.module("Components").controller("PhotoalbumPageController",Components.PhotoalbumPageController);var Components;!function(Components){var StandardPageController=function(){function StandardPageController($scope,Pages,HomeComponentService,HomePreviewComponentService,EnvironmentService,lodash,$window,ActiveSection){var _this=this;this.$scope=$scope,this.Pages=Pages,this.HomeComponentService=HomeComponentService,this.HomePreviewComponentService=HomePreviewComponentService,this.EnvironmentService=EnvironmentService,this.lodash=lodash,this.$window=$window,this.ActiveSection=ActiveSection,this.file=[],this.sortingcontrols=[],this.sections=this.Pages.currentPage.sections,this.$window.addEventListener("click",function(){_this.$scope.$apply(function(){_this.sortingcontrols=_this.sortingcontrols.map(function(v){return v=!1})})})}return StandardPageController.$inject=["$scope","Pages","HomeComponentService","HomePreviewComponentService","EnvironmentService","lodash","$window","ActiveSection"],StandardPageController}();Components.StandardPageController=StandardPageController}(Components||(Components={})),angular.module("Components").controller("StandardPageController",Components.StandardPageController);var Components;!function(Components){var WebshopPageController=function(){function WebshopPageController($scope,Pages,ModalService,Site,HomeComponentService,EnvironmentService){var _this=this;this.$scope=$scope,this.Pages=Pages,this.ModalService=ModalService,this.Site=Site,this.HomeComponentService=HomeComponentService,this.EnvironmentService=EnvironmentService,this.webshop=Pages.currentPage,this.$scope.$on("product-element-clicked",function(){_this.showTestOrEditModal()})}return WebshopPageController.prototype.showTestOrEditModal=function(){this.ModalService.showModal({templateUrl:"partials/home.preview.webshop/webshop.test.edit.modal.html",controller:"WebshopTestOrEditModalController",controllerAs:"vm",inputs:{}})},WebshopPageController.$inject=["$scope","Pages","ModalService","Site","HomeComponentService","EnvironmentService"],WebshopPageController}();Components.WebshopPageController=WebshopPageController}(Components||(Components={})),angular.module("Components").controller("WebshopPageController",Components.WebshopPageController);var Components;!function(Components){var WebshopTestOrEditModalController=function(){function WebshopTestOrEditModalController($window,Pages,UrlService,UserEvents,close){this.$window=$window,this.Pages=Pages,this.UrlService=UrlService,this.UserEvents=UserEvents,this.close=close;var webshopPage=this.Pages.currentPage;this.testWebshopUrl=this.UrlService.getWebshopLiveUrl(webshopPage.pageId,webshopPage.categoryId),this.shown=!0}return WebshopTestOrEditModalController.prototype.handleEditClicked=function(){var url=this.UrlService.getWebshopManageUrl();this.$window.location.href=url},WebshopTestOrEditModalController.prototype["continue"]=function(){this.shown=!1,this.close({},800)},WebshopTestOrEditModalController.$inject=["$window","Pages","UrlService","UserEvents","close"],WebshopTestOrEditModalController}();Components.WebshopTestOrEditModalController=WebshopTestOrEditModalController}(Components||(Components={})),angular.module("Components").controller("WebshopTestOrEditModalController",Components.WebshopTestOrEditModalController);var Components;!function(Components){var HomeRemoveAdSplashController=function(){function HomeRemoveAdSplashController(User,$window,close,$location,UrlService,UserEvents,EnvironmentService,lodash,$translate){var _this=this;this.User=User,this.$window=$window,this.close=close,this.$location=$location,this.UrlService=UrlService,this.UserEvents=UserEvents,this.EnvironmentService=EnvironmentService,this.lodash=lodash,this.$translate=$translate,this.pitch=lodash.find(User.user.salesPitches,{name:"SalesPitchRemoveAd"}),this.shown=!0,this.$translate("HOME.REMOVEADSPLASH.COPY").then(function(text){_this.ReplacePrice=text.replace("[_price_]",_this.pitch.texts.lines[0].text)}),this.UserEvents.send("RemoveAdBannerClicked")}return HomeRemoveAdSplashController.prototype["continue"]=function(){this.shown=!1,this.close({},800)},HomeRemoveAdSplashController.prototype.upgrade=function(){this.UserEvents.send("RemoveAdBannerTakeMe2Checkout"),this.$window.location.href=this.UrlService.getV3Url(this.pitch.texts.links[0].link),this["continue"]()},HomeRemoveAdSplashController.$inject=["User","$window","close","$location","UrlService","UserEvents","EnvironmentService","lodash","$translate"],HomeRemoveAdSplashController}();Components.HomeRemoveAdSplashController=HomeRemoveAdSplashController}(Components||(Components={})),angular.module("Components").controller("HomeRemoveAdSplashController",Components.HomeRemoveAdSplashController);var Components;!function(Components){var HomeSeenNewEditor45Controller=function(){function HomeSeenNewEditor45Controller($scope,close,User,$translate){this.$scope=$scope,this.close=close,this.User=User,this.$translate=$translate,this.shown=!0}return HomeSeenNewEditor45Controller.prototype.okClose=function(){this.shown=!1,this.close({},800)},HomeSeenNewEditor45Controller.$inject=["$scope","close","User","$translate"],HomeSeenNewEditor45Controller}();Components.HomeSeenNewEditor45Controller=HomeSeenNewEditor45Controller}(Components||(Components={})),angular.module("Components").controller("HomeSeenNewEditor45Controller",Components.HomeSeenNewEditor45Controller);var Components;!function(Components){var SelectImageModalController=function(){function SelectImageModalController(ModalService,HomeComponentService,close,UserEvents,MdNotificationService,$translate){this.ModalService=ModalService,this.HomeComponentService=HomeComponentService,this.close=close,this.UserEvents=UserEvents,this.MdNotificationService=MdNotificationService,this.$translate=$translate,this.shown=!0}return SelectImageModalController.prototype.showLibraryModal=function(){this.shown=!1,this.UserEvents.send("V4ImageLibraryOpened"),this.ModalService.showModal({templateUrl:"partials/home.addimagemodal/addimagemodal.html",controller:"AddImageModalController",controllerAs:"vm"})},SelectImageModalController.prototype.uploadImage=function(file){var _this=this;null!=file&&(file.type.match(/(jpg|jpeg|gif|png|bmp)$/)?this.close({file:file},500):this.$translate("HOME.PREVIEW.SS_IMAGE.WRONG_FILETYPE").then(function(text){_this.MdNotificationService.showErrorToast(text)}))},SelectImageModalController.$inject=["ModalService","HomeComponentService","close","UserEvents","MdNotificationService","$translate"],SelectImageModalController}();Components.SelectImageModalController=SelectImageModalController}(Components||(Components={})),angular.module("Components").controller("SelectImageModalController",Components.SelectImageModalController);var Components;!function(Components){var SelectImageModalPixabayController=function(){function SelectImageModalPixabayController(ModalService,HomeComponentService,close,UserEvents,PhotoAlbum,EnvironmentService,$http){this.ModalService=ModalService,this.HomeComponentService=HomeComponentService,this.close=close,this.UserEvents=UserEvents,this.PhotoAlbum=PhotoAlbum,this.EnvironmentService=EnvironmentService,this.$http=$http,this.showLibrary=!1,this.closeActionOff=!0,this.shown=!0,this.images=[],this.numberOfPages=1,this.currentQurry="",this.EnvironmentService.isMobile?(this.perPage=4,this.numberOfColumns=1):(this.perPage=9,this.numberOfColumns=3)}return SelectImageModalPixabayController.prototype.nextClick=function(){this.currentPage=this.currentPage+1,this.searchImages(this.currentQurry,this.currentPage)},SelectImageModalPixabayController.prototype.previousClick=function(){this.currentPage=this.currentPage-1,this.searchImages(this.currentQurry,this.currentPage)},SelectImageModalPixabayController.prototype.searchQuery=function(query){this.searchImages(query,1),this.currentQurry=query,this.currentPage=1},SelectImageModalPixabayController.prototype.searchImages=function(query,pageNr){var _this=this;this.showLibrary=!0,this.UserEvents.send("PerformPhotoAPISearch"),this.PhotoAlbum.getImagesFromPixabay(query,pageNr,this.perPage).then(function(data){_this.handleSucces(data),_this.numberOfPages=Math.ceil(data.totalHits/9)},function(err){})},SelectImageModalPixabayController.prototype.handleSucces=function(data){this.images=data.hits,this.imageColumns=this.partion(this.images,this.images.length/this.numberOfColumns)},SelectImageModalPixabayController.prototype.partion=function(input,size){for(var newArr=[],i=0;i<input.length;i+=size)newArr.push(input.slice(i,i+size));return newArr},SelectImageModalPixabayController.prototype.uploadImageFromPixabay=function(url){var _this=this;this.UserEvents.send("V4ImageLibraryImageClicked");this.PhotoAlbum.getImageFromPixabay(url).then(function(data){data.name="name.jpg",_this.close(data)});this.shown=!1},SelectImageModalPixabayController.prototype.uploadImage=function(file){this.close({file:file},500)},SelectImageModalPixabayController.$inject=["ModalService","HomeComponentService","close","UserEvents","PhotoAlbum","EnvironmentService","$http"],SelectImageModalPixabayController}();Components.SelectImageModalPixabayController=SelectImageModalPixabayController}(Components||(Components={})),angular.module("Components").controller("SelectImageModalPixabayController",Components.SelectImageModalPixabayController);var Components;!function(Components){var HomeSettingsController=function(){function HomeSettingsController($scope,$state,User,HomeComponentService){this.$scope=$scope,
this.$state=$state,this.User=User,this.HomeComponentService=HomeComponentService,this.HomeComponentService.editmode=!0,this.HomeComponentService.settingsmode=!0,this.HomeComponentService.sidebar="none"}return HomeSettingsController.prototype.menuVisible=function(){return this.HomeComponentService.subsDashboardMode},HomeSettingsController.$inject=["$scope","$state","User","HomeComponentService"],HomeSettingsController}();Components.HomeSettingsController=HomeSettingsController}(Components||(Components={})),angular.module("Components").controller("HomeSettingsController",Components.HomeSettingsController);var Components;!function(Components){var SidebarController=function(){function SidebarController($scope,HomeComponentService,EnvironmentService,$document,$window){var _this=this;this.$scope=$scope,this.HomeComponentService=HomeComponentService,this.EnvironmentService=EnvironmentService,this.$document=$document,this.$window=$window,$scope.$watch("vm.HomeComponentService.sidebar",function(newValue,oldValue){if(newValue)if(newValue.toString().indexOf("-")>-1){var sidebar=newValue.toString().split("-")[0];_this.currentSidebar=sidebar}else _this.currentSidebar=newValue.toString()})}return SidebarController.$inject=["$scope","HomeComponentService","EnvironmentService","$document","$window"],SidebarController}();Components.SidebarController=SidebarController}(Components||(Components={})),angular.module("Components").controller("SidebarController",Components.SidebarController);var Components;!function(Components){var HomeSiteStatsController=function(){function HomeSiteStatsController($scope,$state,User,Pages,HomeComponentService){var _this=this;this.$scope=$scope,this.$state=$state,this.User=User,this.Pages=Pages,this.HomeComponentService=HomeComponentService,this.siteCounterEnabled=this.User.user.siteCounterEnabled,this.weeklyMailOptIn=this.User.user.weeklyMailOptIn,this.shareWidgetEnabled=this.User.user.isFaceBookShareEnabled,this.siteCounter=this.User.user.siteCounter,this.User.getCountsForStats().then(function(data){for(var pages,_loop_1=function(i){pages=_this.Pages.list.filter(function(pg){return 0==pg.pageId.indexOf(data[i].pageID.toString())}),pages&&pages.length>0?data[i].pageName=pages[0].pageName:data.splice(i,1)},i=0;i<data.length;i++)_loop_1(i);_this.pages=data})}return HomeSiteStatsController.prototype.siteCounterChange=function(){this.User.setSiteCounter(this.siteCounterEnabled)},HomeSiteStatsController.prototype.weeklyMailOptInChange=function(){this.User.setWeeklyMailOptIn(this.weeklyMailOptIn)},HomeSiteStatsController.prototype.shareWidgetChange=function(){this.User.setShareWidget(this.shareWidgetEnabled)},HomeSiteStatsController.prototype.viewPageClicked=function(page){var url=this.$state.href("home",{pageId:page.pageID});window.open(url,"_blank")},HomeSiteStatsController.prototype.menuVisible=function(){return!1},HomeSiteStatsController.$inject=["$scope","$state","User","Pages","HomeComponentService"],HomeSiteStatsController}();Components.HomeSiteStatsController=HomeSiteStatsController}(Components||(Components={})),angular.module("Components").controller("HomeSiteStatsController",Components.HomeSiteStatsController);var Components;!function(Components){var HomeSubscriptionDashboardController=function(){function HomeSubscriptionDashboardController($scope,$state,User,Pages,HomeComponentService,EnvironmentService,$location,$anchorScroll,UrlService,$window,$translate,lodash){var _this=this;this.$scope=$scope,this.$state=$state,this.User=User,this.Pages=Pages,this.HomeComponentService=HomeComponentService,this.EnvironmentService=EnvironmentService,this.$location=$location,this.$anchorScroll=$anchorScroll,this.UrlService=UrlService,this.$window=$window,this.$translate=$translate,this.lodash=lodash,this.alerts=[],this.showAlerts=!0,this.HomeComponentService.subsDashboardMode=!0,this.HomeComponentService.mainMenuDisplayMode=Components.MainMenuDisplayMode.DASHBOARD,this.User.getAlerts().then(function(alerts){_this.alerts=alerts})}return HomeSubscriptionDashboardController.prototype.scrollToAlerts=function(){angular.element(document.getElementById("alerts-box")).removeClass("alerts-animation"),this.$location.hash("alerts-box"),this.$anchorScroll(),angular.element(document.getElementById("alerts-box")).addClass("alerts-animation")},HomeSubscriptionDashboardController.prototype.search=function(){var _this=this;if(this.searchText){this.error="";var url="//www."+Common.Globals.DOMAIN_PATH+"/builder/pages/SubscriptionCheckout.aspx?cnvt=3&search=true&domname="+encodeURIComponent(this.searchText);this.$window.location.href=this.UrlService.getV3Url(url)}else this.$translate("BASE.V3.DOMAIN_NAME_TOO_SHORT").then(function(text){_this.error=text})},HomeSubscriptionDashboardController.prototype.validateInput=function(){this.error&&this.searchText&&(this.error="")},HomeSubscriptionDashboardController.prototype.upgrade=function(){var pitch=this.lodash.find(this.User.user.salesPitches,{name:"MoreInfoOnPROModal"});this.$window.location.href=this.UrlService.getUpgradeUrl(pitch)},HomeSubscriptionDashboardController.prototype.emailService=function(){var url="//www."+Common.Globals.DOMAIN_PATH+"/builder/pages/domnomail.aspx";this.$window.location.href=this.UrlService.getV3Url(url)},HomeSubscriptionDashboardController.$inject=["$scope","$state","User","Pages","HomeComponentService","EnvironmentService","$location","$anchorScroll","UrlService","$window","$translate","lodash"],HomeSubscriptionDashboardController}();Components.HomeSubscriptionDashboardController=HomeSubscriptionDashboardController}(Components||(Components={})),angular.module("Components").controller("HomeSubscriptionDashboardController",Components.HomeSubscriptionDashboardController);var Components;!function(Components){var HomeSiteNameController=function(){function HomeSiteNameController($scope,$state,User,Pages,HomeComponentService){var _this=this;this.$scope=$scope,this.$state=$state,this.User=User,this.Pages=Pages,this.HomeComponentService=HomeComponentService,this.HomeComponentService.subsDashboardMode=!0,this.HomeComponentService.mainMenuDisplayMode=Components.MainMenuDisplayMode.SITENAME,this.User.user.isCustomerHostedDomainPending?this.User.checkPendingDomainStatus().then(function(resp){_this.pendingDomainInfo=resp}):this.User.user.isCustomerHasExternalDomain&&this.User.checkExternalDomainStatus().then(function(resp){_this.extrernalDomainInfo=resp})}return HomeSiteNameController.$inject=["$scope","$state","User","Pages","HomeComponentService"],HomeSiteNameController}();Components.HomeSiteNameController=HomeSiteNameController}(Components||(Components={})),angular.module("Components").controller("HomeSiteNameController",Components.HomeSiteNameController);var Components;!function(Components){var HomeSubscriptionController=function(){function HomeSubscriptionController($scope,$state,User,Auth,UrlService,lodash,HomeComponentService){var _this=this;this.$scope=$scope,this.$state=$state,this.User=User,this.Auth=Auth,this.UrlService=UrlService,this.lodash=lodash,this.HomeComponentService=HomeComponentService,this.HomeComponentService.subsDashboardMode=!0,this.HomeComponentService.mainMenuDisplayMode=Components.MainMenuDisplayMode.SUBSCRIPTION,this.User.getSubscriptionDetails().then(function(resp){_this.model=resp})}return HomeSubscriptionController.prototype.redirect=function(link){var absUrl=(this.Auth.getToken(),this.UrlService.getV3Url(Common.V3Links[link]));window.location.href=absUrl},HomeSubscriptionController.prototype.redirectToUpgrade=function(){var pitch=this.lodash.find(this.User.user.salesPitches,{name:"MoreInfoOnPROModal"});window.location.href=this.UrlService.getUpgradeUrl(pitch)},HomeSubscriptionController.prototype.subscibeNewCreditCard=function(){this.User.subscibeNewCreditCard().then(function(form){angular.element(document.body).append(form)})},HomeSubscriptionController.$inject=["$scope","$state","User","Auth","UrlService","lodash","HomeComponentService"],HomeSubscriptionController}();Components.HomeSubscriptionController=HomeSubscriptionController}(Components||(Components={})),angular.module("Components").controller("HomeSubscriptionController",Components.HomeSubscriptionController);var Components;!function(Components){var TopbarController=function(){function TopbarController($scope,HomeComponentService,$timeout,$interval,User,$location,lodash,Experiments,UrlService,EnvironmentService,UserEvents){var _this=this;this.$scope=$scope,this.HomeComponentService=HomeComponentService,this.$timeout=$timeout,this.$interval=$interval,this.User=User,this.$location=$location,this.lodash=lodash,this.Experiments=Experiments,this.UrlService=UrlService,this.EnvironmentService=EnvironmentService,this.UserEvents=UserEvents,this.lastScrollTop=0,this.hasAnimated=!1,this.MILLISECS_PER_HOUR=36e5,this.MILLISECS_PER_MINUTE=6e4,this.MILLISECS_PER_SECOND=1e3,this.showBarAnyway=!1,this.animateSuggestedUrl=function(){if(null!=_this.bannerText1){var suggestedDomainText=document.getElementById("suggestedDomain");suggestedDomainText&&_this.animateCharacterRecursive(suggestedDomainText,1)}else _this.setBannerTexts(),_this.$timeout(function(){_this.animateSuggestedUrl()},6e3)};var pitch=this.lodash.find(this.User.user.salesPitches,{name:"AlternatingTopBarSalesPitch64Hours"});if(this.happyHourPitch=this.lodash.find(this.User.user.salesPitches,{name:"HappyHourBanner"}),this.showSalesPitchBar=!User.user.isPremiumCustomer,this.noSuggestedDomain=!0,this.happyHourPitch&&(pitch=this.happyHourPitch,this.showYellowSalesPitchBar=!0,this.showSalesPitchBar=!0,this.noSuggestedDomain=!1),this.showSalesPitchBar=!User.user.isPremiumCustomer||this.happyHourPitch,HomeComponentService.topbar=this.showSalesPitchBar,this.showBlueSalesPitchBarButton=!0,this.isTopBarSlideShowOn=!1,User.user.salesPitches&&pitch&&(this.showSalesPitchBar||this.happyHourPitch))if(this.domainPitchIndex=0,this.pitch=this.getPitch(pitch),this.pitch.expireDateTime=this.pitch.expireDateTime-24*this.MILLISECS_PER_HOUR,this.pitch.expireDate=this.displayExpireTime(this.pitch.expireDateTime),this.happyHourPitch||(this.pitch.link=UrlService.getSalesPitchBarUrl(this.pitch)),this.showYellowSalesPitchBar=null!=this.pitch.expireDate,this.showYellowSalesPitchBar){this.isTopBarSlideShowOn=!0;var domainName=this.happyHourPitch?"":this.pitch.texts.lines[0].text;this.eventTypes=["V4NewPitchUsernameDomainClicked","V4NewPitchWebsiteNameDomainClicked"],this.Experiments.getTrack(Common.Services.ExperimentId.SALES_PITCH9,{createMode:!0}).then(function(track){_this.experimentTrack=track.toLowerCase(),("newpitch"==_this.experimentTrack||_this.happyHourPitch)&&(_this.getRandomDomainPitchIndex(),_this.happyHourPitch||(_this.pitch.link=UrlService.getV3Url(_this.pitch.texts.links[_this.domainPitchIndex].link)),_this.happyHourPitch||$interval(function(){_this.$domAnimTimeout&&_this.$timeout.cancel(_this.$domAnimTimeout),_this.domainPitchIndex=(_this.domainPitchIndex+1)%_this.pitch.texts.lines.length,domainName=_this.pitch.texts.lines[_this.domainPitchIndex].text,_this.pitch.link=UrlService.getV3Url(_this.pitch.texts.links[_this.domainPitchIndex].link),_this.setBannerTexts(),_this.animateSuggestedUrl()},3e4)),_this.setBannerTexts()})["catch"](function(){_this.setBannerTexts()});var interval=$interval(function(){_this.pitch.expireDate=_this.displayExpireTime(_this.pitch.expireDateTime)},1e3);$scope.$on("$destroy",function(){interval&&$interval.cancel(interval)}),$scope.$watch("vm.HomeComponentService.editmode",function(editmode){editmode&&!_this.hasAnimated&&(_this.$timeout(function(){_this.animateSuggestedUrl()},1e3),_this.hasAnimated=!0)})}else{var trialSalesPitch=this.lodash.find(this.User.user.salesPitches,{name:"TrialSalesPitch"});trialSalesPitch&&(this.showBlueSalesPitchBar=!0,this.salespitchUrl=trialSalesPitch.texts.lines[4].text,this.pitchlink=UrlService.getSalesPitchBarUrl(pitch),HomeComponentService.topbar=!0)}else this.User.user.isPremiumCustomer&&!this.happyHourPitch||this.buildDomainBar();this.isTopBarSlideShowOn&&(this.showBlueSalesPitchBarButton=!1,this.showBlueSalesPitchBar=!1,this.showYellowSalesPitchBar=!0,this.pitchlink="http://"+this.User.user.fullUrl)}return TopbarController.prototype.offerClicked=function(isYellowBanner){this.HomeComponentService.activeSection=null,isYellowBanner?("regular"!=this.experimentTrack&&"newpitch"!=this.experimentTrack||this.UserEvents.send(this.eventTypes[this.domainPitchIndex]),this.UserEvents.send("V4SelectOfferYellowBanner")):this.UserEvents.send("V4SelectOfferBlueBanner")},TopbarController.prototype.getRandomDomainPitchIndex=function(){this.domainPitchIndex=Math.round(Math.random())},TopbarController.prototype.getPitch=function(pitch){var returnPitch;return returnPitch=angular.copy(pitch),returnPitch.link="//www."+Common.Globals.DOMAIN_PATH+pitch.link,returnPitch.expireDateTime=new Date(pitch.expireDate).getTime(),returnPitch},TopbarController.prototype.animateCharacterRecursive=function(suggestedDomainText,i){var _this=this;this.bannerText1.length===i?(suggestedDomainText.innerText=this.bannerText1.substr(0,i),this.urlText=this.bannerText1):(suggestedDomainText.innerText=this.bannerText1.substr(0,i)+"|",this.$domAnimTimeout=this.$timeout(function(){_this.animateCharacterRecursive(suggestedDomainText,i+1)},150))},TopbarController.prototype.displayExpireTime=function(date){var expireDate=new Date(date),now=new Date;if(+expireDate-+now<0&&!this.showBarAnyway)return null;var diff=expireDate.getTime()-now.getTime(),hours=Math.floor(diff/this.MILLISECS_PER_HOUR),minutes=Math.floor((diff-hours*this.MILLISECS_PER_HOUR)/this.MILLISECS_PER_MINUTE),seconds=Math.floor((diff-(hours*this.MILLISECS_PER_HOUR+minutes*this.MILLISECS_PER_MINUTE))/this.MILLISECS_PER_SECOND),formatDivider=":";return this.lodash.padStart(hours+"",2,"0")+formatDivider+this.lodash.padStart(minutes+"",2,"0")+formatDivider+this.lodash.padStart(seconds+"",2,"0")},TopbarController.prototype.setBannerTexts=function(){var domainName=this.happyHourPitch?"":this.pitch.texts.lines[this.domainPitchIndex].text;this.bannerText1=domainName,this.bannerText2=this.pitch.text,this.EnvironmentService.isMobile?(this.bannerText2=this.bannerText2.replace("__offerDomainText__",""),this.bannerText2=this.bannerText2.split("-").join("")):this.bannerText2=this.bannerText2.replace("__offerDomainText__",domainName)},TopbarController.prototype.buildDomainBar=function(){this.HomeComponentService.topbar=!0,this.showDomainBar=!0;var user=this.User.user;this.domainBarTexts=user.salesPitches[5].texts.lines;var nowDate=new Date,now=nowDate.getTime(),domainPurchasedDate=user.cdCreationDate,domainPurchased=domainPurchasedDate.getTime(),millisecondsPassed=now-domainPurchased,secondsPassed=Math.floor(millisecondsPassed/1e3),minutesPassed=Math.floor(secondsPassed/60),hoursPassed=Math.floor(minutesPassed/60),isRxCompleted=(Math.floor(hoursPassed/24),user.rxCompleted);switch(!0){case!isRxCompleted:this.domainBarTextToShow=this.domainBarTexts[0].text;break;case isRxCompleted&&hoursPassed<=24:this.domainBarTextToShow=this.domainBarTexts[2].text;break;case isRxCompleted&&24<hoursPassed&&hoursPassed<=48:this.domainBarTextToShow=this.domainBarTexts[1].text;break;case isRxCompleted&&hoursPassed>48:this.domainBarTextToShow=this.domainBarTexts[3].text;break;default:this.domainBarTextToShow=this.domainBarTexts[1].text}},TopbarController.$inject=["$scope","HomeComponentService","$timeout","$interval","User","$location","lodash","Experiments","UrlService","EnvironmentService","UserEvents"],TopbarController}();Components.TopbarController=TopbarController,angular.module("Components").controller("TopbarController",Components.TopbarController)}(Components||(Components={}));var Components;!function(Components){function topmodal(){return{controller:TopmodalController,controllerAs:"vm",templateUrl:"partials/home.topmodal/home.topmodal.html",transclude:!0,bindings:{pane:"=",websiteUrl:"=",websiteUrlDisplay:"=",openOfferModal:"@"}}}var TopmodalController=function(){function TopmodalController($scope,HomeComponentService,HomePreviewComponentService,Sections,Pages,User,ModalService,SurveyMonkey,$window,$interval){var _this=this;this.$scope=$scope,this.HomeComponentService=HomeComponentService,this.HomePreviewComponentService=HomePreviewComponentService,this.Sections=Sections,this.Pages=Pages,this.User=User,this.ModalService=ModalService,this.SurveyMonkey=SurveyMonkey,this.$window=$window,this.$interval=$interval,this.pane=parseInt(Cookies.get(Common.Services.CookieNames.CONTINUESW),10)||1,this.websiteUrl="http://"+this.User.user.fullUrl,this.websiteUrlDisplay=this.User.user.fullUrl,"false"!==Cookies.get(Common.Services.CookieNames.CONTINUESW)&&$scope.$watch("vm.pane",function(step){if(Cookies.set(Common.Services.CookieNames.CONTINUESW,step,Common.Globals.DEFAULT_COOKIE_SETTINGS),2===step&&_this.Pages.currentPage.sections&&0===_this.Pages.currentPage.sections.length){var index=0,section={index:index,type:"Text",headline:null,text:"<p></p>"};_this.Sections.add(_this.Pages.currentPage.pageType,_this.Pages.currentPage.pageId,section).success(function(data){angular.extend(section,data),_this.Pages.currentPage.sections.splice(index,0,section),_this.HomePreviewComponentService.sectionIdJustAdded=section.sectionId})}step==-1&&(HomeComponentService.topmodal=!1,Cookies.set(Common.Services.CookieNames.CONTINUESW,!1,Common.Globals.DEFAULT_COOKIE_SETTINGS),_this.SurveyMonkey.init())})}return TopmodalController.prototype.$onInit=function(){function hasScrolled(){var st=angular.element(this).scrollTop();Math.abs(lastScrollTop-st)<=delta||(st<200?topmodal.removeClass("c-topmodal--collapse"):st>lastScrollTop&&st>scrollMovement?topmodal.addClass("c-topmodal--collapse"):st+angular.element(this.$window).height()<angular.element(document).height()&&topmodal.removeClass("c-topmodal--collapse"),lastScrollTop=st)}var didScroll,lastScrollTop=0,delta=5,scrollMovement=40,topmodal=angular.element(".c-topmodal");this.scrollCallback=function(){didScroll=!0},this.$window.addEventListener("scroll",this.scrollCallback),this.interval=this.$interval(function(){didScroll&&(hasScrolled(),didScroll=!1)},250)},TopmodalController.prototype.$onDestroy=function(){this.$interval.cancel(this.interval),this.$window.removeEventListener("scroll",this.scrollCallback)},TopmodalController.$inject=["$scope","HomeComponentService","HomePreviewComponentService","Sections","Pages","User","ModalService","SurveyMonkey","$window","$interval"],TopmodalController}();angular.module("Components").component("topmodal",topmodal())}(Components||(Components={}));var Components;!function(Components){var TopmodalPane8Controller=function(){function TopmodalPane8Controller(ModalService,lodash,User){this.ModalService=ModalService,this.lodash=lodash,this.User=User,this.openOfferModal=function(){this.ModalService.showModal({templateUrl:"partials/home.offer/home.offer.html",controller:"HomeOfferController",controllerAs:"vm"})["catch"](function(err){throw err})},this.pitch=this.lodash.find(this.User.user.salesPitches,{name:"TrialSalesPitch"}),this.websiteUrl="http://"+this.User.user.fullUrl,this.websiteUrlDisplay=this.User.user.fullUrl}return TopmodalPane8Controller.$inject=["ModalService","lodash","User"],TopmodalPane8Controller}();angular.module("Components").controller("TopmodalPane8Controller",TopmodalPane8Controller)}(Components||(Components={}));var Common;!function(Common){var Directives;!function(Directives){var UpdatePageNameModalController=function(){function UpdatePageNameModalController(close,$q,newPageTitle){this.close=close,this.$q=$q,this.newPageTitle=newPageTitle,this.shown=!0}return UpdatePageNameModalController.prototype.updatePage=function(){var deferred=this.$q.defer();return deferred.resolve({title:this.newPageTitle}),deferred.promise},UpdatePageNameModalController.$inject=["close","$q","newPageTitle"],UpdatePageNameModalController}();Directives.UpdatePageNameModalController=UpdatePageNameModalController}(Directives=Common.Directives||(Common.Directives={}))}(Common||(Common={})),angular.module("Common.Directives").controller("UpdatePageNameModalController",Common.Directives.UpdatePageNameModalController);var Components;!function(Components){var HomeVideoBackgroundController=function(){function HomeVideoBackgroundController($scope,$timeout,HomeComponentService,EnvironmentService,VideoBackgroundsService,$element){var _this=this;this.$scope=$scope,this.$timeout=$timeout,this.HomeComponentService=HomeComponentService,this.EnvironmentService=EnvironmentService,this.VideoBackgroundsService=VideoBackgroundsService,this.$element=$element,$scope.$on("videoBackground set",function(){_this.refreshVideo(_this.VideoBackgroundsService.currentVideoBackground)})}return HomeVideoBackgroundController.prototype.refreshVideo=function(videoBackground){var _this=this;this.videoBackground=videoBackground,this.$timeout(function(){_this.videoObject=_this.$element.find("video")[0],_this.videoObject&&_this.videoObject.load()},0)},HomeVideoBackgroundController.$inject=["$scope","$timeout","HomeComponentService","EnvironmentService","VideoBackgroundsService","$element"],HomeVideoBackgroundController}();Components.HomeVideoBackgroundController=HomeVideoBackgroundController}(Components||(Components={})),angular.module("Components").controller("HomeVideoBackgroundController",Components.HomeVideoBackgroundController);var Components;!function(Components){var HomeWelcomeController=function(){function HomeWelcomeController($scope,close,User,$translate){this.$scope=$scope,this.close=close,this.User=User,this.$translate=$translate,this.businessname=User.user.site.title,this.bodytext1=this.$translate.instant("HOME.WELCOME.BODYTEXT1").replace("{BUSINESSNAME}",this.businessname),this.shown=!0}return HomeWelcomeController.prototype.okClose=function(){this.shown=!1,this.close({},800)},HomeWelcomeController.$inject=["$scope","close","User","$translate"],HomeWelcomeController}();Components.HomeWelcomeController=HomeWelcomeController}(Components||(Components={})),angular.module("Components").controller("HomeWelcomeController",Components.HomeWelcomeController);var Components;!function(Components){var LoginController=function(){function LoginController($scope,Auth,User,Pages,$state,$translate,EnvironmentService,WelcomeMobileService){this.$scope=$scope,this.Auth=Auth,this.User=User,this.Pages=Pages,this.$state=$state,this.$translate=$translate,this.EnvironmentService=EnvironmentService,this.WelcomeMobileService=WelcomeMobileService,this.new_customer=!Cookies.get(Common.Services.CookieNames.NEW_CUSTOMER)}return LoginController.prototype.login=function(loginObject){var _this=this;this.User.clear(),this.Pages.list=null,this.Auth.login(loginObject).then(function(data){_this.EnvironmentService.isMobile&&!_this.WelcomeMobileService.userHasSeenWelcomeMobilePrimer()&&_this.WelcomeMobileService.videoPrimerEnable?_this.$state.go("welcome-mobile"):_this.$state.go("home",{pageId:"",editmode:!0}),Cookies.set(Common.Services.CookieNames.NEW_CUSTOMER,!1,Common.Globals.DEFAULT_COOKIE_SETTINGS)},function(data){_this.$translate("LOGIN.SORRY").then(function(title){})})},LoginController.$inject=["$scope","Auth","User","Pages","$state","$translate","EnvironmentService","WelcomeMobileService"],LoginController}();Components.LoginController=LoginController}(Components||(Components={})),angular.module("Components").controller("LoginController",Components.LoginController);var Components;!function(Components){var LogoutController=function(){function LogoutController(Auth){this.Auth=Auth,Auth.logout().then(function(data){Auth.goToLogin()})}return LogoutController.$inject=["Auth"],LogoutController}();Components.LogoutController=LogoutController}(Components||(Components={})),angular.module("Components").controller("LogoutController",Components.LogoutController);var Components;!function(Components){var NotFoundController=function(){function NotFoundController(){}return NotFoundController.$inject=[],NotFoundController}();Components.NotFoundController=NotFoundController}(Components||(Components={})),angular.module("Components").controller("NotFoundController",Components.NotFoundController);var Components;!function(Components){var SignupController=function(){function SignupController($scope,Auth,$state,EnvironmentService,WelcomeMobileService){var _this=this;this.$scope=$scope,this.Auth=Auth,this.$state=$state,this.EnvironmentService=EnvironmentService,this.WelcomeMobileService=WelcomeMobileService,this.signup=function(signupObject){_this.Auth.signup(signupObject).then(function(data){var login={username:signupObject.username,password:signupObject.password};_this.login(login)},function(data){})},this.login=function(loginObject){_this.Auth.login(loginObject).then(function(data){_this.EnvironmentService.isMobile&&!_this.WelcomeMobileService.userHasSeenWelcomeMobilePrimer()&&_this.WelcomeMobileService.videoPrimerEnable?_this.$state.go("welcome-mobile"):_this.$state.go("home",{pageId:"",editmode:!0}),Cookies.set(Common.Services.CookieNames.NEW_CUSTOMER,!1,Common.Globals.DEFAULT_COOKIE_SETTINGS)},function(data){})}}return SignupController.$inject=["$scope","Auth","$state","EnvironmentService","WelcomeMobileService"],SignupController}();Components.SignupController=SignupController}(Components||(Components={})),angular.module("Components").controller("SignupController",Components.SignupController);var Components;!function(Components){var WelcomeMobileController=function(){function WelcomeMobileController($state,WelcomeMobileService){this.$state=$state,this.WelcomeMobileService=WelcomeMobileService,this.WelcomeMobileService.markUserAsHavingSeenMobilePrimer()}return WelcomeMobileController.prototype.start=function(){this.$state.go("home",{pageId:"",editmode:!0})},WelcomeMobileController.prototype.userHasSeenPrimer=function(){return this.WelcomeMobileService.userHasSeenWelcomeMobilePrimer()},WelcomeMobileController.$inject=["$state","WelcomeMobileService"],WelcomeMobileController}();Components.WelcomeMobileController=WelcomeMobileController}(Components||(Components={})),angular.module("Components").controller("WelcomeMobileController",Components.WelcomeMobileController);
//# sourceMappingURL=main.js.map
/* Built on Fri Nov 03 2017 11:05:17 GMT+0000 (Coordinated Universal Time) */
